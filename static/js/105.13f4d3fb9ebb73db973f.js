webpackJsonp([105],{"8E6F":function(a,t,e){"use strict";var i=e("mvHQ"),l=e.n(i),s={props:{mallData:Array},data:function(){return{pickerOptions1:{disabledDate:function(a){return a.getTime()>Date.now()}},tabItem:[],panelObj:{mallPanel:!1,floorPanel:!1,formatPanel:!1,ioPanel:!1,shopPanel:!1},time1Val:"",time2Val:"",mallVal:"",floorVal:"",formatVal:"",ioVal:"",zoneVal:"",asisLevel:"",kpiVal:"TRAFFIC",floorData:[],zoneData:[],formatData:[],ioData:[],paramId:"",gateVal:"",floorItem:"",zoneItem:"",floorList:[],zoneList:[],gateData:[],shopFloorData:[],shopFloorId:"",shopFloorVal:"",gateLevel:"all",gateLevelList:[{label:"all",value:"all"},{label:"mall",value:"mall"},{label:"floor",value:"floor"},{label:"store",value:"zone"}]}},created:function(){if(this.tabItem=[],"mall"===this.$Project){var a={mall:"mall",inOut:"io",floor:"floor",store:"shop"};for(var t in a)this.tabItem.push({label:t,value:a[t],className:"analysis-item"})}else this.tabItem=[{label:"mall",value:"mall",className:"analysis-item"},{label:"inOut",value:"io",className:"analysis-item"},{label:"floor",value:"floor",className:"analysis-item"},{label:"store",value:"shop",className:"analysis-item"}]},methods:{i18nFormatter:function(a){var t="asisTab."+a;return this.$t(t)},getTime1:function(){},initAsis:function(a){this.paramId=a,this.mallVal=a,this.getFloorOpt(a),this.gateLevelChange(),this.tabClickHandle(0);var t=[this.time1Val,this.time2Val],e={asis_level:this.asisLevel,asis_time:t,asis_org:this.paramId,asis_kpi:this.kpiVal};this.$emit("initData",e)},tabClickHandle:function(a){if("analysis-item"===this.tabItem[a].className){this.tabItem.forEach(function(a){a.className="analysis-item"}),this.tabItem[a].className="analysis-item tabs-active";for(var t in this.panelObj)this.panelObj[t]=!1;switch(this.kpiVal="TRAFFIC",this.asisLevel="",this.tabItem[a].value){case"mall":this.panelObj.mallPanel=!0,this.asisLevel="mall";break;case"floor":this.panelObj.floorPanel=!0,this.asisLevel="floor";break;case"format":this.panelObj.formatPanel=!0,this.asisLevel="format";break;case"io":this.panelObj.ioPanel=!0,this.asisLevel="gate";break;case"shop":this.panelObj.shopPanel=!0,this.asisLevel="zone"}}},gateLevelChange:function(){"all"===this.gateLevel?this.getAllGates():"mall"===this.gateLevel?this.getMallGates():"floor"===this.gateLevel?this.getFloorList():this.getZoneList()},getAllGates:function(){var a=this;this.gateData=[],this.gateVal="",this.axios.get("/gates",{params:{accountId:this.$cookie.get("accountId"),mallId:this.mallVal,_t:Date.parse(new Date)/1e3}}).then(function(t){if(t.data.data.length>0){var e=t.data.data;e.forEach(function(a){window.sessionStorage.setItem("gate-"+a.id,a.name)}),a.gateVal=e[0].id,a.gateData=e}})},getMallGates:function(){var a=this;this.gateData=[],this.gateVal="",this.axios.get("/gates",{params:{mallId:this.mallVal,isMallGate:1,_t:Date.parse(new Date)/1e3}}).then(function(t){if(t.data.data.length>0){var e=t.data.data;a.gateVal=e[0].id,a.gateData=e}})},getFloorList:function(){var a=this;this.gateData=[],this.gateVal="",this.floorItem="",this.floorList=[],this.axios.get("/floors",{params:{mallId:this.mallVal,_t:Date.parse(new Date)/1e3}}).then(function(t){if(t.data.data.length>0){var e=t.data.data;a.floorItem=e[0].id,a.getFloorGate(a.floorItem),a.floorList=e}})},getZoneList:function(){var a=this;this.gateData=[],this.gateVal="",this.zoneItem="",this.zoneList=[],this.axios.get("/zones",{params:{mallId:this.mallVal,sortName:'"floor".name, "zone".name',_t:Date.parse(new Date)/1e3}}).then(function(t){if(t.data.data.length>0){var e=t.data.data;a.zoneItem=e[0].id,a.getZoneGate(a.zoneItem),a.zoneList=e}})},levelFloorChange:function(){this.floorItem?this.getFloorGate(this.floorItem):(this.gateVal="",this.gateData=[])},getFloorGate:function(a){var t=this;this.gateData=[],this.gateVal="",this.axios.get("/floorGates",{params:{FloorId_arr:a,_t:Date.parse(new Date)/1e3}}).then(function(a){if(a.data.data.length>0){var e=a.data.data;e.forEach(function(a){a.id=a.gateId,a.name=window.sessionStorage.getItem("gate-"+a.gateId)}),t.gateVal=e[0].id,t.gateData=e}})},levelZoneChange:function(){this.zoneItem?this.getZoneGate(this.zoneItem):(this.gateVal="",this.gateData=[])},getZoneGate:function(a){var t=this;this.gateData=[],this.gateVal="",this.axios.get("/zoneGates",{params:{ZoneId_arr:a,_t:Date.parse(new Date)/1e3}}).then(function(a){if(a.data.data.length>0){var e=a.data.data;e.forEach(function(a){a.id=a.gateId,a.name=window.sessionStorage.getItem("gate-"+a.gateId)}),t.gateVal=e[0].id,t.gateData=e}})},getFloorOpt:function(a){var t=this;this.floorData=[],this.floorVal="",this.shopFloorData=[],this.shopFloorId="",this.shopFloorVal="",this.axios.get("/floors",{params:{mallId:a,accountId:this.$cookie.get("accountId"),status:1,_t:Date.parse(new Date)/1e3}}).then(function(e){if(e.data.data.length>0){var i=JSON.parse(l()(e.data.data));i.unshift({name:t.$t("asisTab.all"),id:""}),t.floorData=e.data.data,t.floorVal=e.data.data[0].id,t.shopFloorData=i,t.shopFloorId=i[0].id,t.shopFloorVal=i[0].id,t.getIoOpt(a,t.floorVal),t.getZoneOpt(a,t.shopFloorVal)}else t.getZoneOpt(a)}).catch(function(a){})},getZoneOpt:function(a,t){var e=this;this.zoneData=[],this.zoneVal="",this.axios.get("/zones",{params:{mallId:a,floorId:t,accountId:this.$cookie.get("accountId"),status:1,sortName:'"floor".name, "zone".name',_t:Date.parse(new Date)/1e3}}).then(function(a){a.data.data.length>0&&(e.zoneData=a.data.data,e.zoneVal=a.data.data[0].id)}).catch(function(a){})},getIoOpt:function(a,t){var e=this;this.axios.get("/gates",{params:{mallId:a,floorId:t,accountId:this.$cookie.get("accountId"),status:1,_t:Date.parse(new Date)/1e3}}).then(function(a){a.data.data.length>0&&(e.ioData=a.data.data,e.ioVal=a.data.data[0].id)}).catch(function(a){})},getFormatOpt:function(){var a=this;this.axios.get("/formats",{params:{_t:Date.parse(new Date)/1e3}}).then(function(t){t.data.data.length>0&&(a.formatData=t.data.data,a.formatVal=t.data.data[0].id)}).catch(function(a){})},mallChange:function(){this.getFloorOpt(this.mallVal)},gateMallChange:function(){this.gateLevel="all",this.gateLevelChange()},floorChange:function(){this.getZoneOpt(this.mallVal,this.shopFloorVal)},confirmCondition:function(){var a={asis_level:"",asis_time:"",asis_org:"",asis_kpi:"",asis_format:""};switch(this.asisLevel){case"mall":this.paramId=this.mallVal,a.asis_tit=this.getItemName(this.mallData,this.paramId);break;case"floor":this.paramId=this.floorVal,a.asis_tit=this.getItemName(this.mallData,this.mallVal)+"-"+this.getItemName(this.floorData,this.paramId);break;case"format":a.asis_format=this.formatVal,this.paramId=this.mallVal;break;case"gate":this.paramId=this.gateVal,a.asis_tit=this.getItemName(this.mallData,this.mallVal)+"-"+this.getItemName(this.gateData,this.paramId);break;case"zone":this.paramId=this.zoneVal,a.asis_tit=this.getItemName(this.mallData,this.mallVal)+"-"+this.getItemName(this.zoneData,this.paramId)}if(this.paramId){a.asis_level=this.asisLevel;var t=[this.time1Val,this.time2Val];a.asis_time=t,a.asis_org=this.paramId,a.asis_kpi=this.kpiVal,this.$emit("reportTime",a)}},getItemName:function(a,t){var e="",i=t.toString().split(",")[0];return a.forEach(function(a){a.id==i&&(e=a.name)}),e},resetRefresh:function(){this.tabClickHandle(0),this.mallVal=this.mallData[0].id,this.time1Val=[this.dayReduce(new Date,15),dateUnit.dateFormat(new Date,"yyyy-MM-dd")],this.time2Val=[this.dayReduce(new Date,30),this.dayReduce(new Date,15)]}},mounted:function(){this.time1Val=this.time1Val?this.time1Val:[this.dayReduce(new Date,15),dateUnit.dateFormat(new Date,"yyyy-MM-dd")],this.time2Val=this.time2Val?this.time2Val:[this.dayReduce(new Date,30),this.dayReduce(new Date,15)]}},o={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"analysis-option-wrapper"},[e("div",{staticClass:"analysis-level-wrapper"},[e("div",{staticClass:"analysis-level-left"},[e("i",{staticClass:"el-icon-search"}),a._v(" "),e("span",{staticClass:"analysis-level-text"},[a._v(a._s(a.$t("asisTab.level")))])]),a._v(" "),e("div",{staticClass:"analysis-level-right"},[e("ul",{staticClass:"analysis-type-box"},a._l(a.tabItem,function(t,i){return e("li",{key:t.value,class:t.className,on:{click:function(t){a.tabClickHandle(i)}}},[e("span",{staticClass:"analysis-item-title"},[a._v(a._s(a.i18nFormatter(t.label)))])])}))])]),a._v(" "),e("div",{staticClass:"panels-content"},[e("div",{staticClass:"panels-main-top"},[a.panelObj.mallPanel||a.panelObj.floorPanel||a.panelObj.formatPanel||a.panelObj.ioPanel||a.panelObj.shopPanel?a._e():e("div",{staticClass:"place-holder-div"}),a._v(" "),a.panelObj.mallPanel?e("ul",{staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[a._v(a._s(a.$t("asisTab.mallT")))]),a._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box",attrs:{filterable:"",placeholder:a.$t("pholder.shopSelect")},on:{change:a.mallChange},model:{value:a.mallVal,callback:function(t){a.mallVal=t},expression:"mallVal"}},a._l(a.mallData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}})}))],1)])]):a._e(),a._v(" "),a.panelObj.floorPanel?e("ul",{staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[a._v(a._s(a.$t("asisTab.mallT")))]),a._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box",attrs:{filterable:"",placeholder:a.$t("pholder.shopSelect")},on:{change:a.mallChange},model:{value:a.mallVal,callback:function(t){a.mallVal=t},expression:"mallVal"}},a._l(a.mallData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}})}))],1)]),a._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[a._v(a._s(a.$t("asisTab.floorT")))]),a._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"floor-sel-box",attrs:{filterable:"",placeholder:a.$t("pholder.floorSelect")},model:{value:a.floorVal,callback:function(t){a.floorVal=t},expression:"floorVal"}},a._l(a.floorData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}})}))],1)])]):a._e(),a._v(" "),a.panelObj.formatPanel?e("ul",{staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[a._v(a._s(a.$t("asisTab.mallT")))]),a._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box",attrs:{filterable:"",placeholder:a.$t("pholder.shopSelect")},model:{value:a.mallVal,callback:function(t){a.mallVal=t},expression:"mallVal"}},a._l(a.mallData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}})}))],1)]),a._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[a._v(a._s(a.$t("asisTab.floorT")))]),a._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"floor-sel-box",attrs:{filterable:"",placeholder:a.$t("pholder.floorSelect")},model:{value:a.floorVal,callback:function(t){a.floorVal=t},expression:"floorVal"}},a._l(a.floorData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}})}))],1)]),a._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[a._v("业态 :")]),a._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"format-sel-box",attrs:{filterable:"",placeholder:"业态"},model:{value:a.formatVal,callback:function(t){a.formatVal=t},expression:"formatVal"}},a._l(a.formatData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}})}))],1)])]):a._e(),a._v(" "),a.panelObj.ioPanel?e("ul",{staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[a._v(a._s(a.$t("asisTab.mallT")))]),a._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box",attrs:{filterable:"",placeholder:a.$t("pholder.shopSelect")},on:{change:a.gateMallChange},model:{value:a.mallVal,callback:function(t){a.mallVal=t},expression:"mallVal"}},a._l(a.mallData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}})}))],1)]),a._v(" "),e("li",{staticClass:"condition-item gate-level-item"},[e("span",{staticClass:"condition-item-text"},[a._v(a._s(a.$t("asisTab.inOutLev")))]),a._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"floor-sel-box",attrs:{placeholder:a.$t("pholder.gateLevel")},on:{change:a.gateLevelChange},model:{value:a.gateLevel,callback:function(t){a.gateLevel=t},expression:"gateLevel"}},a._l(a.gateLevelList,function(t){return e("el-option",{key:t.value,attrs:{label:a.$t("asisTab."+t.label),value:t.value}})})),a._v(" "),"floor"===a.gateLevel||"zone"===a.gateLevel?e("span",[a._v("-")]):a._e(),a._v(" "),"floor"===a.gateLevel?e("el-select",{staticClass:"floor-sel-box",attrs:{filterable:"",placeholder:a.$t("pholder.floorSelect")},on:{change:a.levelFloorChange},model:{value:a.floorItem,callback:function(t){a.floorItem=t},expression:"floorItem"}},a._l(a.floorList,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}})})):a._e(),a._v(" "),"zone"===a.gateLevel?e("el-select",{staticClass:"zone-sel-box",attrs:{filterable:"",placeholder:a.$t("pholder.zoneSelect")},on:{change:a.levelZoneChange},model:{value:a.zoneItem,callback:function(t){a.zoneItem=t},expression:"zoneItem"}},a._l(a.zoneList,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}})})):a._e()],1)]),a._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[a._v(a._s(a.$t("asisTab.inOutT")))]),a._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"format-sel-box",attrs:{filterable:"",placeholder:a.$t("pholder.gateType")},model:{value:a.gateVal,callback:function(t){a.gateVal=t},expression:"gateVal"}},a._l(a.gateData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}})}))],1)])]):a._e(),a._v(" "),a.panelObj.shopPanel?e("ul",{staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[a._v(a._s(a.$t("asisTab.mallT")))]),a._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box",attrs:{filterable:"",placeholder:a.$t("pholder.shopSelect")},on:{change:a.mallChange},model:{value:a.mallVal,callback:function(t){a.mallVal=t},expression:"mallVal"}},a._l(a.mallData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}})}))],1)]),a._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[a._v(a._s(a.$t("asisTab.floorT")))]),a._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"floor-sel-box",attrs:{filterable:"",placeholder:a.$t("pholder.floorSelect")},on:{change:a.floorChange},model:{value:a.shopFloorVal,callback:function(t){a.shopFloorVal=t},expression:"shopFloorVal"}},a._l(a.shopFloorData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}})}))],1)]),a._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[a._v(a._s(a.$t("asisTab.storeT")))]),a._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"shop-sel-box",attrs:{filterable:"",placeholder:a.$t("pholder.areaSelect")},model:{value:a.zoneVal,callback:function(t){a.zoneVal=t},expression:"zoneVal"}},a._l(a.zoneData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}})}))],1)])]):a._e()]),a._v(" "),e("div",{class:a.panelObj.ioPanel||a.panelObj.shopPanel?"panels-main-bottom ml-bottom main-bottom":"panels-main-bottom main-bottom"},[e("ul",{staticClass:"condition-box"},[e("li",{staticClass:"condition-item analysis-date-condition"},[e("span",{staticClass:"condition-item-text"},[a._v(a._s(a.$t("asisTab.timeA")))]),a._v(" "),e("div",{staticClass:"condition-item-option mleft-time"},[e("el-date-picker",{staticClass:"date-input analysis-date-input times-box",attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"daterange",size:"mini","range-separator":"-","picker-options":a.pickerOptions1,"start-placeholder":a.$t("table.startTime"),"end-placeholder":a.$t("table.endTime")},on:{change:a.getTime1},model:{value:a.time2Val,callback:function(t){a.time2Val=t},expression:"time2Val"}})],1)]),a._v(" "),e("li",{staticClass:"condition-item analysis-date-condition"},[e("span",{staticClass:"condition-item-text"},[a._v(a._s(a.$t("asisTab.timeB")))]),a._v(" "),e("div",{staticClass:"condition-item-option mleft-time"},[e("el-date-picker",{staticClass:"date-input analysis-date-input times-box",attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"daterange",size:"mini","picker-options":a.pickerOptions1,"range-separator":"-","start-placeholder":a.$t("table.startTime"),"end-placeholder":a.$t("table.endTime")},model:{value:a.time1Val,callback:function(t){a.time1Val=t},expression:"time1Val"}})],1)]),a._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[a._v(a._s(a.$t("asisTab.index")))]),a._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"indicator-sel-box",attrs:{placeholder:a.$t("pholder.kpi")},model:{value:a.kpiVal,callback:function(t){a.kpiVal=t},expression:"kpiVal"}},[e("el-option",{attrs:{label:a.$t("format.TRAFFIC"),value:"TRAFFIC"}}),a._v(" "),e("el-option",{attrs:{label:a.$t("head.enableDayInnum"),value:"EFFTRAFFIC"}})],1)],1)]),a._v(" "),e("li",{staticClass:"condition-item mleft-last"},[e("el-button",{staticClass:"primary-btn analysis-collapse-btn",attrs:{type:"primary",size:"samll"},on:{click:a.confirmCondition}},[a._v(a._s(a.$t("button.confirm")))]),a._v(" "),e("el-button",{staticClass:"reset-btn analysis-collapse-btn",attrs:{size:"samll"},on:{click:a.resetRefresh}},[a._v(a._s(a.$t("button.reset")))])],1)])])])])},staticRenderFns:[]},n=e("VU/8")(s,o,!1,function(a){e("8icQ")},"data-v-6ed65eaa",null);t.a=n.exports},"8icQ":function(a,t){},C8Sn:function(a,t,e){"use strict";(function(a){var i=e("mvHQ"),l=e.n(i),s=(e("jR44"),e("8E6F"));t.a={data:function(){return{tc_title:"timeComp",moreOptVisible:!1,mallData:[],asisName:"",emitData:{},tableKeyToId:{},tableIds:"",radioDate:"totalTraffic",loading:!0,trafficHead:[],trafficTab:[],trafficPie:[],trafficBar:[],nameType:"",tableHeight:0,myChart:{}}},components:{"tc-option":s.a},created:function(){var t=this,e=a(window).height(),i=.28;e<=720?i=.35:e<=768?i=.33:e<=900?i=.28:e<=1080&&(i=.31),this.tableHeight=e-e*i,window.addEventListener("resize",function(){try{var e={chart1:a("#pieLineChart")[0]};for(var i in e)if(e.hasOwnProperty(i)&&void 0!=e[i]){e[i]=t.$echarts.init(e[i]);e[i].resize()}}catch(a){}})},mounted:function(){this.getMallOpt(),this.showCollapse()},methods:{i18nFormatter:function(a){var t="echartsTitle."+a;return this.$t(t)},i18n:function(a){var t="format."+a;return this.$t(t)},showCollapse:function(){var t=this,e="",i="",l="",s="";e=this.getStyleFn(".el-header","height"),i=this.getStyleFn(".analysis-wrapper .el-header","height"),this.moreOptVisible?(this.moreOptVisible=!1,s=e+i+8+"px",a(".tc-main").animate({marginTop:s})):(this.moreOptVisible=!0,setTimeout(function(){l=t.getStyleFn(".analysis-option-wrapper","height"),s=e+i+l+8+"px",a(".tc-main").animate({marginTop:s})},100))},getMallOpt:function(){var a=this;this.axios.get("/malls",{params:{accountId:this.$cookie.get("accountId"),status:1,_t:Date.parse(new Date)/1e3}}).then(function(t){var e="",i=null;if(t.data.data.length>=1){var l=window.sessionStorage.getItem("mallId");l&&Number(l),t.data.data.forEach(function(t,i){a.mallData.push(t),l&&t.id==l&&(e=t.name)}),a.asisName=e||t.data.data[0].name,i=l?Number(l):t.data.data[0].id,a.$refs.init.initAsis(i)}})},initTab:function(a){this.emitData=a,this.getChartIds()},getChartIds:function(){var a=this;this.tableKeyToId={},this.tableIds="",this.axios.get("/reportCharts",{params:{report:"timeCompareAnalysis",_t:Date.parse(new Date)/1e3}}).then(function(t){var e=t.data.data;e.forEach(function(t,i){a.tableKeyToId[t.key]=t.id,"totalPassengerCompare"!==t.key&&"totalAndAverageTraffic"!==t.key||(i==e.length-1?a.tableIds+=t.id:a.tableIds+=t.id+",")}),a.getTableData(a.tableIds)}).catch(function(a){console.log("initdata err",a.message)}),setTimeout(function(){a.loading=!1},1e3)},getTableData:function(a){var t=this;if(a){this.trafficHead=[],this.trafficTab=[];var e="",i={},s="",o=[];s=this.emitData.asis_time,"format"===this.emitData.asis_level?(e="/report/timeCompareAnalysis/mall",i={orgIds:this.emitData.asis_org,startDate:s[0][0],endDate:s[0][1],startDate1:s[1][0],endDate1:s[1][1],kpiType:this.emitData.asis_kpi,chartIds:a,formatIds:this.emitData.asis_format,kpiTypes:o.join(","),_t:Date.parse(new Date)/1e3}):(e="/report/timeCompareAnalysis/"+this.emitData.asis_level,i={orgIds:this.emitData.asis_org,startDate:s[0][0],endDate:s[0][1],startDate1:s[1][0],endDate1:s[1][1],kpiType:this.emitData.asis_kpi,chartIds:a,_t:Date.parse(new Date)/1e3}),this.axios.get(e,{params:i}).then(function(a){var e={},i=a.data.data.body;if("{}"!==l()(i))if("totalTraffic"===t.radioDate){if(i.totalPassengerCompare){var s=i.totalPassengerCompare.series,o=i.totalPassengerCompare.xaxis.data;t.trafficHead=t.autoComplateHead(o),t.trafficTab=t.dealData(s,t.trafficHead)}else t.$message({type:"info",message:"totalPassengerCompare report is not exist!"});i.totalAndAverageTraffic?(e=i.totalAndAverageTraffic.series,t.drawChart("pie","pieLineChart",e)):t.$message({type:"info",message:"totalAndAverageTraffic report is not exist!"})}else{if(i.dayCompareTable){var n=i.dayCompareTable.series,r=i.dayCompareTable.xaxis.data;t.trafficHead=t.autoComplateHead(r),t.trafficTab=t.dealData(n,t.trafficHead)}else t.$message({type:"info",message:"dayCompareTable report is not exist!"});i.dayCompareLine?(e=i.dayCompareLine,t.drawChart("line","pieLineChart",e)):t.$message({type:"info",message:"dayCompareLine report is not exist!"})}}).catch(function(a){console.log(a)})}},drawChart:function(a,t,e){var i=this,l=document.getElementById(t);this.$echarts.getInstanceByDom(l)?(this.$echarts.init(l).dispose(),this.myChart=this.$echarts.init(l)):this.myChart=this.$echarts.init(l);var s={};if("pie"==a){var o=[];e.forEach(function(a){a.data.forEach(function(a){-1===o.indexOf(a.name)&&o.push(a.name)})}),(s={color:["#3BB8FF","#FFC62E"],legend:{bottom:"12px",data:o},tooltip:{show:!0,backgroundColor:"#fff",padding:[0,0,0,0],extraCssText:"box-shadow: 0px 0px 10px -4px rgba(3, 3, 3, .4)"},series:e.map(function(a,t){return a.center=[50*t+25+"%","50%"],a.radius=["55%","65%"],a.avoidLabelOverlap=!1,a.label={normal:{show:!0,position:"center",formatter:function(a){return 0==t?"总客流":"平均客流"},color:"#000",fontSize:24},emphasis:{show:!0}},a.labelLine={normal:{show:!1}},a})}).tooltip.formatter=function(a,t,e){var i="",l="";return i+='<div style="font-size:14px;height:31px;color:#333;border-radius:4px;line-height:31px;padding-left:15px;padding-right:15px; text-align: left; color: #0068FF;">'+a.seriesName+"</div><div>",l=a.value?a.value>1e5?(a.value/1e4).toFixed(2)+"万人":a.value+"人次":"--人次",i+='<p style="font-size:13px; padding:4px 15px; color:#444; text-align: left;">'+a.name+": "+l+"</p>",i+='<p style="font-size:13px; padding:4px 15px; color:#444; text-align: left;">占比: '+a.percent+"%</p>",i+="</div>"}}else{var n=[{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(135, 209, 75, 0.4)"},{offset:1,color:"rgba(135, 209, 75, 0.2)"}],globalCoord:!1},{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(59, 184, 255, 0.4)"},{offset:1,color:"rgba(59, 184, 255, 0.2)"}],globalCoord:!1}];(s={color:["#87D14B","#3BB8FF"],tooltip:{show:!0,backgroundColor:"#fff",textStyle:{color:"#333333"},extraCssText:"box-shadow: 0px 0px 10px -4px rgba(3, 3, 3, .4)",trigger:"axis"},xAxis:{type:"category",boundaryGap:!1,axisLine:{lineStyle:{color:"#57617B"}},data:e.xaxis.data},yAxis:{type:"value"},grid:{left:52,right:26,bottom:26},series:e.series.map(function(a,t){return a.areaStyle={normal:{color:n[t]}},a})}).tooltip.formatter=function(a,t,e){var i="",l="";return i+='<div style="font-size:14px;height:31px;color:#333;border-radius:4px;line-height:31px;padding-left:15px;padding-right:15px; text-align: left; color: #0068FF;">'+a[0].name+"</div><div>",a.forEach(function(a,t){l=a.data?a.data>1e5?(a.data/1e4).toFixed(2)+"万人":a.data+"人次":"--人次",i+='<p style="font-size:13px; padding:4px 15px; color:#444; text-align: left;">'+a.marker+" "+a.seriesName+": "+l+"</p>"}),i+="</div>"}}this.myChart.clear(),this.myChart.setOption(s),setTimeout(function(){i.loading=!1},1e3)},autoComplateHead:function(a){var t=[];return a.forEach(function(a,e){t.push({prop:"defaultOrg"+e,label:a})}),t},dealData:function(a,t){var e={},i=[],l="";return a.forEach(function(a){if(a.data.length<t.length){for(var s=0,o=a.data.length;s<o;s++)l=t[s].prop,e[l]=a.data[s]||0==a.data[s]?a.data[s]:"--";for(var n=a.data.length;n<t.length;n++)l=t[n].prop,e[l]="--"}else for(var r=0,c=a.data.length;r<c;r++)l=t[r].prop,e[l]=a.data[r]||0==a.data[r]?a.data[r]:"--";i.push(e),e={}}),i},reportHandler:function(a){this.emitData=a,this.asisName=a.asis_tit,this.radioDate="totalTraffic",this.tableIds?this.getTableData(this.tableIds):this.getChartIds()},changeTabSelect:function(a){this.loading=!0;var t="";"totalTraffic"===a?(t+=this.tableKeyToId.totalPassengerCompare,t+=","+this.tableKeyToId.totalAndAverageTraffic,this.tableIds=t,this.getTableData(t)):(t+=this.tableKeyToId.dayCompareTable,t+=","+this.tableKeyToId.dayCompareLine,this.tableIds=t,this.getTableData(t))}}}}).call(t,e("7t+N"))},lBxj:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e("C8Sn"),l={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"base-analysis"},[e("el-header",{attrs:{height:"70px"}},[e("span",{staticClass:"asis-title"},[a._v(a._s(a.asisName)+" "+a._s(a.$t("asis.Timecomp")))]),a._v(" "),e("span",{staticClass:"more-option-wrapper",on:{click:a.showCollapse}},[e("span",{staticClass:"more-option-text"},[a._v(a._s(a.$t("asis.moreOp")))]),a._v(" "),e("i",{class:a.moreOptVisible?"el-icon-arrow-down more-option-arrow":"el-icon-arrow-down more-option-arrow more-option-up"})])]),a._v(" "),e("tc-option",{directives:[{name:"show",rawName:"v-show",value:a.moreOptVisible,expression:"moreOptVisible"}],ref:"init",attrs:{mallData:a.mallData},on:{reportTime:a.reportHandler,initData:a.initTab}}),a._v(" "),e("div",{staticClass:"element-main tc-main"},[e("div",{staticClass:"asis-table-wrapper"},[e("h3",{staticClass:"asis-table-header single-report-header tf-table-header"},[e("span",{staticClass:"asis-table-download",on:{click:function(t){a.dealExport("domTrafficFlow",a.i18nFormatter(a.tc_title))}}},[a._v(a._s(a.$t("allPages.load")))])]),a._v(" "),e("div",{staticClass:"date-radio-wrapper tf-ratio-group single-ratio-group"},[e("el-radio-group",{attrs:{size:"mini",fill:"#0069FF"},on:{change:function(t){a.changeTabSelect(a.radioDate)}},model:{value:a.radioDate,callback:function(t){a.radioDate=t},expression:"radioDate"}},[e("el-radio-button",{attrs:{label:"totalTraffic",border:""}},[a._v(a._s(a.$t("button.totalTraffic")))]),a._v(" "),e("el-radio-button",{attrs:{label:"dayTraffic",border:""}},[a._v(a._s(a.$t("button.dayTraffic")))])],1)],1),a._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],staticClass:"asis-table-content"},[e("el-table",{staticClass:"asis-table",staticStyle:{width:"100%"},attrs:{id:"domTrafficFlow",data:a.trafficTab,"header-row-class-name":"asis-table-head","max-height":a.tableHeight}},[a.trafficHead.length>0?e("el-table-column",{attrs:{type:"index",align:"center",label:a.$t("table.order"),width:"100"}}):a._e(),a._v(" "),a._l(a.trafficHead,function(a){return e("el-table-column",{key:a.prop,attrs:{prop:a.prop,label:a.label,align:"center"}})})],2),a._v(" "),e("div",{attrs:{id:"pieLineChart"}})],1)])])],1)},staticRenderFns:[]},s=function(a){e("z1Qp")},o=e("VU/8")(i.a,l,!1,s,"data-v-c1560c66",null);t.default=o.exports},z1Qp:function(a,t){}});