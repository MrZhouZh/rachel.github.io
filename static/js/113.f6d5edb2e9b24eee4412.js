webpackJsonp([113],{AXLT:function(module,__webpack_exports__,__webpack_require__){"use strict";(function($){var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty__=__webpack_require__("bOdI"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_json_stringify__=__webpack_require__("mvHQ"),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_2__public_exportData__=__webpack_require__("pJt5"),__WEBPACK_IMPORTED_MODULE_3__common_option_areaFlowTimeOps__=__webpack_require__("OB4f"),__WEBPACK_IMPORTED_MODULE_4__public_myColum__=__webpack_require__("ORyR");__webpack_exports__.a={data:function(){return{moreOptVisible:!1,tableData:[],repTitle:"",loading:!0,tableHeight:0,aft_title:"areaFlowTime",emitData:{},radioDate:"pt",isTabChart:!1,tableKeyToId:{},tableIds:"",lineData:[],ptLineData:[],pnLineData:[],firstFlag:!0,col:[],cacheCol:[],catchTableData:[],myEchart:{}}},components:{"aft-option":__WEBPACK_IMPORTED_MODULE_3__common_option_areaFlowTimeOps__.a,"export-data-dialog":__WEBPACK_IMPORTED_MODULE_2__public_exportData__.a,"comp-column":__WEBPACK_IMPORTED_MODULE_4__public_myColum__.a},created:function(){var t=this,e=$(window).height(),a=.28;e<=720?a=.35:e<=768?a=.33:e<=900?a=.28:e<=1080&&(a=.31),this.tableHeight=e-e*a,window.addEventListener("resize",function(){try{var e={chart1:$("#arealineChart")[0]};for(var a in e)if(e.hasOwnProperty(a)&&void 0!=e[a]){e[a]=t.$echarts.init(e[a]);e[a].resize()}}catch(t){}})},mounted:function(){this.showCollapse()},methods:{showCollapse:function(){var t=this,e="",a="",i="",o="";e=this.getStyleFn(".el-header","height"),a=this.getStyleFn(".customgroup-wrapper .el-header","height"),this.moreOptVisible?(this.moreOptVisible=!1,o=e+a+8+"px",$(".behavior-main").animate({marginTop:o})):(this.moreOptVisible=!0,setTimeout(function(){i=document.documentMode?(i=t.getStyleFn(".behavior-more-option","height"))+t.getStyleFn(".behavior-more-option","paddingTop")+t.getStyleFn(".behavior-more-option","paddingBottom"):t.getStyleFn(".behavior-more-option","height"),o=e+a+i+8+"px",$(".behavior-main").animate({marginTop:o})},100))},getChartId:function(){var t=this;this.tableKeyToId={},this.tableIds="",this.axios.get("/reportCharts",{params:{report:"zoneCustomerTimeShare",_t:Date.parse(new Date)/1e3}}).then(function(e){var a=e.data.data;a.forEach(function(e,i){t.tableKeyToId[e.key]=e.id,"customerMantime"!==e.key&&"customerCount"!==e.key&&"customerMantimeAndCount"!==e.key||(i==a.length-1?t.tableIds+=e.id:t.tableIds+=e.id+",")}),t.getTableData(t.tableIds)}).catch(function(t){})},getTableData:function(t){var e=this,a="",i={};a="/report/zoneCustomerTimeShare/zone",i={orgIds:this.emitData.orgIds,date:this.emitData.date,chartIds:t,_t:Date.parse(new Date)/1e3},this.tableData=this.col=this.cacheCol=this.cacheTableData=[],this.axios.get(a,{params:i}).then(function(t){setTimeout(function(){e.loading=!1},500);var a=t.data.data.body;if("{}"!==__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_json_stringify___default()(a)){var i=a.customerMantimeAndCount.xaxis.data;e.col=e.dealThead(i),e.cacheCol=e.col;var o={};a.customerMantimeAndCount.series.forEach(function(t){t.data.forEach(function(t,e){o["defaultOrg"+e]=t||0==t?t:"--"}),e.tableData.push(o),o={}}),e.cacheTableData=e.tableData,e.pnLineData=e.dataToEcharts(a.customerCount),e.ptLineData=e.dataToEcharts(a.customerMantime),"pt"===e.radioDate&&(e.lineData=e.ptLineData),e.isTabChart||e.drawLine()}}).catch(function(t){console.log(" err:",t.message,t)})},dealThead:function dealThead(theadData){var cols=[],$index=0;return(cols=theadData.map(function(item,index){if(/^\[.+\]$/.test(item)){var formatItem=eval(item);return{label:formatItem[0],children:formatItem.map(function(t,e){return e>0&&{prop:"defaultOrg"+$index++,label:t}}).filter(Boolean)}}return{prop:"defaultOrg"+$index++,label:item,fixed:!0,width:120}})).unshift({type:"index",label:this.$t("table.order"),fixed:!0,width:60}),cols},dataToEcharts:function(t){var e,a='"PingFang SC", "Lantinghei SC", "Microsoft YaHei", "HanHei SC", "Helvetica Neue", "Open Sans", Arial, "Hiragino Sans GB", 微软雅黑, STHeiti, "WenQuanYi Micro Hei", SimSun, sans-serif',i=this;return{title:{text:""},legend:{type:"scroll",orient:"horizontal",x:"center",itemWidth:12,itemHeight:12,itemGap:15,bottom:6,data:t.series.map(function(t){return{name:t.name}})},color:["#3BB8FF","#FFC62E","#FF9631","#4396ec","#f39c38","#4054af","#d83965","#e35241","#9036aa","#6041b0","#4fb9d1","#3f9488","#97c05c","#154bee"],tooltip:{show:!0,trigger:"axis",backgroundColor:"#fff",padding:[0,0,0,0],textStyle:{color:"#333333"},axisPointer:{type:"line",animation:!0,lineStyle:{color:"#444"}},extraCssText:"box-shadow: 0px 0px 10px -4px rgba(3, 3, 3, .4)",formatter:function(t,e,a){var o="",l="";return l="pt"===i.radioDate?i.$t("format.perTime"):i.$t("format.perNum"),o+='<div style="font-size:16px;height:31px;color:#333;border-radius:4px;line-height:31px;padding-left:15px; padding-right:15px; text-align: left; color: #0068FF;">'+t[0].axisValue+"</div><div>",t.forEach(function(t){o+='<p style="font-size:14px;padding:4px 15px;color:#444;text-align: left;">'+t.marker+"  "+t.seriesName+"："+(t.value||"--")+l+"</p>"}),o+="</div>"}},xAxis:(e={type:"category",boundaryGap:!1,axisTick:{show:!1},axisLabel:{textStyle:{color:"#888",fontFamily:a}},axisLine:{show:!0,lineStyle:{color:"#888"}}},__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty___default()(e,"axisTick",{show:!1}),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty___default()(e,"data",t.xaxis.data),e),yAxis:{type:"value",nameTextStyle:{color:"#444",fontSize:13,fontFamily:a},axisTick:{show:!1},axisLabel:{textStyle:{color:"#888",fontFamily:a}},axisLine:{show:!0,lineStyle:{color:"#888"}},splitLine:{show:!0,lineStyle:{color:"#f5f5f5"}}},grid:{left:52,right:26,top:26,bottom:60},series:t.series.map(function(t){return t.symbolSize=6,t.lineStyle={width:3},t})}},drawLine:function(){var t=document.getElementById("arealineChart");this.$echarts.getInstanceByDom(t)?(this.$echarts.init(t).dispose(),this.myEchart=this.$echarts.init(t)):this.myEchart=this.$echarts.init(t),this.firstFlag||this.myEchart.clear(),this.firstFlag=!1,this.myEchart.clear(),this.myEchart.setOption(this.lineData)},startLoad:function(t){"areaFlowTime"===t&&(this.loading=!0)},changeTabSelect:function(t){var e=this;this.loading=!0,this.lineData="pt"===t?this.ptLineData:this.pnLineData,setTimeout(function(){e.drawLine(),e.loading=!1},1e3)},selReport:function(t){var e=this;"line"===t?this.isTabChart&&(this.loading=!0,this.isTabChart=!1,setTimeout(function(){e.drawLine(),e.loading=!1},1e3)):this.isTabChart||(this.tableData=this.col=[],this.isTabChart=!0,this.loading=!0,setTimeout(function(){e.col=e.cacheCol,e.tableData=e.cacheTableData,e.loading=!1},500))},getPatams:function(t){this.emitData=t,this.repTitle=t.title,this.tableIds?this.getTableData(this.tableIds):this.getChartId()},exportDataHandle:function(t,e,a){var i=a?this.tableKeyToId[a]:this.isTabChart?this.tableKeyToId.customerMantimeAndCount:"pt"===this.radioDate?this.tableKeyToId.customerMantime:this.tableKeyToId.customerCount,o={domId:this.isTabChart?"domAreaFlowTime":"arealineChart",title:e,data:{url:"/report/zoneCustomerTimeShare/zone/"+i+"/excel",params:"orgIds="+this.emitData.orgIds+"&date="+this.emitData.date}};this.$refs.exportDialog.dialogInit(o)}}}}).call(__webpack_exports__,__webpack_require__("7t+N"))},NGfg:function(t,e){},OB4f:function(t,e,a){"use strict";var i={data:function(){return{date1:"",pickerOptions1:{disabledDate:function(t){return t.getTime()>Date.now()}},mallName:"",mallVal:"",mallOpt:[],monitoryVal:[],monitoryName:"",monitoryOpt:[],cameraVal:"",cameraOpt:[],typeVal:"",timeVal:"",account_id:"",isSingle:!1,idArr:[],isSelAll:!1}},created:function(){},mounted:function(){this.account_id=this.$cookie.get("accountId"),this.timeVal=dateUnit.dateFormat(new Date,"yyyy-MM-dd"),this.getMallList()},methods:{getMallList:function(){var t=this;this.mallOpt=[],this.mallVal="",this.mallName="",this.axios.get("/malls",{params:{accountId:this.account_id,status:1,_t:Date.parse(new Date)/1e3}}).then(function(e){var a=e.data.data,i="";if(t.len=a.length,a.length>0){var o=window.sessionStorage.getItem("mallId");o&&Number(o),t.mallOpt=a,a.forEach(function(t,e){o&&t.id==o&&(i=t.name)}),t.mallName=i||a[0].name,t.mallVal=o?Number(o):a[0].id,t.getZones(t.mallVal)}}).catch(function(t){})},chooseMall:function(){var t=this;this.mallOpt.forEach(function(e){e.id==t.mallVal&&(t.mallName=e.name)}),this.getZones(this.mallVal)},getZones:function(t){var e=this;this.monitoryOpt=[],this.monitoryVal=[],this.monitoryName="",this.isSelAll=!1,this.axios.get("/zones",{params:{mallId:t,status:1,sortName:'"floor".name, "zone".name',_t:Date.parse(new Date)/1e3}}).then(function(t){var a=t.data;a.data.length&&(a.data.forEach(function(t,a,i){e.monitoryVal.push(t.id),0==a&&(e.monitoryName=t.name+" ")}),e.monitoryOpt=a.data,e.monitoryVal.length==e.monitoryOpt.length&&(e.isSelAll=!0),e.clickHandle())}).catch(function(t){})},chooseMonitory:function(){var t=this;this.isSelAll=(this.isSelAll,!(this.monitoryVal.length<this.monitoryOpt.length)),this.monitoryName="",this.monitoryVal.length>0&&this.monitoryOpt.forEach(function(e){return e.id==t.monitoryVal[0]&&(t.monitoryName=e.name),!1})},selAllHandle:function(){var t=this;this.isSelAll?(this.isSelAll=!1,this.monitoryVal.length==this.monitoryOpt.length&&(this.monitoryVal=[])):(this.isSelAll=!0,this.monitoryVal.length==this.monitoryOpt.length?this.monitoryVal=[]:(this.monitoryVal=[],this.monitoryOpt.forEach(function(e){t.monitoryVal.push(e.id)})))},clickHandle:function(){var t=this;this.idArr=[];for(var e="",a=0;a<this.monitoryVal.length;a++)"all"!==this.monitoryVal[a]&&this.idArr.push(this.monitoryVal[a]);this.$emit("startLoading","areaFlowTime"),this.timeVal=this.timeVal.length>1?this.timeVal:new Date,setTimeout(function(){var a="";t.idArr.forEach(function(t,e,i){a+=t+","}),a=a.substring(0,a.length-1),e=t.mallName?t.mallName+"-":t.mallName;var i={orgIds:a,date:t.timeVal,title:e+t.monitoryName+" "+t.timeVal+" "};t.$emit("emitParams",i)},2e3)}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"behavior-more-option behavior-test-option"},[a("div",{staticClass:"opt-left"},[a("div",{staticClass:"test-opt-mall"},[a("el-select",{staticClass:"mall-opt",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect")},on:{change:t.chooseMall},model:{value:t.mallVal,callback:function(e){t.mallVal=e},expression:"mallVal"}},t._l(t.mallOpt,function(t,e){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("div",{staticClass:"test-opt-monitory"},[a("el-select",{staticClass:"multipleClass mall-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.site"),multiple:"","collapse-tags":""},on:{change:t.chooseMonitory},model:{value:t.monitoryVal,callback:function(e){t.monitoryVal=e},expression:"monitoryVal"}},[a("div",{class:t.isSelAll?"sel-all-box selected":"sel-all-box",on:{click:t.selAllHandle}},[a("span",{staticClass:"custom-checkbox__input"},[a("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(t.$t("allPages.all")))])]),t._v(" "),t._l(t.monitoryOpt,function(e,i){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.id}},[a("span",{staticClass:"custom-checkbox__input"},[a("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(e.name))])])})],2)],1),t._v(" "),a("div",{staticClass:"test-opt-time"},[a("el-date-picker",{staticClass:"time-opt",attrs:{type:"date","picker-options":t.pickerOptions1,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:t.timeVal,callback:function(e){t.timeVal=e},expression:"timeVal"}})],1)]),t._v(" "),a("div",{staticClass:"opt-right"},[a("el-button",{staticClass:"primary-btn behavior-collapse-btn",attrs:{type:"primary",size:"samll"},on:{click:t.clickHandle}},[t._v(t._s(t.$t("button.confirm")))])],1)])},staticRenderFns:[]},l=a("VU/8")(i,o,!1,function(t){a("NGfg")},"data-v-b3651220",null);e.a=l.exports},ORyR:function(t,e,a){"use strict";var i={name:"MyColum",props:{col:{type:Object}}},o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("el-table-column",{attrs:{label:this.col.label,prop:this.col.prop,align:"center",fixed:this.col.fixed||!1,width:this.col.width,type:this.col.type}},[this.col.children?this._l(this.col.children,function(t,a){return e("my-colum",{key:a,attrs:{col:t}})}):this._e()],2)},staticRenderFns:[]},l=a("VU/8")(i,o,!1,function(t){a("bYIo")},"data-v-5660a098",null);e.a=l.exports},bYIo:function(t,e){},ikeu:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("AXLT"),o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"customgroup-wrapper"},[a("el-header",{attrs:{height:"70px"}},[a("span",{staticClass:"behavior-title"},[t._v(t._s(t.repTitle)+t._s(t.$t("Behavior.areaflowtime")))]),t._v(" "),a("span",{staticClass:"more-option-wrapper",on:{click:t.showCollapse}},[a("span",{staticClass:"more-option-text"},[t._v(t._s(t.$t("Behavior.moreOp")))]),t._v(" "),a("i",{class:t.moreOptVisible?"el-icon-arrow-down more-option-arrow":"el-icon-arrow-down more-option-arrow more-option-up"})])]),t._v(" "),a("aft-option",{directives:[{name:"show",rawName:"v-show",value:t.moreOptVisible,expression:"moreOptVisible"}],ref:"searchRef",on:{emitParams:t.getPatams,startLoading:t.startLoad}}),t._v(" "),a("div",{staticClass:"element-main behavior-main"},[a("div",{staticClass:"asis-table-wrapper"},[a("div",{staticClass:"chart-top"},[t.isTabChart?t._e():a("div",{staticClass:"date-radio-wrapper tf-ratio-group single-ratio-group"},[a("el-radio-group",{attrs:{size:"mini",fill:"#0069FF"},on:{change:function(e){t.changeTabSelect(t.radioDate)}},model:{value:t.radioDate,callback:function(e){t.radioDate=e},expression:"radioDate"}},[a("el-radio-button",{attrs:{label:"pt",border:""}},[t._v(t._s(t.$t("button.personTime")))]),t._v(" "),a("el-radio-button",{attrs:{label:"pn",border:""}},[t._v(t._s(t.$t("button.personNum")))])],1)],1),t._v(" "),a("span",{staticClass:"asis-table-download",on:{click:function(e){t.exportDataHandle("arealineChart",t.i18nFormatter(t.aft_title))}}},[t._v(t._s(t.$t("allPages.load")))]),t._v(" "),a("span",{staticClass:"report-type-box"},[a("span",{class:t.isTabChart?"report-item line-report":"report-item line-report report-item-line",on:{click:function(e){t.selReport("line")}}}),t._v(" "),a("span",{class:t.isTabChart?"report-item report-item-tab":"report-item",on:{click:function(e){t.selReport("table")}}})])]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"asis-table-content aft-chart-box"},[t.isTabChart?a("el-table",{staticClass:"asis-table aft-table",staticStyle:{width:"100%"},attrs:{id:"domAreaFlowTime",data:t.tableData,"max-height":t.tableHeight}},t._l(t.col,function(t,e){return a("comp-column",{key:e,attrs:{col:t}})})):a("div",{staticClass:"area-line-chart",style:{height:t.tableHeight},attrs:{id:"arealineChart"}})],1)])]),t._v(" "),a("export-data-dialog",{ref:"exportDialog"})],1)},staticRenderFns:[]},l=function(t){a("nqFS")},n=a("VU/8")(i.a,o,!1,l,"data-v-64388a0e",null);e.default=n.exports},nqFS:function(t,e){}});