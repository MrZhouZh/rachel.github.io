webpackJsonp([118],{SkL4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("s0Hs"),s={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"login-wrapper"},["mall"!==this.$Project?t("div",{staticClass:"login-header"},[t("lange-Select",{staticClass:"login-lang"})],1):this._e(),this._v(" "),this._m(0)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"login-box"},[t("div",{staticClass:"login-bg"}),this._v(" "),t("div",{staticClass:"right-form"},[t("p",{staticClass:"login-footer"},[this._v("北京文安智能技术股份有限公司")])])])}]},i=function(e){a("XdWN")},o=a("VU/8")(n.a,s,!1,i,"data-v-17f08a49",null);t.default=o.exports},XdWN:function(e,t){},s0Hs:function(e,t,a){"use strict";(function(e){var n=a("mvHQ"),s=a.n(n),i=a("n2YA");window.addEventListener("resize",function(){e(".login-wrapper").css({height:window.innerHeight+"px"})}),t.a={data:function(){return{loginForm:{loginName:"",password:""}}},components:{"lange-Select":i.a},created:function(){var e=this;document.addEventListener("keyup",function(t){13===window.event.keyCode&&e.submitForm("loginForm")})},mounted:function(){if(this.checkCookie(),-1===window.location.href.indexOf("?"));else{var e=window.location.href.split("?")[1].split("&"),t=e[0].split("=")[1],a=e[1].split("=")[1];this.loginForm={loginName:t,password:a},console.log(this.loginForm),this.submitForm("loginForm")}},methods:{submitForm:function(e){var t=this;this.falg=!0,this.axios.post("/users/login",this.loginForm).then(function(e){t.$cookie.set("userId",e.data.data.user.id),t.$cookie.set("atoken",e.data.data.atoken),t.$cookie.set("rtoken",e.data.data.rtoken),t.$cookie.set("user_unid",e.data.data.user_unid),t.$cookie.set("user_type",e.data.data.userType),t.setSessionLocal("loginName",e.data.data.user.loginName),window.sessionStorage.setItem("loginVal",!0),"super"===e.data.data.userType?t.getAccName(0,!0):e.data.data.user.accountId?(t.$cookie.set("accountId",e.data.data.user.accountId),t.getAccName(e.data.data.user.accountId)):t.getAccName(-1)}).catch(function(e){setTimeout(function(){t.falg=!1},1e3),e?t.$message({showClose:!0,type:"error",message:e.data.msg.enote}):t.$message({showClose:!0,type:"error",message:t.$t("message.loginFailed")})})},getNode:function(){var e=this;this.axios.get(window.menuUrl+"/api/v1/auth/apps",{params:{_t:Date.parse(new Date)/1e3}}).then(function(t){var a=t.data.list_data;0==a.length&&e.$message({showClose:!0,type:"warning",message:e.$t("message.nomenu")}),a.forEach(function(t,a){t.name==e.$Project&&(e.appunid=t.unid)}),e.getMeun(e.appunid)}).catch(function(e){})},getMeun:function(e){var t=this;this.axios.get(window.menuUrl+"/api/v1/auth/apps/"+e+"/menus",{params:{_t:Date.parse(new Date)/1e3}}).then(function(e){var a=e.data.menu_tree,n=[];if(0==a.length)t.$message({showClose:!0,type:"warning",message:t.$t("message.nomenu")});else{a.length>=2?n.push(a[1]):n.push(a[0]);var i=[];0!=n.length&&n.forEach(function(e,t){e.children.forEach(function(e,t){var a=[],n={};n.unid=e.unid,n.id=e.perm_unid,n.label=e.name,i.push(n),e.children.forEach(function(t,n){var s={};e.unid==t.parent&&(s.unid=t.unid,s.id=t.perm_unid,s.label=t.name),a.push(s)}),i[t].children=a})}),t.treeData=i;var o=s()(t.treeData);window.localStorage.setItem("menu",o),window.sessionStorage.setItem("loginVal",!0),t.$router.push("/home")}}).catch(function(e){})},getAccName:function(e,t){var a=this;e=-1==e||0==e?null:e,this.axios.get("/accounts",{params:{id:e,_t:Date.parse(new Date)/1e3}}).then(function(e){if(e.data.data.length<1)t?(a.$cookie.set("accountId",0),a.$cookie.set("accountName","none")):a.$message({showClose:!0,type:"wraning",message:a.$t("message.noBloc")});else{var n=e.data.data[0].name;a.$cookie.set("accountId",e.data.data[0].id),a.$cookie.set("accountName",n),a.getcityList(),window.allMenu&&a.$router.push("/home")}window.allMenu||a.getNode()})},getcityList:function(){this.axios.get("/citys",{params:{_t:Date.parse(new Date)/1e3}}).then(function(e){var t={};e.data.data.forEach(function(e,a,n){t[e.cityId]=e.cityName});var a=s()(t);window.sessionStorage.setItem("cityMap",a)}).catch(function(e){})},checkCookie:function(){var e=this.$cookie.get("username"),t=this.$cookie.get("pwd");""!==e&&""!==t?(this.loginForm.loginName=e,this.loginForm.password=t):(this.loginForm.loginName="",this.loginForm.password="")}}}}).call(t,a("7t+N"))}});