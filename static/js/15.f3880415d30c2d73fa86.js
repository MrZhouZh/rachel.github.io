webpackJsonp([15],{Fxn9:function(t,e,a){"use strict";(function(t){e.a={data:function(){var t=this;return{addDialogVisible:!1,addForm:{name:"",username:"",logoPath:"",intro:""},logoUploadUrl:window.apiUrl+"/accounts/upload",logoPathUrl:window.apiUrl+"/accounts/img/",addFileName:"",uploadHeader:{},rules:{username:[{validator:function(e,a,o){return""===a?o(new Error("请输入管理员名称")):a.length<2||a.length>10?o(new Error("长度在 2到 10 个字符")):void t.axios.get("/users",{params:{loginName:a,_t:Date.parse(new Date)/1e3}}).then(function(t){if(0!=t.data.data.length)return o(new Error("管理员名称重复,请重新输入"));o()}).catch(function(t){})},trigger:"blur"}],name:[{validator:function(e,a,o){return""===a?o(new Error("请输入集团名称")):a.length<2||a.length>10?o(new Error("长度在 2到 10 个字符")):void t.axios.get("/accounts",{params:{name:a,_t:Date.parse(new Date)/1e3}}).then(function(t){if(0!=t.data.data.length)return o(new Error("集团名称重复,请重新输入"));o()}).catch(function(t){})},trigger:"blur"}]},isIe:null}},mounted:function(){this.uploadHeader={Authorization:this.$cookie.get("atoken")},this.isIe=!!document.documentMode&&document.documentMode},inject:["reload"],methods:{update:function(){var e=this;t("#fileForm").ajaxSubmit({url:e.logoUploadUrl,type:"post",enctype:"multipart/form-data",ContentType:"application/x-www-form-urlencoded;charset=utf-8",headers:{Authorization:e.$cookie.get("atoken")},success:function(a){t("#fileForm").clearForm(),200==a.code&&(e.addForm.logoPath=a.msg)}})},dialogInit:function(){this.addDialogVisible=!0},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type,a=t.size/1024/1024<2;return e||this.$message.error(this.$t("message.uploadImg")+" JPG "+this.$t("message.imgFormat")),a||this.$message.error(this.$t("message.imgSize")+" 2MB!"),e&&a},handleAvatarSuccess:function(t,e){200==t.code?(this.addFileName=t.msg,this.addForm.logoPath=URL.createObjectURL(e.raw)):(this.addFileName="",this.addForm.logoPath="",this.$message({showClose:!0,message:this.$t("message.upload")+t.enote,type:"warning"}))},handleAvatarError:function(t,e){this.$message({showClose:!0,message:this.$t("message.uploadFailed"),type:"warning"})},addSubmit:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.addForm.createUser=e.$cookie.get("userId"),e.addForm.modifyUser=e.$cookie.get("userId"),e.addForm.logoPath=e.addFileName,e.addForm.manager=e.addForm.username;var a=e.addForm.username;e.axios.post("/accounts",e.addForm).then(function(t){var o=t.data.data.id;e.axios.post("/users/addUser",{accountId:o,loginName:a,realName:"xxx",password:"123456"}).then(function(t){}).catch(function(t){}),e.addDialogVisible=!1,e.$cookie.set("accountId",o),setTimeout(function(){e.reload()},0)}).catch(function(t){})})},addDialogClose:function(){this.$refs.addForm.resetFields()},logoPlanFormatter:function(t){if(console.log(t),t){if(-1!=t.indexOf("blob:"))return t;return this.logoPathUrl+t}return defaultImg}}}}).call(e,a("7t+N"))},HUiw:function(t,e,a){"use strict";var o=a("izGz"),i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"manage-dialog",attrs:{title:t.$t("dialog.editBloc"),visible:t.editDialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.editDialogVisible=e},close:t.editDialogClose}},[a("el-form",{ref:"editForm",attrs:{model:t.editForm}},[a("el-form-item",{attrs:{label:t.$t("dialog.blocName"),prop:"name"}},[a("el-input",{model:{value:t.editForm.name,callback:function(e){t.$set(t.editForm,"name",e)},expression:"editForm.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:t.$t("dialog.admin"),prop:"manager"}},[a("el-input",{model:{value:t.editForm.manager,callback:function(e){t.$set(t.editForm,"manager",e)},expression:"editForm.manager"}})],1),t._v(" "),t.isIe<=9&&"number"==typeof t.isIe?a("el-form-item",{attrs:{label:t.$t("dialog.logo"),prop:"logoPath"}},[t.editForm.logoPath?a("img",{staticClass:"avatar",attrs:{src:t.logoPlanFormatter(t.editForm.logoPath)}}):t._e(),t._v(" "),a("form",{attrs:{id:"fileForm",enctype:"multipart/form-data",methods:"post"}},[a("input",{attrs:{type:"file",id:"fileInput",name:"file"},on:{change:t.update}})])]):a("el-form-item",{attrs:{label:t.$t("dialog.logo"),prop:"logoPath"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.logoUploadUrl,"show-file-list":!1,headers:t.uploadHeader,"before-upload":t.beforeAvatarUpload,"on-success":t.handleEditSuccess,"on-error":t.handleAvatarError}},[t.editForm.logoPath?a("img",{staticClass:"avatar",attrs:{src:t.logoPlanFormatter(t.editForm.logoPath)}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),a("el-form-item",{attrs:{label:t.$t("dialog.description")}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.editForm.intro,callback:function(e){t.$set(t.editForm,"intro",e)},expression:"editForm.intro"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"dialog-btn",on:{click:function(e){t.editDialogVisible=!1}}},[t._v(t._s(t.$t("dialog.cancel")))]),t._v(" "),a("el-button",{staticClass:"dialog-btn dialog-confirm-btn",attrs:{type:"primary"},on:{click:function(e){t.editSubmit("editForm")}}},[t._v(t._s(t.$t("dialog.confirm")))])],1)],1)},staticRenderFns:[]},l=a("VU/8")(o.a,i,!1,null,null,null);e.a=l.exports},HlFX:function(t,e,a){"use strict";var o=a("Fxn9"),i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"manage-dialog",attrs:{title:t.$t("dialog.addBloc"),visible:t.addDialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.addDialogVisible=e},close:function(e){t.addDialogClose()}}},[a("el-form",{ref:"addForm",attrs:{model:t.addForm,"status-icon":"",rules:t.rules,"label-width":"formLabelWidth"}},[a("el-form-item",{attrs:{label:t.$t("dialog.blocName"),prop:"name",required:""}},[a("el-input",{model:{value:t.addForm.name,callback:function(e){t.$set(t.addForm,"name",e)},expression:"addForm.name"}}),t._v(" "),a("i",{staticClass:"error-tip"},[t._v("*")])],1),t._v(" "),a("el-form-item",{attrs:{label:t.$t("dialog.admin"),prop:"username",required:""}},[a("el-input",{model:{value:t.addForm.username,callback:function(e){t.$set(t.addForm,"username",e)},expression:"addForm.username"}}),t._v(" "),a("i",{staticClass:"error-tip"},[t._v("*")])],1),t._v(" "),t.isIe<=9&&"number"==typeof t.isIe?a("el-form-item",{attrs:{label:t.$t("dialog.logo"),prop:"logoPath"}},[t.addForm.logoPath?a("img",{staticClass:"avatar",attrs:{src:t.logoPlanFormatter(t.addForm.logoPath)}}):t._e(),t._v(" "),a("form",{attrs:{id:"fileForm",enctype:"multipart/form-data",methods:"post"}},[a("input",{attrs:{type:"file",id:"fileInput",name:"file"},on:{change:t.update}})])]):a("el-form-item",{attrs:{label:t.$t("dialog.logo"),prop:"logoPath"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.logoUploadUrl,headers:t.uploadHeader,"show-file-list":!1,"before-upload":t.beforeAvatarUpload,"on-success":t.handleAvatarSuccess,"on-error":t.handleAvatarError}},[t.addForm.logoPath?a("img",{staticClass:"avatar",attrs:{src:t.addForm.logoPath}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),a("el-form-item",{attrs:{label:t.$t("dialog.description")}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.addForm.intro,callback:function(e){t.$set(t.addForm,"intro",e)},expression:"addForm.intro"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"dialog-btn",on:{click:function(e){t.addDialogVisible=!1}}},[t._v(t._s(t.$t("dialog.cancel")))]),t._v(" "),a("el-button",{staticClass:"dialog-btn dialog-confirm-btn",attrs:{type:"primary"},on:{click:function(e){t.addSubmit("addForm")}}},[t._v(t._s(t.$t("dialog.confirm")))])],1)],1)},staticRenderFns:[]},l=function(t){a("qdgd")},r=a("VU/8")(o.a,i,!1,l,"data-v-00a69b42",null);e.a=r.exports},NABB:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("RHMR"),i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bloc-wrapper manage-container"},[a("el-row",{staticClass:"manage-head-wrapper"},[a("el-col",{attrs:{span:18}},[a("div",{staticClass:"manage-input-box"},[a("el-input",{staticClass:"search-inp",attrs:{placeholder:t.$t("table.blocName"),size:"mini",clearable:""},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.searchFun(e)}},model:{value:t.name_like,callback:function(e){t.name_like=e},expression:"name_like"}})],1),t._v(" "),a("el-button",{staticClass:"search-btn",attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.searchFun}},[t._v(t._s(t.$t("button.search")))])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-button",{staticClass:"manage-add-btn",attrs:{type:"primary",size:"mini",icon:"el-icon-circle-plus-outline"},on:{click:t.addBlocHandle}},[t._v(t._s(t.$t("button.addGroup")))])],1)],1),t._v(" "),a("el-row",{staticClass:"manage-content"},[a("el-col",{attrs:{span:24}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"max-height":t.tableHeight,"header-row-class-name":"manage-tab-head"}},[a("el-table-column",{attrs:{prop:"tabOrder",align:"center",label:t.$t("table.order"),width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",align:"center",label:t.$t("table.blocName")}}),t._v(" "),a("el-table-column",{attrs:{prop:"manager",align:"center",label:t.$t("table.admin"),width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"logoPath",align:"center",label:"logo",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{placement:"right",title:"",trigger:"hover"}},[a("img",{staticClass:"zoomout-bloc-img",attrs:{src:t.logoPlanFormatter(e.row.logoPath),width:"150",height:"150"}}),t._v(" "),a("img",{staticClass:"bloc-img",attrs:{slot:"reference",src:t.logoPlanFormatter(e.row.logoPath),alt:t.logoPlanFormatter(e.row.logoPath),width:"50",height:"50"},slot:"reference"})])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"createTime",align:"center",label:t.$t("table.CreatTime")}}),t._v(" "),a("el-table-column",{attrs:{prop:"user.realName",align:"center",label:t.$t("table.founder")}}),t._v(" "),a("el-table-column",{attrs:{prop:"intro",align:"center",label:t.$t("table.describe")}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:t.$t("table.operate")},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"tab-btn",attrs:{type:"text",size:"small"},on:{click:function(a){t.editRow(e.row)}}},[t._v(t._s(t.$t("button.edit")))])]}}])})],1),t._v(" "),a("el-pagination",{staticClass:"manage-pagination-box",attrs:{background:"","current-page":t.currentPage,"page-sizes":[10,20,50,100],"page-size":t.pageSize,"popper-class":"popper-class",layout:"sizes, prev, pager, next, slot",total:t.total},on:{"size-change":t.sizeChange,"current-change":t.cerrentChange}},[a("span",{staticClass:"slot-pagination-ele slot-ele-total"},[t._v(t._s(t.$t("table.pageHead"))+" "+t._s(t.total)+" "+t._s(t.$t("table.pageTail")))])])],1)],1),t._v(" "),a("add-bloc-manage",{ref:"addblocModel"}),t._v(" "),a("edit-bloc-manage",{ref:"editblocModel"})],1)},staticRenderFns:[]},l=function(t){a("OiLA")},r=a("VU/8")(o.a,i,!1,l,"data-v-ef3e66ba",null);e.default=r.exports},OiLA:function(t,e){},RHMR:function(t,e,a){"use strict";(function(t){var o=a("mvHQ"),i=a.n(o),l=a("bnIP"),r=a.n(l),n=a("HlFX"),s=a("HUiw");e.a={data:function(){return{logoPathUrl:window.apiUrl+"/accounts/img/",tableHeight:0,name_like:"",rowId:"",tableData:[],total:0,pageSize:10,currentPage:1}},components:{"add-bloc-manage":n.a,"edit-bloc-manage":s.a},created:function(){var e=t(window).height();this.tableHeight=e-.24*e,this.getTableData()},methods:{getTableData:function(){var t=this,e={id:this.$cookie.get("accountId"),name_like:"%"+this.name_like+"%",page:this.currentPage,pageSize:this.pageSize,_t:Date.parse(new Date)/1e3};this.name_like||(e.name_like=null),this.axios.get("/accounts",{params:e}).then(function(e){var a=e.data;a.data.list.forEach(function(e,a){e.tabOrder=(t.currentPage-1)*t.pageSize+a+1}),t.tableData=a.data.list,t.total=a.data.total}).catch(function(t){})},logoPlanFormatter:function(t){if(t){return this.logoPathUrl+t}return r.a},sizeChange:function(t){this.pageSize=t,this.getTableData()},cerrentChange:function(t){this.currentPage!=t&&(this.currentPage=t,this.getTableData())},addBlocHandle:function(){this.$refs.addblocModel.dialogInit()},editRow:function(t){this.rowId=t.id;var e=JSON.parse(i()(t));this.$refs.editblocModel.dialogInit(e)},deleteRow:function(t,e){var a=this;this.$confirm(this.$t("message.delete"),this.$t("message.prompt"),{confirmButtonText:this.$t("message.confirm"),cancelButtonText:this.$t("message.cancel"),type:"warning"}).then(function(){var o=e[t].id;a.axios.delete("/accounts/"+o,{params:{}}).then(function(a){e.splice(t,1)}).catch(function(t){})}).catch(function(){a.$message({showClose:!0,type:"info",message:a.$t("message.cancelDelete")})})},searchFun:function(){this.currentPage=1,this.getTableData()}}}}).call(e,a("7t+N"))},bnIP:function(t,e,a){t.exports=a.p+"static/img/logo.c886a86.png"},izGz:function(t,e,a){"use strict";(function(t){var o=a("bnIP"),i=a.n(o);e.a={data:function(){return{editDialogVisible:!1,uploadHeader:{},editForm:{logoPath:""},logoUploadUrl:window.apiUrl+"/accounts/upload",logoPathUrl:window.apiUrl+"/accounts/img/",rowId:"",editFileName:"",isIe:null}},mounted:function(){this.uploadHeader={Authorization:this.$cookie.get("atoken")},this.isIe=!!document.documentMode&&document.documentMode},methods:{update:function(){var e=this;t("#fileForm").ajaxSubmit({url:e.logoUploadUrl,type:"post",enctype:"multipart/form-data",ContentType:"application/x-www-form-urlencoded;charset=utf-8",headers:e.uploadHeader,success:function(a){200==a.code&&(t("#fileForm").clearForm(),e.editForm.logoPath=a.msg)}})},dialogInit:function(t){this.rowId=t.id,this.editForm=t,this.editForm.logoPath=t.logoPath?t.logoPath:"",this.editDialogVisible=!0},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type,a=t.size/1024/1024<2;return e||this.$message.error(this.$t("message.uploadImg")+" JPG "+this.$t("message.imgFormat")),a||this.$message.error(this.$t("message.imgSize")+" 2MB!"),e&&a},handleEditSuccess:function(t,e){200==t.code?(this.editFileName=t.msg,this.editForm.logoPath=URL.createObjectURL(e.raw),this.$forceUpdate()):(this.editFileName="",this.editForm.logoPath="",this.$message({showClose:!0,message:this.$t("message.uploadFailed")+t.enote,type:"warning"}))},handleAvatarError:function(t,e){this.$message({showClose:!0,message:this.$t("message.uploadFailed"),type:"warning"})},editSubmit:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.editForm.logoPath=e.editFileName?e.editFileName:e.editForm.logoPath,e.axios.post("/accounts/"+e.rowId,e.editForm).then(function(t){e.editDialogVisible=!1,e.$parent.getTableData()}).catch(function(t){})})},editDialogClose:function(){this.editFileName="",this.editForm={logoPath:""},this.$refs.editForm.clearValidate(),this.editForm={logoPath:""},this.editFileName=""},logoPlanFormatter:function(t){if(t){if(-1!=t.indexOf("blob:"))return t;return this.logoPathUrl+t}return i.a}}}}).call(e,a("7t+N"))},qdgd:function(t,e){}});