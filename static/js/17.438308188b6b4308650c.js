webpackJsonp([17],{BC53:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),e.d(a,"lineToTab",function(){return s});var i=e("mvHQ"),l=e.n(i),s=function(t){var a=[],e=[],i=[],s=JSON.parse(l()(t.xaxis.data));s[s.length]="00:00";for(var o=[],n=0,r=s.length;n<r-1;n++)o.push(s[n]+"-"+s[n+1]);var c=[];(c=t.series.map(function(t){return t.name})).unshift("时间段");var h=function(t){var a=[];return t.forEach(function(t,e){a.push({prop:"defaultOrg"+e,label:t})}),a}(c);return t.series.forEach(function(t,a){for(var i=0;i<t.data.length;i++)e[i]=[]}),t.series.forEach(function(t,a){t.data.forEach(function(t,a,i){e[a].push(t)})}),e.forEach(function(t,a){t.unshift(o[a])}),a=e,i=function(t,a){var e={},i=[],l="";return t.forEach(function(t){if(t.length<a.length){for(var s=0,o=t.length;s<o;s++)l=a[s].prop,e[l]=t[s]||0==t[s]?t[s]:"--";for(var n=t.length;n<a.length;n++)l=a[n].prop,e[l]="--"}else for(var r=0,c=t.length;r<c;r++)l=a[r].prop,e[l]=t[r]||0==t[r]?t[r]:"--";i.push(e),e={}}),i}(a,h),{headData:h,bodyData:i}}},"C4/e":function(t,a){},GkWT:function(t,a){},ORyR:function(t,a,e){"use strict";var i={name:"MyColum",props:{col:{type:Object}}},l={render:function(){var t=this.$createElement,a=this._self._c||t;return a("el-table-column",{attrs:{label:this.col.label,prop:this.col.prop,align:"center",fixed:this.col.fixed||!1,width:this.col.width,type:this.col.type}},[this.col.children?this._l(this.col.children,function(t,e){return a("my-colum",{key:e,attrs:{col:t}})}):this._e()],2)},staticRenderFns:[]},s=e("VU/8")(i,l,!1,function(t){e("bYIo")},"data-v-5660a098",null);a.a=s.exports},bYIo:function(t,a){},fELm:function(t,a){},lAQz:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("sGoF"),l={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"base-analysis"},[e("el-header",{attrs:{height:"70px"}},[e("span",{staticClass:"asis-title"},[t._v(t._s(t.asisName)+" "+t._s(t.$t("asis.IoFlow")))]),t._v(" "),e("span",{staticClass:"more-option-wrapper",on:{click:t.showCollapse}},[e("span",{staticClass:"more-option-text"},[t._v(t._s(t.$t("asis.moreOp")))]),t._v(" "),e("i",{class:t.moreOptVisible?"el-icon-arrow-down more-option-arrow":"el-icon-arrow-down more-option-arrow more-option-up"})])]),t._v(" "),e("ioflow-option",{directives:[{name:"show",rawName:"v-show",value:t.moreOptVisible,expression:"moreOptVisible"}],ref:"init",attrs:{mallData:t.mallData},on:{reportTime:t.reportHandler,initData:t.initTab}}),t._v(" "),e("div",{staticClass:"element-main ioflow-main"},[e("div",{staticClass:"asis-table-wrapper"},[t.isTabChart?e("h3",{staticClass:"asis-table-header tf-table-header single-report-header"},[e("span",{staticClass:"asis-table-download",on:{click:function(a){t.dealExport("domTrafficFlow",t.i18nFormatter(t.trafficFlow_title))}}},[t._v(t._s(t.$t("allPages.load")))]),t._v(" "),e("span",{staticClass:"report-type-box"},[e("span",{class:t.isTabChart?"report-item line-report":"report-item line-report report-item-line",on:{click:function(a){t.selReport("line")}}}),t._v(" "),e("span",{class:t.isTabChart?"report-item report-item-tab":"report-item",on:{click:function(a){t.selReport("table")}}})])]):t._e(),t._v(" "),e("div",{staticClass:"date-radio-wrapper tf-ratio-group single-ratio-group"},[e("el-radio-group",{attrs:{size:"mini",fill:"#0069FF"},on:{change:function(a){t.changeTabSelect(t.radioDate)}},model:{value:t.radioDate,callback:function(a){t.radioDate=a},expression:"radioDate"}},[e("el-radio-button",{attrs:{label:"TAB_HOUR",border:""}},[t._v(t._s(t.$t("button.hour")))]),t._v(" "),e("el-radio-button",{attrs:{label:"TAB_MINUTE",border:""}},[t._v(t._s(t.$t("button.min")))])],1)],1),t._v(" "),e("div",{class:t.isTabChart?"asis-table-content":"asis-line-content"},[t.isTabChart?e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.trafficFlowLoading,expression:"trafficFlowLoading"}],staticClass:"asis-table",staticStyle:{width:"100%"},attrs:{id:"domTrafficFlow",data:t.tableData,"header-row-class-name":"asis-table-head","max-height":t.tableHeight}},t._l(t.trafficFlow_head,function(t,a){return e("comp-column",{key:a,attrs:{col:t}})})):e("io-chart",{staticClass:"tf-chart-box",attrs:{id:"tfChart",options:t.trafficFlow_lineOps,chartType:"TfLine"}}),t._v(" "),t.isTabChart?t._e():e("span",{staticClass:"report-type-box line-type-box"},[e("span",{class:t.isTabChart?"report-item":"report-item line-report report-item-line",on:{click:function(a){t.selReport("line")}}}),t._v(" "),e("span",{class:t.isTabChart?"report-item report-item-tab":"report-item",on:{click:function(a){t.selReport("table")}}})]),t._v(" "),t.isTabChart?t._e():e("span",{staticClass:"download-text",on:{click:function(a){t.exportDataHandle("tfChart",t.i18nFormatter(t.trafficFlowing_title),"trafficInAndOut")}}},[t._v(t._s(t.$t("allPages.load")))])],1)])]),t._v(" "),e("export-data-dialog",{ref:"exportDialog"})],1)},staticRenderFns:[]},s=function(t){e("C4/e")},o=e("VU/8")(i.a,l,!1,s,"data-v-8ba8cb26",null);a.default=o.exports},pN1d:function(t,a,e){"use strict";var i,l=e("bOdI"),s=e.n(l),o=e("mvHQ"),n=e.n(o),r=e("GXH0"),c=e.n(r),h=function(t){setTimeout(t,2e3)},m={props:{mallData:Array},data:function(){return{checkedMall:[],pickerOptions1:{disabledDate:function(t){return t.getTime()>Date.now()}},weekPickerOpt:{firstDayOfWeek:1},tabItem:[],panelObj:{mallPanel:!1,floorPanel:!1,formatPanel:!1,ioPanel:!1,shopPanel:!1},analyasisTime:[{label:"日",value:"day",is_active:"time-btn"},{label:"周",value:"week",is_active:"time-btn"},{label:"月",value:"month",is_active:"time-btn"},{label:"年",value:"year",is_active:"time-btn"},{label:"自定义",value:"custom",is_active:"time-btn"}],reportTime:{isDay:!1,isWeek:!1,isMonth:!1,isYear:!1,isCustom:!1},dayTime:"",weekTime:"",monthTime:"",yearTime:"",customTime:"",mallVal:"",floorVal:"",floorItem:"",zoneItem:"",formatVal:"",ioVal:"",gateVal:"",zoneVal:"",asisLevel:"",kpiVal:"TRAFFIC",kpiOpt:[],floorData:[],floorList:[],zoneData:[],zoneList:[],formatData:[],ioData:[],gateData:[],paramId:"",shopFloorData:[],shopFloorId:"",shopFloorVal:"",mutiMallVal:[],mutiFloorVal:[],mutiFormatVal:[],mutiFloorData:[],mutiGateVal:[],mutiZoneVal:[],formatOptions:[{id:"success",label:"with children",children:null},{id:"no-children",label:"width no children",children:null},{id:"failure",label:"Demonstrates error handling",children:null}],mallId:"",floorId:"",ioId:"",zoneId:"",formatId:"",gateLevel:"all",gateLevelList:[{label:"all",value:"all"},{label:"mall",value:"mall"},{label:"floor",value:"floor"},{label:"store",value:"zone"}],isMallSelAll:!1,isFloorSelAll:!1,isGateSelAll:!1,isZoneSelAll:!1}},components:{treeselect:c.a},watch:{},created:function(){if(this.tabItem=[],"mall"===this.$Project){var t={mall:"mall",inOut:"io",floor:"floor",store:"shop"};for(var a in t)this.tabItem.push({label:a,value:t[a],className:"analysis-item"})}else this.tabItem=[{label:"mall",value:"mall",className:"analysis-item"},{label:"inOut",value:"io",className:"analysis-item"}];this.tabClickHandle(0)},methods:(i={i18nFormatter:function(t){var a="asisTab."+t;return this.$t(a)},getTime1:function(){},removeTag:function(){},initAsis:function(t){this.paramId=t,this.mallId=t,this.mutiMallVal.push(t),this.mallVal=t,this.getFloorOpt(t),this.getMallGates(),this.tabClickHandle(0),this.isMallSelAll=this.mutiMallVal.length==this.mallData.length,this.isMallSelAll=this.mutiMallVal.length==this.mallData.length;var a={asis_level:this.asisLevel,asis_date:"day",asis_time:this.dayTime,asis_org:this.paramId,asis_org_name:[]};a.asis_org_name=[],this.$emit("initData",a)},tabClickHandle:function(t){if("analysis-item"===this.tabItem[t].className){this.tabItem.forEach(function(t){t.className="analysis-item"}),this.tabItem[t].className="analysis-item tabs-active";for(var a in this.panelObj)this.panelObj[a]=!1;switch(this.kpiVal="",this.asisLevel="",this.tabItem[t].value){case"mall":this.mutiMallVal=this.mallId?[this.mallId]:[],this.panelObj.mallPanel=!0,this.asisLevel="mall";break;case"floor":this.mutiFloorVal=this.floorId?[this.floorId]:[],this.isFloorSelAll=this.mutiFloorVal.length==this.mutiFloorData.length,this.panelObj.floorPanel=!0,this.asisLevel="floor";break;case"io":this.mallVal=this.mallId,this.floorVal=this.floorId,this.formatVal=this.formatId,this.panelObj.ioPanel=!0,this.asisLevel="gate";break;case"shop":this.mallVal=this.mallId,this.shopFloorVal=this.floorId,this.formatVal=this.formatId,this.mutiZoneVal=this.zoneId?[this.zoneId]:"",this.isZoneSelAll=this.mutiZoneVal.length==this.zoneData.length,this.panelObj.shopPanel=!0,this.asisLevel="zone";break;default:this.kpiOpt=[],this.kpiVal=""}}},getIoOpt:function(t,a){var e=this;this.ioData=[],this.ioId="",this.ioVal="",this.axios.get("/gates",{params:{mallId:t,accountId:this.$cookie.get("accountId"),_t:Date.parse(new Date)/1e3}}).then(function(t){t.data.data.length>0&&(e.ioData=t.data.data,e.ioId=t.data.data[0].id,e.ioVal=e.panelObj.ioPanel?[t.data.data[0].id]:t.data.data[0].id)}).catch(function(t){})},loadOptions:function(t){var a=t.action,e=t.parentNode,i=t.callback;if(a===r.LOAD_CHILDREN_OPTIONS)switch(this.axios.get("/formats",{params:{_t:Date.parse(new Date)/1e3}}),e.id){case"success":h(function(){e.children=[{id:"child",label:"Child option"}],i()});break;case"no-children":h(function(){e.children=[],i()});break;case"failure":h(function(){i(new Error("Failed to load option: network error."))})}},getMallGates:function(){var t=this;this.mutiGateVal=[],this.gateData=[],this.axios.get("/gates",{params:{mallId:this.mallVal,type_arr:"1,3",isMallGate:1,_t:Date.parse(new Date)/1e3}}).then(function(a){if(a.data.data.length>0){var e=a.data.data;t.mutiGateVal=[e[0].id],t.gateData=e}})},gateLevelChange:function(){this.isGateSelAll=!1,"all"===this.gateLevel?this.getAllGates():"mall"===this.gateLevel?this.getMallGates():"floor"===this.gateLevel?this.getFloorList():this.getZoneList()},mallChange:function(){this.mallId=this.mallVal,this.mutiMallVal=[this.mallVal],this.panelObj.ioPanel?(this.gateLevel="all",this.gateLevelChange()):this.getFloorOpt(this.mallVal)}},s()(i,"mallChange",function(){this.getMallGates()}),s()(i,"floorChange",function(){}),s()(i,"mallChangeHandle",function(){this.isMallSelAll=(this.isMallSelAll,!(this.mutiMallVal.length<this.mallData.length))}),s()(i,"gateChangeHandle",function(){this.isGateSelAll=(this.isGateSelAll,!(this.mutiGateVal.length<this.gateData.length))}),s()(i,"floorChangeHandle",function(){this.isFloorSelAll=(this.isFloorSelAll,!(this.mutiFloorVal.length<this.mutiFloorData.length))}),s()(i,"zoneChangeHandle",function(){this.isZoneSelAll=(this.isZoneSelAll,!(this.mutiZoneVal.length<this.zoneData.length))}),s()(i,"mutiMallChange",function(){this.getMutiFloor(this.mallVal)}),s()(i,"floorChange",function(){this.getZoneOpt(this.mallVal,this.shopFloorVal)}),s()(i,"getFloorOpt",function(t){var a=this;this.mutiFloorVal=[],this.mutiFloorData=[],this.shopFloorData=[],this.shopFloorVal="",this.floorId="",this.isFloorSelAll=!1,this.axios.get("/floors",{params:{mallId:t,accountId:this.$cookie.get("accountId"),status:1,_t:Date.parse(new Date)/1e3}}).then(function(e){if(e.data.data.length>0){var i=JSON.parse(n()(e.data.data));i.unshift({name:a.$t("asisTab.all"),id:""}),a.shopFloorData=i,a.mutiFloorData=e.data.data,a.mutiFloorVal=[e.data.data[0].id],a.mutiFloorVal.length==a.mutiFloorData.length&&(a.isFloorSelAll=!0),a.floorId=(a.panelObj.floorPanel,e.data.data[0].id),a.shopFloorVal=e.data.data[0].id,a.getZoneOpt(t,a.shopFloorVal)}else a.getZoneOpt(t)}).catch(function(t){console.log(t.message,t)})}),s()(i,"getMutiFloor",function(t){var a=this;this.mutiFloorVal=[],this.mutiFloorData=[],this.axios.get("/floors",{params:{mallId:t,accountId:this.$cookie.get("accountId"),status:1,_t:Date.parse(new Date)/1e3}}).then(function(t){var e=t.data;e.data.length>0&&(a.mutiFloorData=e.data,a.mutiFloorVal=[e.data[0].id])}).catch(function(t){console.log(t.message)})}),s()(i,"getZoneOpt",function(t,a){var e=this;this.zoneData=[],this.mutiZoneVal=[],this.zoneId="",this.isZoneSelAll=!1,this.axios.get("/zones",{params:{mallId:t,floorId:a,accountId:this.$cookie.get("accountId"),status:1,sortName:'"floor".name, "zone".name',_t:Date.parse(new Date)/1e3}}).then(function(t){t.data.data.length>0&&(e.zoneData=t.data.data,e.zoneId=t.data.data[0].id,e.mutiZoneVal=[t.data.data[0].id],e.mutiZoneVal.length==e.zoneData.length&&(e.isZoneSelAll=!1))}).catch(function(t){console.log(t.message,t)})}),s()(i,"selAllHandle",function(t){var a=this;"mall"===t?this.isMallSelAll?(this.isMallSelAll=!1,this.mutiMallVal.length==this.mallData.length&&(this.mutiMallVal=[])):(this.isMallSelAll=!0,this.mutiMallVal.length==this.mallData.length?this.mutiMallVal=[]:(this.mutiMallVal=[],this.mallData.forEach(function(t){a.mutiMallVal.push(t.id)}))):"floor"===t?this.isFloorSelAll?(this.isFloorSelAll=!1,this.mutiFloorVal.length==this.mutiFloorData.length&&(this.mutiFloorVal=[])):(this.isFloorSelAll=!0,this.mutiFloorVal.length==this.mutiFloorData.length?this.mutiFloorVal=[]:(this.mutiFloorVal=[],this.mutiFloorData.forEach(function(t){a.mutiFloorVal.push(t.id)}))):"gate"===t?this.isGateSelAll?(this.isGateSelAll=!1,this.mutiGateVal.length==this.gateData.length&&(this.mutiGateVal=[])):(this.isGateSelAll=!0,this.mutiGateVal.length==this.gateData.length?this.mutiGateVal=[]:(this.mutiGateVal=[],this.gateData.forEach(function(t){a.mutiGateVal.push(t.id)}))):this.isZoneSelAll?(this.isZoneSelAll=!1,this.mutiZoneVal.length==this.zoneData.length&&(this.mutiZoneVal=[])):(this.isZoneSelAll=!0,this.mutiZoneVal.length==this.zoneData.length?this.mutiZoneVal=[]:(this.mutiZoneVal=[],this.zoneData.forEach(function(t){a.mutiZoneVal.push(t.id)})))}),s()(i,"confirmCondition",function(){var t={asis_level:"",asis_date:"",asis_time:"",asis_org:"",asis_org_name:""};switch(this.asisLevel){case"mall":t.asis_org_name=[],this.paramId=this.mutiMallVal.toString(),t.asis_tit=this.getItemName(this.mallData,this.paramId);break;case"floor":t.asis_org_name=[],this.paramId=this.mutiFloorVal.toString(),t.asis_tit=this.getItemName(this.mallData,this.mallVal.toString())+"-"+this.getItemName(this.mutiFloorData,this.paramId);break;case"gate":if(!this.mutiGateVal.length)return;t.asis_org_name=[],this.paramId=this.mutiGateVal.toString(),t.asis_tit=this.getItemName(this.mallData,this.mallVal.toString())+"-"+this.getItemName(this.gateData,this.paramId);break;case"zone":t.asis_org_name=[],this.paramId=this.mutiZoneVal.toString(),t.asis_tit=this.getItemName(this.mallData,this.mallVal.toString())+"-"+this.getItemName(this.zoneData,this.paramId)}t.asis_level=this.asisLevel,t.asis_date="day",t.asis_time=this.dayTime,t.asis_org=this.paramId,t.asis_kpi=this.kpiVal,this.$emit("reportTime",t)}),s()(i,"filterName",function(t,a){var e=[];return t.forEach(function(t){a.filter(function(a){a==t.id&&e.push(t.name)})}),e}),s()(i,"getItemName",function(t,a){var e="",i=a.split(",")[0];return t.forEach(function(t){t.id==i&&(e=t.name)}),e}),s()(i,"resetRefresh",function(){this.tabClickHandle(0),this.mutiMallVal=[this.mallData[0].id],this.dayTime=dateUnit.dateFormat(new Date,"yyyy-MM-dd")}),i),mounted:function(){this.dayTime=this.dayTime?this.dayTime:dateUnit.dateFormat(new Date,"yyyy-MM-dd")}},d={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"analysis-option-wrapper"},[e("div",{staticClass:"analysis-level-wrapper"},[e("div",{staticClass:"analysis-level-left"},[e("i",{staticClass:"el-icon-search"}),t._v(" "),e("span",{staticClass:"analysis-level-text"},[t._v(t._s(t.$t("asisTab.level")))])]),t._v(" "),e("div",{staticClass:"analysis-level-right"},[e("ul",{staticClass:"analysis-type-box"},t._l(t.tabItem,function(a,i){return e("li",{key:a.value,class:a.className,on:{click:function(a){t.tabClickHandle(i)}}},[e("span",{staticClass:"analysis-item-title"},[t._v(t._s(t.i18nFormatter(a.label)))])])}))])]),t._v(" "),e("div",{staticClass:"panels-content"},[e("div",{staticClass:"panels-main-top"},[e("ul",{directives:[{name:"show",rawName:"v-show",value:t.panelObj.mallPanel,expression:"panelObj.mallPanel"}],staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.mallT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect"),multiple:"","collapse-tags":""},on:{"remove-tag":t.removeTag,change:t.mallChangeHandle},model:{value:t.mutiMallVal,callback:function(a){t.mutiMallVal=a},expression:"mutiMallVal"}},[e("div",{class:t.isMallSelAll?"sel-all-box selected":"sel-all-box",on:{click:function(a){t.selAllHandle("mall")}}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(t.$t("allPages.all")))])]),t._v(" "),t._l(t.mallData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(a.name))])])})],2)],1)])]),t._v(" "),e("ul",{directives:[{name:"show",rawName:"v-show",value:t.panelObj.floorPanel,expression:"panelObj.floorPanel"}],staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.mallT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect")},on:{change:t.mutiMallChange},model:{value:t.mallVal,callback:function(a){t.mallVal=a},expression:"mallVal"}},t._l(t.mallData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.floorT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"floor-sel-box format-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.floorSelect"),multiple:"","collapse-tags":""},on:{change:t.floorChangeHandle},model:{value:t.mutiFloorVal,callback:function(a){t.mutiFloorVal=a},expression:"mutiFloorVal"}},[e("div",{class:t.isFloorSelAll?"sel-all-box selected":"sel-all-box",on:{click:function(a){t.selAllHandle("floor")}}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(t.$t("allPages.all")))])]),t._v(" "),t._l(t.mutiFloorData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(a.name))])])})],2)],1)])]),t._v(" "),e("ul",{directives:[{name:"show",rawName:"v-show",value:t.panelObj.ioPanel,expression:"panelObj.ioPanel"}],staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.mallT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect")},on:{change:t.mallChange},model:{value:t.mallVal,callback:function(a){t.mallVal=a},expression:"mallVal"}},t._l(t.mallData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.inOutT")))]),t._v(" "),e("div",{staticClass:"condition-item-option",staticStyle:{"margin-left":"0.24rem"}},[e("el-select",{staticClass:"mall-sel-box",attrs:{placeholder:t.$t("pholder.gateType"),filterable:"",multiple:"","collapse-tags":""},on:{change:t.gateChangeHandle},model:{value:t.mutiGateVal,callback:function(a){t.mutiGateVal=a},expression:"mutiGateVal"}},[e("div",{class:t.isGateSelAll?"sel-all-box selected":"sel-all-box",on:{click:function(a){t.selAllHandle("gate")}}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(t.$t("allPages.all")))])]),t._v(" "),t._l(t.gateData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(a.name))])])})],2)],1)])]),t._v(" "),e("ul",{directives:[{name:"show",rawName:"v-show",value:t.panelObj.shopPanel,expression:"panelObj.shopPanel"}],staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.mallT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect")},on:{change:t.mallChange},model:{value:t.mallVal,callback:function(a){t.mallVal=a},expression:"mallVal"}},t._l(t.mallData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.floorT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"floor-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.floorSelect")},on:{change:t.floorChange},model:{value:t.shopFloorVal,callback:function(a){t.shopFloorVal=a},expression:"shopFloorVal"}},t._l(t.shopFloorData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.storeT")))]),t._v(" "),e("div",{staticClass:"condition-item-option  "},[e("el-select",{staticClass:"shop-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.areaSelect"),multiple:"","collapse-tags":""},on:{change:t.zoneChangeHandle},model:{value:t.mutiZoneVal,callback:function(a){t.mutiZoneVal=a},expression:"mutiZoneVal"}},[e("div",{class:t.isZoneSelAll?"sel-all-box selected":"sel-all-box",on:{click:function(a){t.selAllHandle("zone")}}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(t.$t("allPages.all")))])]),t._v(" "),t._l(t.zoneData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(a.name))])])})],2)],1)])])]),t._v(" "),e("div",{staticClass:"panels-main-bottom"},[e("ul",{staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.date")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-date-picker",{staticClass:"date-input analysis-date-input",attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",size:"mini",placeholder:t.$t("pholder.date"),"picker-options":t.pickerOptions1},model:{value:t.dayTime,callback:function(a){t.dayTime=a},expression:"dayTime"}})],1)]),t._v(" "),e("li",{staticClass:"condition-item"},[e("el-button",{staticClass:"primary-btn analysis-collapse-btn",attrs:{type:"primary",size:"samll"},on:{click:t.confirmCondition}},[t._v(t._s(t.$t("button.confirm")))]),t._v(" "),e("el-button",{staticClass:"reset-btn analysis-collapse-btn",attrs:{size:"samll"},on:{click:t.resetRefresh}},[t._v(t._s(t.$t("button.reset")))])],1)])])])])},staticRenderFns:[]},_=e("VU/8")(m,d,!1,function(t){e("GkWT"),e("fELm")},"data-v-37410692",null);a.a=_.exports},sGoF:function(module,__webpack_exports__,__webpack_require__){"use strict";(function($){var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__=__webpack_require__("mvHQ"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_1__public_exportData__=__webpack_require__("pJt5"),__WEBPACK_IMPORTED_MODULE_2__common_option_ioFlowOption__=__webpack_require__("pN1d"),__WEBPACK_IMPORTED_MODULE_3__common_publicChart__=__webpack_require__("jR44"),__WEBPACK_IMPORTED_MODULE_4__public_myColum__=__webpack_require__("ORyR"),lineToTable=__webpack_require__("BC53");__webpack_exports__.a={data:function(){return{_time:"",_tabId:"",moreOptVisible:!1,mallData:[],asisName:"",asisLevel:"",emitData:{},tableKeyToId:{},tableIds:"",trafficFlow_title:"trafficInAndOuttrafficInAndOut",radioDate:"TAB_HOUR",trafficFlowLoading:!0,trafficFlow_head:[],trafficFlow_ops:[],trafficFlow_lineOps:{},isTabChart:!0,localLineData:{},apiUrl:"",searchTime:"",val:"",trafficFlowing_title:"",line:"1",tableHeight:0}},components:{"ioflow-option":__WEBPACK_IMPORTED_MODULE_2__common_option_ioFlowOption__.a,"io-chart":__WEBPACK_IMPORTED_MODULE_3__common_publicChart__.a,"export-data-dialog":__WEBPACK_IMPORTED_MODULE_1__public_exportData__.a,"comp-column":__WEBPACK_IMPORTED_MODULE_4__public_myColum__.a},computed:{tableData:function(){var t={};if(this.trafficFlow_ops.length){for(var a in this.trafficFlow_ops[0])"defaultOrg0"==a?t[a]=this.$t("table.total"):t[a]?t[a]+=item[a]:t[a]=0;return this.trafficFlow_ops.map(function(a,e){for(var i in a)isNaN(Number(t[i]))||isNaN(Number(a[i]))||(t[i]+=Number(Math.round(100*a[i])/100))}),this.trafficFlow_ops.push(t),this.trafficFlow_ops}}},created:function(){var t=this,a=$(window).height(),e=.28;a<=720?e=.35:a<=768?e=.33:a<=900?e=.28:a<=1080&&(e=.31),this.tableHeight=a-a*e,window.addEventListener("resize",function(){try{var a={chart1:$("#tfChart")[0]};for(var e in a)if(a.hasOwnProperty(e)&&void 0!=a[e]){a[e]=t.$echarts.init(a[e]);a[e].resize()}}catch(t){}})},mounted:function(){this.getMallOpt(),this.showCollapse()},methods:{showCollapse:function(){var t=this,a="",e="",i="",l="";a=this.getStyleFn(".el-header","height"),e=this.getStyleFn(".analysis-wrapper .el-header","height"),this.moreOptVisible?(this.moreOptVisible=!1,l=a+e+8+"px",$(".ioflow-main").animate({marginTop:l})):(this.moreOptVisible=!0,setTimeout(function(){i=t.getStyleFn(".analysis-option-wrapper","height"),l=a+e+i+8+"px",$(".ioflow-main").animate({marginTop:l})},100))},getMallOpt:function(){var t=this;this.axios.get("/malls",{params:{accountId:this.$cookie.get("accountId"),status:1,_t:Date.parse(new Date)/1e3}}).then(function(a){var e="",i=null;if(a.data.data.length>=1){var l=window.sessionStorage.getItem("mallId");l&&Number(l),a.data.data.forEach(function(a,i){t.mallData.push(a),l&&a.id==l&&(e=a.name)}),t.asisName=e||a.data.data[0].name,i=l?Number(l):a.data.data[0].id,t.$refs.init.initAsis(i)}})},initTab:function(t){var a=this;this.emitData=t,this.trafficFlowLoading=!0,this.tableIds&&"{}"!==__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(this.tableKeyToId)?this.getChartData(this.tableIds):(this.tableKeyToId={},this.tableIds="",this.axios.get("/reportCharts",{params:{report:"trafficInAndOut",_t:Date.parse(new Date)/1e3}}).then(function(t){var e=t.data.data;e.forEach(function(t,i){a.tableKeyToId[t.key]=t.id,"trafficInAndOut"!==t.key&&"trafficInAndOutTable"!==t.key||(i==e.length-1?a.tableIds+=t.id:a.tableIds+=t.id+",")}),a.getChartData(a.tableIds),a.selReport("table")}))},getChartData:function(t){var a=this;if(t){this.trafficFlow_head=[],this.trafficFlow_ops=[],this.localLineData={},this.isTabChart=!0;var e={};this.emitData.asis_time?this.searchTime=this.emitData.asis_time:this.searchTime=dateUnit.dateFormat(new Date,"yyyy-MM-dd"),this._time=this.searchTime,this.apiUrl="/report/trafficInAndOut/"+this.emitData.asis_level,e={orgIds:this.emitData.asis_org,date:this.searchTime,chartIds:t,option:this.radioDate,_t:Date.parse(new Date)/1e3},this.axios.get(this.apiUrl,{params:e}).then(function(t){var e=t.data.data.body;if(a.trafficFlowing_title="trafficInAndOuttrafficInAndOut","{}"!==__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(e)){var i=e.trafficInAndOut;a.localLineData=JSON.parse(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(i));var l=e.trafficInAndOutTable.xaxis.data;a.trafficFlow_head=a.dealThead(l),a.trafficFlow_head.push({children:[{label:a.$t("format.INNUM"),prop:"inSum"},{label:a.$t("format.OUTNUM"),prop:"outSum"}],label:a.$t("table.total")});var s={};e.trafficInAndOutTable.series.forEach(function(t){var e=null,i=null,l=t.data.length-1;t.data.forEach(function(t,a){a%2==0&&0!=a?isNaN(Number(t))||null==t?i||a!=l||(i="--"):i+=t:0!=a&&(isNaN(Number(t))||null==t?e||a!=l-1||(e="--"):e+=t),s["defaultOrg"+a]=null!=t?t:"--"}),s.inSum=e,s.outSum=i,a.trafficFlow_ops.push(s),s={}}),a.trafficFlow_lineOps=JSON.parse(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(i))}setTimeout(function(){a.trafficFlowLoading=!1},500)}).catch(function(t){console.log("ioFlow err:",t.message,t)})}},dealThead:function dealThead(theadData){var cols=[],$index=0;return cols=theadData.map(function(item,index){if(/^\[.+\]$/.test(item)){var formatItem=eval(item);return{label:formatItem[0],children:formatItem.map(function(t,a){return a>0&&{prop:"defaultOrg"+$index++,label:t}}).filter(Boolean)}}return{prop:"defaultOrg"+$index++,label:item,fixed:!0,width:120}})},changeTabSelect:function(t){var a=this;if(this.trafficFlow_head=[],this.trafficFlow_ops=[],this.localLineData={},this.isTabChart=!0,this.tableIds){var e={};this.searchTime=this.emitData.asis_time?this.emitData.asis_time:dateUnit.dateFormat(new Date,"yyyy-MM-dd"),this.apiUrl="/report/trafficInAndOut/"+this.emitData.asis_level,e={orgIds:this.emitData.asis_org,date:this.searchTime,chartIds:this.tableIds,option:this.radioDate,_t:Date.parse(new Date)/1e3},this.axios.get(this.apiUrl,{params:e}).then(function(t){a.line="1";var e=t.data.data.body;if(a.trafficFlowing_title="trafficInAndOuttrafficInAndOut","{}"!==__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(e)){var i=e.trafficInAndOut;a.localLineData=JSON.parse(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(i));var l=e.trafficInAndOutTable.xaxis.data;a.trafficFlow_head=a.dealThead(l),a.trafficFlow_head.push({children:[{label:a.$t("format.INNUM"),prop:"inSum"},{label:a.$t("format.OUTNUM"),prop:"outSum"}],label:a.$t("table.total")});var s={};e.trafficInAndOutTable.series.forEach(function(t){var e=null,i=null,l=t.data.length-1;t.data.forEach(function(t,a){a%2==0&&0!=a?isNaN(Number(t))||null==t?i||a!=l||(i="--"):i+=t:0!=a&&(isNaN(Number(t))||null==t?e||a!=l-1||(e="--"):e+=t),s["defaultOrg"+a]=null!=t?t:"--"}),s.inSum=e,s.outSum=i,a.trafficFlow_ops.push(s),s={}}),a.trafficFlow_lineOps=JSON.parse(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(i))}setTimeout(function(){a.trafficFlowLoading=!1},500)})}},autoComplateHead:function(t,a){var e=[],i=[];if(a.length<8){e=a.map(function(t){return t});for(var l=0,s=8-a.length;l<s;l++)e.push("--");e.forEach(function(t,a){i.push({prop:"defaultOrg"+a,label:t})})}else a.forEach(function(t,a){i.push({prop:"defaultOrg"+a,label:t})});return i},dealData:function(t,a){var e={},i=[],l="";return t.forEach(function(t){if(t.data.length<a.length){for(var s=0,o=t.data.length;s<o;s++)l=a[s].prop,e[l]=t.data[s]||0==t.data[s]?t.data[s]:"--";for(var n=t.data.length;n<a.length;n++)l=a[n].prop,e[l]="--"}else for(var r=0,c=t.data.length;r<c;r++)l=a[r].prop,e[l]=t.data[r]||0==t.data[r]?t.data[r]:"--";i.push(e),e={}}),i},reportHandler:function(t){var a=this;this.trafficFlowLoading=!0,this.emitData=t,this.asisName=t.asis_tit,this.tableIds?this.getChartData(this.tableIds):(this.tableKeyToId={},this.tableIds="",this.axios.get("/reportCharts",{params:{report:"trafficInAndOut",_t:Date.parse(new Date)/1e3}}).then(function(t){var e=t.data.data;e.forEach(function(t,i){a.tableKeyToId[t.key]=t.id,"trafficInAndOut"===t.key&&"trafficInAndOutTable"===t.key&&(i==e.length-1?a.tableIds+=t.id:a.tableIds+=t.id+",")}),a.getChartData(a.tableIds)}))},selReport:function(t){var a=this;if("table"===t){if(this.isTabChart)return;this.line="0",this.isTabChart=!0,this.trafficFlow_title="",this.trafficFlowLoading=!0,this.trafficFlow_title="trafficInAndOuttrafficInAndOut",setTimeout(function(){a.trafficFlowLoading=!1},200)}else{if(!this.isTabChart)return;this.isTabChart=!1,this.line="1",this.trafficFlow_lineOps={},this.trafficFlow_lineOps=JSON.parse(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(this.localLineData)),this.trafficFlowing_title="trafficInAndOuttrafficInAndOut"}},exportDataHandle:function(t,a,e){var i=this.tableKeyToId[e],l={domId:t,title:a,data:{url:"/report/trafficInAndOut/"+this.emitData.asis_level+"/"+i+"/excel",params:"orgIds="+this.emitData.asis_org+"&date="+this.searchTime+"&option="+this.radioDate}};this.$refs.exportDialog.dialogInit(l)}}}}).call(__webpack_exports__,__webpack_require__("7t+N"))}});