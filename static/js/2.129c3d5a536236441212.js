webpackJsonp([2],{H9J4:function(a,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=i("oEYY"),o={render:function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("div",{staticClass:"yearly"},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],staticClass:"graph-container"},[i("img",{staticClass:"background-floorimg",attrs:{src:a.floorSrc,alt:""}}),a._v(" "),i("div",{staticClass:"graph-box",attrs:{id:"yGraphChart"}})])])},staticRenderFns:[]},r=function(a){i("b7/x")},n=i("VU/8")(e.a,o,!1,r,"data-v-94e94838",null);t.default=n.exports},"b7/x":function(a,t){},oEYY:function(a,t,i){"use strict";(function(a){var e=i("PAnj"),o=i.n(e);t.a={props:{propparam:Object},data:function(){return{floorPlanUrl:window.apiUrl+"/floors/img/",floorSrc:"",loading:!0,trafficFlowLoading:!0,kpiData_head:[],trafficHour_head:[{label:"时间段",prop:"periodTime"}],traffic10Min_head:[{label:"时间段",prop:"periodTime"}],trafficFlow_head:[],trafficFlow_title:"",kpiData_title:"",trafficHour_title:"",traffic10Min_title:"",kpiData_ops:[],trafficHour_ops:[],traffic10Min_ops:[],trafficFlow_ops:[],tableKeyToId:{},tableIds:"",emitData:[],radioDate:"小时级",rowLen:Number,naturalWidth:0,naturalHeight:0,firstFlag:!0,orgids:"",starttime:"",endtime:"",imgWidth:""}},computed:{},components:{},watch:{propparam:{handler:"refreshHandle",immediate:!0}},mounted:function(){},methods:{refreshHandle:function(t){if("/trafficeline/yearly"===t.dateType){this.loading=!0,this.emitData=t.data,t.data.asis_img?this.floorSrc=this.floorPlanUrl+t.data.asis_img:this.floorSrc=o.a,this.orgids=t.data.asis_org,this.starttime=t.data.asis_time[0],this.endtime=t.data.asis_time[1];var i=new Image;i.src=this.floorSrc;var e=this;i.onload=function(){e.naturalWidth=i.width,e.naturalHeight=i.height,a("#yGraphChart").height(a(".background-floorimg").height()),e.getLinkData()}}},getLinkData:function(){var t=this;this.axios.get("/report/movingLine/floor",{params:{orgIds:this.orgids,startDate:this.starttime,endDate:this.endtime,_t:Date.parse(new Date)/1e3}}).then(function(i){if(void 0===i.data.data.node||void 0===i.data.data.line)return t.loading=!1,void console.log("node link not exist!");var e=[],o=[],r=999999999,n=0,l=!1;i.data.data.node.forEach(function(a,t){a.innum||(l=!0),0!=a.innum&&a.innum<r&&(r=a.innum),0!=a.innum&&a.innum>n&&(n=a.innum)}),i.data.data.node.forEach(function(i,s){var d=n==r?10:parseInt(10+(i.innum-r)/(n-r)*90),c=(i.x/t.normalWidth*a(".background-floorimg").width()).toFixed(2),u=(i.y/t.normalHeight*a(".background-floorimg").height()).toFixed(2),h={id:String(i.zondId),name:i.zoneName,value:i.innum,x:c>a(".background-floorimg").width()?0:c,y:u>a(".background-floorimg").height()?0:u,symbolSize:l?0:d,category:s};e.push(h),o.push({name:i.zoneName})}),e.push({id:-1,name:"22",value:-1,x:0,y:0,symbolSize:0,label:{show:!1}},{id:-2,name:"11",value:-1,x:a(".background-floorimg").width(),y:a(".background-floorimg").height(),symbolSize:0,label:{show:!1}});var s=[],d=999999999999,c=0,u=null;i.data.data.line.forEach(function(a){s.push({target:String(a.target),source:String(a.source),value:a.value}),0!=a.value&&a.value<d&&(d=a.value),0!=a.value&&a.value>c&&(c=a.value)}),s.forEach(function(a,t){u=(u=1+(a.value-d)/(c-d)*14)<0?0:u,a.lineStyle={normal:{width:l?0:u}},a.symbolSize=l?0:2*u});var h={},m=document.getElementById("yGraphChart");m.style.width=a(".background-floorimg").width()+"px",t.$echarts.getInstanceByDom(m)?(t.$echarts.init(m).dispose(),h=t.$echarts.init(m)):h=t.$echarts.init(m);var f={tooltip:{},legend:{type:"plain",icon:"circle",top:0,data:o.map(function(a){return a.name})},series:[{top:0,left:0,right:0,bottom:1,edgeSymbol:["none","arrow"],categories:o,type:"graph",layout:"none",data:e,links:s,edgeSymbolSize:0,label:{normal:{show:!l,position:"right",formatter:"{b}:{c}"}},lineStyle:{normal:{color:"source",curveness:.3}}}]};t.firstFlag||h.clear(),t.firstFlag=!1,h.clear(),h.setOption(f),setTimeout(function(){t.loading=!1},1e3)})}}}}).call(t,i("7t+N"))}});