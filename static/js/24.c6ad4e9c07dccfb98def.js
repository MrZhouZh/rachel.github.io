webpackJsonp([24],{"1Vdj":function(t,a){},KxAo:function(t,a){},"eq+Q":function(t,a,e){"use strict";var i=e("mvHQ"),s=e.n(i),l=e("GXH0"),o=e.n(l),n=function(t){setTimeout(t,2e3)},r={props:{mallData:Array},data:function(){return{checkedMall:[],pickerOptions1:{disabledDate:function(t){return t.getTime()>Date.now()}},weekPickerOpt:{firstDayOfWeek:1},tabItem:[],panelObj:{mallPanel:!1,floorPanel:!1,formatPanel:!1,ioPanel:!1,shopPanel:!1},analyasisTime:[{label:"day",value:"day",is_active:"time-btn"},{label:"week",value:"week",is_active:"time-btn"},{label:"month",value:"month",is_active:"time-btn"},{label:"year",value:"year",is_active:"time-btn"},{label:"custom",value:"custom",is_active:"time-btn"}],reportTime:{isDay:!1,isWeek:!1,isMonth:!1,isYear:!1,isCustom:!1},ReportVal:"day",dayTime:"",weekTime:"",monthTime:"",yearTime:"",customTime:"",mallVal:"",floorVal:"",floorItem:"",zoneItem:"",formatVal:"",ioVal:"",gateVal:"",zoneVal:"",asisLevel:"",kpiVal:"TRAFFIC",kpiOpt:[],floorData:[],floorList:[],zoneData:[],zoneList:[],formatData:[],ioData:[],gateData:[],paramId:"",shopType:"floor",shopTypeVal:"",shopTypeData:[],shopFloorData:[],shopFloorId:"",shopFloorVal:"",mutiMallVal:[],mutiFloorVal:[],mutiFloorData:[],mutiFormatVal:[],mutiGateVal:[],mutiZoneVal:[],mutiMallId:[],mutiFloorId:[],mutiGateId:[],mutiZoneId:[],formatOptions:[{id:"success",label:"with children",children:null},{id:"no-children",label:"width no children",children:null},{id:"failure",label:"Demonstrates error handling",children:null}],mallId:"",floorId:"",ioId:"",zoneId:"",formatId:"",gateLevel:"all",gateLevelList:[{label:"all",value:"all"},{label:"mall",value:"mall"},{label:"floor",value:"floor"},{label:"store",value:"zone"}],isMallSelAll:!0,isFloorSelAll:!0,isGateSelAll:!0,isZoneSelAll:!0}},components:{treeselect:o.a},watch:{},created:function(){if(this.tabItem=[],"mall"===this.$Project){var t={mall:"mall",inOut:"io",floor:"floor",store:"shop"};for(var a in t)this.tabItem.push({label:a,value:t[a],className:"analysis-item"})}else this.tabItem=[{label:"mall",value:"mall",className:"analysis-item"},{label:"inOut",value:"io",className:"analysis-item"}];this.tabClickHandle(0)},methods:{i18nFormatter:function(t){var a="asisTab."+t;return this.$t(a)},initAsis:function(t){var a=this;this.paramId=t,this.mallId=t,this.mallVal=t,this.mallData.forEach(function(t){a.mutiMallId.push(t.id),a.mutiMallVal.push(t.id)}),this.isMallSelAll=this.mutiMallVal.length==this.mallData.length,this.getFloorOpt(t),this.gateLevelChange(),this.tabClickHandle(0),this.DateHandle("day"),this.shopType="floor",this.shopTypeChange();var e={asis_level:this.asisLevel,asis_date:"day",asis_time:this.dayTime,asis_org:this.mutiMallVal.join(","),asis_org_name:[]};e.asis_org_name=[],this.$emit("initData",e)},tabClickHandle:function(t){if("analysis-item"===this.tabItem[t].className){this.tabItem.forEach(function(t){t.className="analysis-item"}),this.tabItem[t].className="analysis-item tabs-active";for(var a in this.panelObj)this.panelObj[a]=!1;switch(this.kpiVal="",this.asisLevel="",this.tabItem[t].value){case"mall":this.mutiMallVal=JSON.parse(s()(this.mutiMallId)),this.panelObj.mallPanel=!0,this.asisLevel="mall",this.kpiOpt=[{label:"客流量",value:"TRAFFIC"},{label:"销售额",value:"SALES"},{label:"游逛深度",value:"DEPTH"},{label:"客单价",value:"PREPRICE"},{label:"坪效",value:"PERAREAVALUE"},{label:"滞留时间",value:"DURATIONTIME"}],this.kpiVal="TRAFFIC";break;case"floor":this.mutiFloorVal=this.mutiFloorId,this.panelObj.floorPanel=!0,this.asisLevel="floor",this.kpiOpt=[{label:"客流量",value:"TRAFFIC"},{label:"销售额",value:"SALES"}],this.kpiVal="TRAFFIC";break;case"format":this.mallVal=this.mallId,this.floorVal=this.floorId,this.formatVal=this.formatId?[this.formatId]:"",this.panelObj.formatPanel=!0,this.asisLevel="format",this.kpiOpt=[{label:"客流量",value:"TRAFFIC"},{label:"销售额",value:"SALES"}],this.kpiVal="TRAFFIC";break;case"io":this.mallVal=this.mallId,this.floorVal=this.floorId,this.formatVal=this.formatId,this.mutiGateVal=this.mutiGateId,this.panelObj.ioPanel=!0,this.asisLevel="gate",this.kpiOpt=[{label:"客流量",value:"TRAFFIC"}],this.kpiVal="TRAFFIC";break;case"shop":this.mallVal=this.mallId,this.floorVal=this.floorId,this.formatVal=this.formatId,this.ioVal=this.ioId?this.ioId:"",this.mutiZoneVal=this.mutiZoneId,this.panelObj.shopPanel=!0,this.asisLevel="zone",this.kpiOpt=[{label:"客流量",value:"TRAFFIC"},{label:"销售额",value:"SALES"},{label:"进店率",value:"ENTERINGRATE"},{label:"客单价",value:"PREPRICE"},{label:"坪效",value:"PERAREAVALUE"},{label:"成交量",value:"ORDER"},{label:"提袋率",value:"HANDBAGRATE"},{label:"滞留时间",value:"DURATIONTIME"}],this.kpiVal="TRAFFIC";break;default:this.kpiOpt=[],this.kpiVal=""}}},getFloorOpt:function(t){var a=this;this.mutiFloorData=[],this.mutiFloorVal=[],this.floorData=[],this.shopFloorData=[],this.floorVal="",this.floorId="",this.shopFloorId="",this.shopFloorVal="",this.mutiFloorId=[],this.axios.get("/floors",{params:{mallId:t,accountId:this.$cookie.get("accountId"),status:1,_t:Date.parse(new Date)/1e3}}).then(function(e){if(e.data.data.length>0){var i=JSON.parse(s()(e.data.data));i.unshift({name:a.$t("asisTab.all"),id:""}),a.mutiFloorData=e.data.data,a.mutiFloorId=[e.data.data[0].id],a.mutiFloorVal=[e.data.data[0].id],a.floorData=e.data.data,a.shopFloorData=i,a.shopFloorId=i[0].id,a.shopFloorVal=i[0].id,a.floorId=(a.panelObj.floorPanel,e.data.data[0].id),a.floorVal=a.panelObj.floorPanel?[e.data.data[0].id]:e.data.data[0].id,a.getIoOpt(t,a.floorVal),a.getZoneOpt(t,a.shopFloorVal)}else a.getZoneOpt(t)}).catch(function(t){console.log(t.message,t)})},getZoneOpt:function(t,a){var e=this;this.zoneData=[],this.mutiZoneVal=[],this.mutiZoneId=[],this.zoneId="",this.axios.get("/zones",{params:{mallId:t,floorId:a,accountId:this.$cookie.get("accountId"),status:1,sortName:'"floor".name, "zone".name',_t:Date.parse(new Date)/1e3}}).then(function(t){var a=t.data;e.mutiZoneId=[],a.data.length>0&&(e.zoneData=a.data,e.zoneId=a.data[0].id,e.mutiZoneId=[a.data[0].id],a.data.forEach(function(t){e.mutiZoneId.push(t.id),e.mutiZoneVal.push(t.id)}))}).catch(function(t){console.log(t.message,t)})},getIoOpt:function(t,a){var e=this;this.ioData=[],this.ioId="",this.ioVal="",this.axios.get("/gates",{params:{mallId:t,floorId:a,accountId:this.$cookie.get("accountId"),_t:Date.parse(new Date)/1e3}}).then(function(t){t.data.data.length>0&&(e.ioData=t.data.data,e.ioId=t.data.data[0].id,e.ioVal=e.panelObj.ioPanel?[t.data.data[0].id]:t.data.data[0].id)}).catch(function(t){})},loadOptions:function(t){var a=t.action,e=t.parentNode,i=t.callback;if(a===l.LOAD_CHILDREN_OPTIONS)switch(this.axios.get("/formats",{params:{_t:Date.parse(new Date)/1e3}}),e.id){case"success":n(function(){e.children=[{id:"child",label:"Child option"}],i()});break;case"no-children":n(function(){e.children=[],i()});break;case"failure":n(function(){i(new Error("Failed to load option: network error."))})}},getFormatOpt:function(t){var a=this;this.formatData=[],this.formatId="",this.axios.get("/formats",{params:{pid:-1,mallId:t,accountId:this.$cookie.get("accountId"),_t:Date.parse(new Date)/1e3}}).then(function(t){var e=t.data;e.data.length>0&&(a.formatData=e.data,a.formatId=e.data[0].id)}).catch(function(t){})},selDataFormat:function(t){},buildChild:function(t,a){t.forEach(function(t){t.id,a.id})},DateHandle:function(t){for(var a in this.reportTime)this.reportTime[a]=!1;switch(t){case"day":this.reportTime.isDay=!0;break;case"week":this.reportTime.isWeek=!0;break;case"month":this.reportTime.isMonth=!0;break;case"year":this.reportTime.isYear=!0;break;case"custom":this.reportTime.isCustom=!0}},timeHandle:function(t){if("time-btn"===this.analyasisTime[t].is_active){this.analyasisTime.forEach(function(t){t.is_active="time-btn"});for(var a in this.reportTime)this.reportTime[a]=!1;this.analyasisTime[t].is_active="time-btn active-time";switch(this.analyasisTime[t].value){case"day":this.reportTime.isDay=!0;break;case"week":this.reportTime.isWeek=!0;break;case"month":this.reportTime.isMonth=!0;break;case"year":this.reportTime.isYear=!0;break;case"custom":this.reportTime.isCustom=!0}}},gateLevelChange:function(){"all"===this.gateLevel?this.getAllGates():"mall"===this.gateLevel?this.getMallGates():"floor"===this.gateLevel?this.getFloorList():this.getZoneList()},getAllGates:function(){var t=this;this.mutiGateVal=[],this.mutiGateId=[],this.gateData=[],this.axios.get("/gates",{params:{accountId:this.$cookie.get("accountId"),type_arr:"1,3",mallId:this.mallVal,_t:Date.parse(new Date)/1e3}}).then(function(a){var e=a.data;e.data.length>0&&(e.data.forEach(function(t){window.sessionStorage.setItem("gate-"+t.id,t.name)}),e.data.forEach(function(a){t.mutiGateId.push(a.id),t.mutiGateVal.push(a.id)}),t.gateData=e.data)})},getMallGates:function(){var t=this;this.mutiGateVal=[],this.gateData=[],this.mutiGateId=[],this.axios.get("/gates",{params:{mallId:this.mallVal,isMallGate:1,_t:Date.parse(new Date)/1e3}}).then(function(a){var e=a.data;e.data.length>0&&(t.mutiGateId=[e.data[0].id],t.mutiGateVal=[e.data[0].id],t.gateData=e.data)})},getFloorList:function(){var t=this;this.mutiGateVal=[],this.gateData=[],this.axios.get("/floors",{params:{mallId:this.mallVal,_t:Date.parse(new Date)/1e3}}).then(function(a){if(t.floorList=[],a.data.data.length>0){var e=a.data.data;t.floorItem=[e[0].id],t.getFloorGate(t.floorItem.join(",")),t.floorList=e}})},getZoneList:function(){var t=this;this.mutiGateVal=[],this.gateData=[],this.axios.get("/zones",{params:{mallId:this.mallVal,sortName:'"floor".name, "zone".name',_t:Date.parse(new Date)/1e3}}).then(function(a){if(t.zoneList=[],a.data.data.length>0){var e=a.data.data;t.zoneItem=[e[0].id],t.getZoneGate(t.zoneItem.join(",")),t.zoneList=e}})},levelFloorChange:function(){this.floorItem.length?this.getFloorGate(this.floorItem.join(",")):(this.mutiGateVal=[],this.gateData=[])},getFloorGate:function(t){var a=this;this.mutiGateVal=[],this.gateData=[],this.mutiGateId=[],this.axios.get("/floorGates",{params:{FloorId_arr:t,_t:Date.parse(new Date)/1e3}}).then(function(t){var e=t.data;e.data.length>0&&(e.data.forEach(function(t){t.id=t.gateId,t.name=window.sessionStorage.getItem("gate-"+t.gateId)}),a.mutiGateId=[e.data[0].id],a.mutiGateVal=[e.data[0].id],a.gateData=e.data)})},levelZoneChange:function(){this.zoneItem.length?this.getZoneGate(this.zoneItem.join(",")):(this.mutiGateVal=[],this.gateData=[])},getZoneGate:function(t){var a=this;this.mutiGateVal=[],this.gateData=[],this.mutiGateId=[],this.axios.get("/zoneGates",{params:{ZoneId_arr:t,_t:Date.parse(new Date)/1e3}}).then(function(t){var e=t.data;e.data.length>0&&(e.data.forEach(function(t){t.id=t.gateId,t.name=window.sessionStorage.getItem("gate-"+t.gateId)}),a.mutiGateId=[e.data[0].id],a.mutiGateVal=[e.data[0].id],a.gateData=e.data)})},mallChange:function(){this.mallId=this.mallVal,this.mutiMallVal=[this.mallVal],this.panelObj.ioPanel?this.gateLevel="all":(this.getFloorOpt(this.mallVal),this.getFormatOpt(this.mallVal))},mallChangeHandle:function(){this.isMallSelAll=(this.isMallSelAll,!(this.mutiMallVal.length<this.mallData.length))},floorChangeHandle:function(){this.isFloorSelAll=(this.isFloorSelAll,!(this.mutiFloorVal.length<this.mutiFloorData.length))},gateChangeHandle:function(){this.isGateSelAll=(this.isGateSelAll,!(this.mutiGateVal.length<this.gateData.length))},zoneChangeHandle:function(){this.isZoneSelAll=(this.isZoneSelAll,!(this.mutiZoneVal.length<this.zoneData.length))},selAllHandle:function(t){var a=this;"mall"===t?this.isMallSelAll?(this.isMallSelAll=!1,this.mutiMallVal.length==this.mallData.length&&(this.mutiMallVal=[])):(this.isMallSelAll=!0,this.mutiMallVal.length==this.mallData.length?this.mutiMallVal=[]:(this.mutiMallVal=[],this.mallData.forEach(function(t){a.mutiMallVal.push(t.id)}))):"floor"===t?this.isFloorSelAll?(this.isFloorSelAll=!1,this.mutiFloorVal.length==this.mutiFloorData.length&&(this.mutiFloorVal=[])):(this.isFloorSelAll=!0,this.mutiFloorVal.length==this.mutiFloorData.length?this.mutiFloorVal=[]:(this.mutiFloorVal=[],this.mutiFloorData.forEach(function(t){a.mutiFloorVal.push(t.id)}))):"gate"===t?this.isGateSelAll?(this.isGateSelAll=!1,this.mutiGateVal.length==this.gateData.length&&(this.mutiGateVal=[])):(this.isGateSelAll=!0,this.mutiGateVal.length==this.gateData.length?this.mutiGateVal=[]:(this.mutiGateVal=[],this.gateData.forEach(function(t){a.mutiGateVal.push(t.id)}))):this.isZoneSelAll?(this.isZoneSelAll=!1,this.mutiZoneVal.length==this.zoneData.length&&(this.mutiZoneVal=[])):(this.isZoneSelAll=!0,this.mutiZoneVal.length==this.zoneData.length?this.mutiZoneVal=[]:(this.mutiZoneVal=[],this.zoneData.forEach(function(t){a.mutiZoneVal.push(t.id)})))},mutiFloorMallChange:function(){var t=this;this.mutiFloorData=[],this.mutiFloorVal=[],this.mutiFloorId=[],this.axios.get("/floors",{params:{mallId:this.mallVal,accountId:this.$cookie.get("accountId"),_t:Date.parse(new Date)/1e3}}).then(function(a){var e=a.data;e.data.length>0&&(t.mutiFloorData=e.data,e.data.forEach(function(a){t.mutiFloorId.push(a.id),t.mutiFloorVal.push(a.id)}),t.mutiFloorId=[e.data[0].id])}).catch(function(t){console.log(t.message,t)})},gateMallChange:function(){this.gateLevel="all",this.gateLevelChange()},floorMallChange:function(){this.shopType="floor",this.shopTypeChange()},shopTypeChange:function(){switch(this.shopType){case"floor":this.getShopFloors();break;case"format":this.getShopFormats()}},floorChange:function(){this.getZoneOpt(this.mallVal,this.shopTypeVal)},getShopFloors:function(){var t=this;this.shopTypeVal="",this.shopTypeData=[],this.axios.get("/floors",{params:{mallId:this.mallVal,_t:Date.parse(new Date)/1e3}}).then(function(a){if(a.data.data.length>0){var e=a.data.data;e.unshift({name:t.$t("pholder.allFloor"),id:""}),t.shopTypeVal=e[0].id,t.shopTypeData=e,t.getZoneOpt(t.mallVal,t.shopTypeVal)}else t.getZoneOpt(t.mallVal)})},getShopZone:function(t){var a=this;this.zoneItem=[],this.zoneList=[],this.axios.get("/zones",{params:{mallId:this.mallVal,sortName:'"floor".name, "zone".name',_t:Date.parse(new Date)/1e3}}).then(function(t){if(t.data.data.length>0){var e=t.data.data;a.zoneItem=[e[0].id],a.getZoneGate(a.zoneItem.join(",")),a.zoneList=e}})},getShopFormats:function(){},confirmCondition:function(){var t={asis_level:"",asis_date:"",asis_time:"",asis_org:"",asis_org_name:""};switch(this.asisLevel){case"mall":t.asis_org_name=[],this.paramId=this.mutiMallVal.toString(),t.asis_tit=this.getItemName(this.mallData,this.paramId);break;case"floor":t.asis_org_name=[],this.paramId=this.mutiFloorVal.toString(),t.asis_tit=this.getItemName(this.mallData,this.mallVal.toString())+"-"+this.getItemName(this.mutiFloorData,this.paramId);break;case"format":t.asis_format=this.formatVal,t.asis_org_name=[],this.paramId=this.mallVal.toString();break;case"gate":if(!this.mutiGateVal.length)return;t.asis_org_name=[],this.paramId=this.mutiGateVal.toString(),t.asis_tit=this.getItemName(this.mallData,this.mallVal.toString())+"-"+this.getItemName(this.gateData,this.paramId);break;case"zone":t.asis_org_name=[],this.paramId=this.mutiZoneVal.toString(),t.asis_tit=this.getItemName(this.mallData,this.mallVal.toString())+"-"+this.getItemName(this.zoneData,this.paramId)}this.reportTime.isDay?(t.asis_level=this.asisLevel,t.asis_date="day",t.asis_time=this.dayTime,t.asis_org=this.paramId,this.$emit("reportTime",t)):this.reportTime.isWeek?(t.asis_level=this.asisLevel,t.asis_date="week",t.asis_time=this.weekTime,t.asis_org=this.paramId,this.$emit("reportTime",t)):this.reportTime.isMonth?(t.asis_level=this.asisLevel,t.asis_date="month",t.asis_time=this.monthTime,t.asis_org=this.paramId,this.$emit("reportTime",t)):this.reportTime.isYear?(t.asis_level=this.asisLevel,t.asis_date="year",t.asis_time=this.yearTime,t.asis_org=this.paramId,this.$emit("reportTime",t)):(t.asis_level=this.asisLevel,t.asis_date="custom",t.asis_time=this.customTime,t.asis_org=this.paramId,this.$emit("reportTime",t))},filterName:function(t,a){var e=[];return t.forEach(function(t){a.filter(function(a){a==t.id&&e.push(t.name)})}),e},getItemName:function(t,a){var e="",i=a.split(",")[0];return t.forEach(function(t){t.id==i&&(e=t.name)}),e},resetRefresh:function(){this.tabClickHandle(0),this.ReportVal="day",this.DateHandle(this.ReportVal)}},mounted:function(){this.dayTime=this.dayTime?this.dayTime:dateUnit.dateFormat(new Date,"yyyy-MM-dd"),this.customTime=[this.dayReduce(new Date,30),dateUnit.dateFormat(new Date,"yyyy-MM-dd")],this.weekTime=this.weekTime?this.weekTime:new Date,this.monthTime=this.monthTime?this.monthTime:new Date,this.yearTime=this.yearTime?this.yearTime:new Date}},h={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"analysis-option-wrapper"},[e("div",{staticClass:"analysis-level-wrapper"},[e("div",{staticClass:"analysis-level-left"},[e("i",{staticClass:"el-icon-search"}),t._v(" "),e("span",{staticClass:"analysis-level-text"},[t._v(t._s(t.$t("asisTab.level")))])]),t._v(" "),e("div",{staticClass:"analysis-level-right"},[e("ul",{staticClass:"analysis-type-box"},t._l(t.tabItem,function(a,i){return e("li",{key:a.value,class:a.className,on:{click:function(a){t.tabClickHandle(i)}}},[e("span",{staticClass:"analysis-item-title"},[t._v(t._s(t.i18nFormatter(a.label)))])])}))])]),t._v(" "),e("div",{staticClass:"panels-content"},[e("div",{staticClass:"panels-main-top"},[e("ul",{directives:[{name:"show",rawName:"v-show",value:t.panelObj.mallPanel,expression:"panelObj.mallPanel"}],staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.mallT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect"),multiple:"","collapse-tags":""},on:{change:t.mallChangeHandle},model:{value:t.mutiMallVal,callback:function(a){t.mutiMallVal=a},expression:"mutiMallVal"}},[e("div",{class:t.isMallSelAll?"sel-all-box selected":"sel-all-box",on:{click:function(a){t.selAllHandle("mall")}}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(t.$t("allPages.all")))])]),t._v(" "),t._l(t.mallData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(a.name))])])})],2)],1)])]),t._v(" "),e("ul",{directives:[{name:"show",rawName:"v-show",value:t.panelObj.floorPanel,expression:"panelObj.floorPanel"}],staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.mallT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box single-mall-sel",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect")},on:{change:t.mutiFloorMallChange},model:{value:t.mallVal,callback:function(a){t.mallVal=a},expression:"mallVal"}},t._l(t.mallData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.floorT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"floor-sel-box format-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.floorSelect"),multiple:"","collapse-tags":""},on:{change:t.floorChangeHandle},model:{value:t.mutiFloorVal,callback:function(a){t.mutiFloorVal=a},expression:"mutiFloorVal"}},[e("div",{class:t.isFloorSelAll?"sel-all-box selected":"sel-all-box",on:{click:function(a){t.selAllHandle("floor")}}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(t.$t("allPages.all")))])]),t._v(" "),t._l(t.mutiFloorData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(a.name))])])})],2)],1)])]),t._v(" "),e("ul",{directives:[{name:"show",rawName:"v-show",value:t.panelObj.formatPanel,expression:"panelObj.formatPanel"}],staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.mallT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box single-mall-sel",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect")},on:{change:t.mallChange},model:{value:t.mallVal,callback:function(a){t.mallVal=a},expression:"mallVal"}},t._l(t.mallData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.floorT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"floor-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.floorSelect")},model:{value:t.floorVal,callback:function(a){t.floorVal=a},expression:"floorVal"}},t._l(t.floorData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),e("li",{staticClass:"condition-item format-condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v("业态 :")]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("div",{staticClass:"format-sel-box"},[e("treeselect",{attrs:{multiple:!0,options:t.formatOptions,"load-options":t.loadOptions,placeholder:"选择业态"},model:{value:t.mutiFormatVal,callback:function(a){t.mutiFormatVal=a},expression:"mutiFormatVal"}})],1)])])]),t._v(" "),e("ul",{directives:[{name:"show",rawName:"v-show",value:t.panelObj.ioPanel,expression:"panelObj.ioPanel"}],staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.mallT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box single-mall-sel",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect")},on:{change:t.gateMallChange},model:{value:t.mallVal,callback:function(a){t.mallVal=a},expression:"mallVal"}},t._l(t.mallData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.inOutT")))]),t._v(" "),e("div",{staticClass:"condition-item-option",staticStyle:{"margin-left":"0.24rem"}},[e("el-select",{staticClass:"mall-sel-box",attrs:{placeholder:t.$t("pholder.gateType"),filterable:"",multiple:"","collapse-tags":""},on:{change:t.gateChangeHandle},model:{value:t.mutiGateVal,callback:function(a){t.mutiGateVal=a},expression:"mutiGateVal"}},[e("div",{class:t.isGateSelAll?"sel-all-box selected":"sel-all-box",on:{click:function(a){t.selAllHandle("gate")}}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(t.$t("allPages.all")))])]),t._v(" "),t._l(t.gateData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(a.name))])])})],2)],1)])]),t._v(" "),e("ul",{directives:[{name:"show",rawName:"v-show",value:t.panelObj.shopPanel,expression:"panelObj.shopPanel"}],staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.mallT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box single-mall-sel",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect")},on:{change:t.floorMallChange},model:{value:t.mallVal,callback:function(a){t.mallVal=a},expression:"mallVal"}},t._l(t.mallData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.class")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"floor-sel-box",attrs:{placeholder:"选择类别"},on:{change:t.shopTypeChange},model:{value:t.shopType,callback:function(a){t.shopType=a},expression:"shopType"}},[e("el-option",{attrs:{label:"楼层",value:"floor"}})],1),t._v(" "),e("span",[t._v("-")]),t._v(" "),e("el-select",{staticClass:"floor-sel-box",attrs:{filterable:"",placeholder:""},on:{change:t.floorChange},model:{value:t.shopTypeVal,callback:function(a){t.shopTypeVal=a},expression:"shopTypeVal"}},t._l(t.shopTypeData,function(t,a){return e("el-option",{key:a,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.store")))]),t._v(" "),e("div",{staticClass:"condition-item-option  "},[e("el-select",{staticClass:"shop-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.areaSelect"),multiple:"","collapse-tags":""},on:{change:t.zoneChangeHandle},model:{value:t.mutiZoneVal,callback:function(a){t.mutiZoneVal=a},expression:"mutiZoneVal"}},[e("div",{class:t.isZoneSelAll?"sel-all-box selected":"sel-all-box",on:{click:function(a){t.selAllHandle("zone")}}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(t.$t("allPages.all")))])]),t._v(" "),t._l(t.zoneData,function(a){return e("el-option",{key:a.id,attrs:{label:a.name,value:a.id}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(a.name))])])})],2)],1)])])]),t._v(" "),e("div",{staticClass:"panels-main-bottom rank-panels-main-bottom"},[e("ul",{staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text spe-item-text"},[t._v(t._s(t.$t("asisTab.date")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("div",{staticClass:"time-wrapper"},[e("el-select",{attrs:{placeholder:t.$t("pholder.select")},on:{change:function(a){t.DateHandle(t.ReportVal)}},model:{value:t.ReportVal,callback:function(a){t.ReportVal=a},expression:"ReportVal"}},t._l(t.analyasisTime,function(a){return e("el-option",{key:a.value,attrs:{label:t.i18nFormatter(a.label),value:a.value}})}))],1)])]),t._v(" "),e("li",{staticClass:"condition-item analysis-date-condition"},[e("div",{staticClass:"condition-item-option"},[e("el-date-picker",{directives:[{name:"show",rawName:"v-show",value:t.reportTime.isDay,expression:"reportTime.isDay"}],staticClass:"date-input analysis-date-input",attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",size:"mini",placeholder:t.$t("pholder.date"),"picker-options":t.pickerOptions1},model:{value:t.dayTime,callback:function(a){t.dayTime=a},expression:"dayTime"}}),t._v(" "),e("el-date-picker",{directives:[{name:"show",rawName:"v-show",value:t.reportTime.isWeek,expression:"reportTime.isWeek"}],staticClass:"date-input analysis-date-input",attrs:{align:"right",type:"week",format:"yyyy 第 WW 周",size:"mini",placeholder:t.$t("pholder.week"),"picker-options":t.weekPickerOpt},model:{value:t.weekTime,callback:function(a){t.weekTime=a},expression:"weekTime"}}),t._v(" "),e("el-date-picker",{directives:[{name:"show",rawName:"v-show",value:t.reportTime.isMonth,expression:"reportTime.isMonth"}],staticClass:"date-input analysis-date-input date-month-box",attrs:{align:"right",type:"month",format:"yyyy 年 MM 月",size:"mini",placeholder:t.$t("pholder.month"),"picker-options":t.pickerOptions1},model:{value:t.monthTime,callback:function(a){t.monthTime=a},expression:"monthTime"}}),t._v(" "),e("el-date-picker",{directives:[{name:"show",rawName:"v-show",value:t.reportTime.isYear,expression:"reportTime.isYear"}],staticClass:"date-input analysis-date-input",attrs:{align:"right",type:"year",format:"yyyy 年",size:"mini",placeholder:t.$t("pholder.year"),"picker-options":t.pickerOptions1},model:{value:t.yearTime,callback:function(a){t.yearTime=a},expression:"yearTime"}}),t._v(" "),e("el-date-picker",{directives:[{name:"show",rawName:"v-show",value:t.reportTime.isCustom,expression:"reportTime.isCustom"}],staticClass:"date-input analysis-date-input times-box",attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"daterange",size:"mini","picker-options":t.pickerOptions1,"range-separator":"-","start-placeholder":t.$t("table.startTime"),"end-placeholder":t.$t("table.endTime")},model:{value:t.customTime,callback:function(a){t.customTime=a},expression:"customTime"}})],1)]),t._v(" "),t._e(),t._v(" "),e("li",{staticClass:"condition-item"},[e("el-button",{staticClass:"primary-btn analysis-collapse-btn",attrs:{type:"primary",size:"samll"},on:{click:t.confirmCondition}},[t._v(t._s(t.$t("button.confirm")))]),t._v(" "),e("el-button",{staticClass:"reset-btn analysis-collapse-btn",attrs:{size:"samll"},on:{click:t.resetRefresh}},[t._v(t._s(t.$t("button.reset")))])],1)])])])])},staticRenderFns:[]},m=e("VU/8")(r,h,!1,function(t){e("vFLB"),e("1Vdj")},"data-v-748fb1c4",null);a.a=m.exports},fNHr:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("ra3B"),s={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"base-analysis"},[e("el-header",{attrs:{height:"70px"}},[e("span",{staticClass:"asis-title"},[t._v(t._s(t.asisName)+" "+t._s(t.$t("asis.RankAsis")))]),t._v(" "),e("span",{staticClass:"more-option-wrapper",on:{click:t.showCollapse}},[e("span",{staticClass:"more-option-text"},[t._v(t._s(t.$t("asis.moreOp")))]),t._v(" "),e("i",{class:t.moreOptVisible?"el-icon-arrow-down more-option-arrow":"el-icon-arrow-down more-option-arrow more-option-up"})])]),t._v(" "),e("rank-option",{directives:[{name:"show",rawName:"v-show",value:t.moreOptVisible,expression:"moreOptVisible"}],ref:"init",attrs:{mallData:t.mallData},on:{reportTime:t.reportHandler,initData:t.initTab}}),t._v(" "),e("div",{staticClass:"element-main rank-main"},[t.isTabChart?e("div",{staticClass:"asis-table-wrapper"},[e("h3",{staticClass:"asis-table-header"},[e("span",{staticClass:"asis-table-title"},[t._v(t._s(t.i18nFormatter(t.rankingList_title)))]),t._v(" "),e("span",{staticClass:"asis-table-download",on:{click:function(a){t.dealExport("domTrafficFlow",t.i18nFormatter(t.rankingList_title))}}},[t._v(t._s(t.$t("allPages.load")))]),t._v(" "),e("span",{staticClass:"report-type-box"},[e("span",{class:t.isTabChart?"report-item bar-report":"report-item bar-report report-item-bar",on:{click:function(a){t.selReport("bar")}}}),t._v(" "),e("span",{class:t.isTabChart?"report-item report-item-tab":"report-item",on:{click:function(a){t.selReport("table")}}})])]),t._v(" "),e("div",{staticClass:"asis-table-content"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.rankLoading,expression:"rankLoading"}],staticClass:"asis-table",staticStyle:{width:"100%"},attrs:{id:"domTrafficFlow",data:t.rankingList_tab,"header-row-class-name":"asis-table-head","max-height":t.tableHeight}},[t.rankingList_head.length>0?e("el-table-column",{attrs:{type:"index",align:"center",label:t.$t("table.order"),width:"100"}}):t._e(),t._v(" "),t._l(t.rankingList_head,function(a){return e("el-table-column",{key:a.prop,attrs:{prop:a.prop,label:a.label,align:"center",formatter:t.summation,"min-width":"100"}})})],2)],1)]):t._l(t.rankingList_bar,function(a,i){return e("div",{key:i,staticClass:"asis-table-wrapper rank-table-wrapper"},[e("rank-chart",{staticClass:"rank-chart-box",attrs:{id:"rankChart"+i,options:a,chartType:"RankBar"}}),t._v(" "),e("span",{staticClass:"ehcarts-title"},[t._v(t._s(t.i18n(a.nameType))+t._s(t.i18nFormatter(t.ranking_title)))]),t._v(" "),t.isTabChart?t._e():e("span",{staticClass:"report-type-box bar-type-box"},[e("span",{class:t.isTabChart?"report-item bar-report":"report-item bar-report report-item-bar",on:{click:function(a){t.selReport("bar")}}}),t._v(" "),e("span",{class:t.isTabChart?"report-item report-item-tab":"report-item",on:{click:function(a){t.selReport("table")}}})]),t._v(" "),t.isTabChart?t._e():e("span",{staticClass:"download-text",on:{click:function(a){t.exportDataHandle("rankChart"+i,t.i18n(t.nameType)+t.i18nFormatter(t.ranking_title),"rankingList")}}},[t._v(t._s(t.$t("allPages.load")))])],1)})],2),t._v(" "),e("export-data-dialog",{ref:"exportDialog"})],1)},staticRenderFns:[]},l=function(t){e("KxAo")},o=e("VU/8")(i.a,s,!1,l,"data-v-2488e9dd",null);a.default=o.exports},ra3B:function(t,a,e){"use strict";(function(t){var i=e("mvHQ"),s=e.n(i),l=e("pJt5"),o=e("jR44"),n=e("eq+Q");a.a={data:function(){return{moreOptVisible:!1,mallData:[],asisName:"",asisLevel:"",emitData:{},tableKeyToId:{},tableIds:"",rankingList_title:"",radioDate:"小时级",rankLoading:!1,rankingList_head:[],rankingList_tab:[],kpiKey:{mall:["TRAFFIC"],floor:["TRAFFIC"],gate:["INNUM","OUTNUM"],zone:["TRAFFIC"],format:["TRAFFIC"]},nameKey:{TRAFFIC:"TRAFFIC",SALES:"SALES",PREPRICE:"PREPRICE",PERAREAVALUE:"PERAREAVALUE",DURATIONTIME:"DURATIONTIME",DEPTH:"DEPTH",INNUM:"INNUM",OUTNUM:"OUTNUM",ENTERINGRATE:"ENTERINGRATE",ORDER:"VOLUME",ZONENUM:"ZONENUM"},isTabChart:!1,rankingList_bar:[],isGate:!1,apiUrl:"",searchTime:"",kpiVal:"",ranking_title:"",nameType:"",tableHeight:0,startTime:"",endTime:""}},components:{"rank-option":n.a,"rank-chart":o.a,"export-data-dialog":l.a},created:function(){var a=this,e=t(window).height(),i=.28;e<=720?i=.35:e<=768?i=.33:e<=900?i=.28:e<=1080&&(i=.31),this.tableHeight=e-e*i,window.addEventListener("resize",function(){try{var e={chart1:t("#rankChart0")[0],chart2:t("#rankChart1")[0],chart3:t("#rankChart2")[0],chart4:t("#rankChart3")[0],chart5:t("#rankChart4")[0],chart6:t("#rankChart5")[0],chart7:t("#rankChart6")[0],chart8:t("#rankChart7")[0],chart9:t("#rankChart8")[0]};for(var i in e)if(e.hasOwnProperty(i)&&void 0!=e[i]){e[i]=a.$echarts.init(e[i]);e[i].resize()}}catch(t){}})},mounted:function(){this.getMallOpt(),this.showCollapse()},methods:{i18n:function(t){var a="format."+t;return this.$t(a)},showCollapse:function(){var a=this,e="",i="",s="",l="";e=this.getStyleFn(".el-header","height"),i=this.getStyleFn(".analysis-wrapper .el-header","height"),this.moreOptVisible?(this.moreOptVisible=!1,l=e+i+8+"px",t(".rank-main").animate({marginTop:l})):(this.moreOptVisible=!0,setTimeout(function(){s=a.getStyleFn(".analysis-option-wrapper","height"),l=e+i+s+8+"px",t(".rank-main").animate({marginTop:l})},100))},getMallOpt:function(){var t=this;this.axios.get("/malls",{params:{accountId:this.$cookie.get("accountId"),status:1,_t:Date.parse(new Date)/1e3}}).then(function(a){var e="",i=null;if(a.data.data.length>=1){var s=window.sessionStorage.getItem("mallId");s&&Number(s),a.data.data.forEach(function(a,i){t.mallData.push(a),s&&a.id==s&&(e=a.name)}),t.asisName=e||a.data.data[0].name,i=s?Number(s):a.data.data[0].id,t.$refs.init.initAsis(i)}})},initTab:function(t){var a=this;this.emitData=t,this.tableKeyToId={},this.tableIds="",this.axios.get("/reportCharts",{params:{report:"ranking",_t:Date.parse(new Date)/1e3}}).then(function(t){var e=t.data.data;e.forEach(function(t,i){a.tableKeyToId[t.key]=t.id,"rankingList"===t.key&&(i==e.length-1?a.tableIds+=t.id:a.tableIds+=t.id+",")}),a.selReport("table")}).catch(function(t){console.log("initdata err",t.message)})},getTableData:function(t){if(t){this.isTabChart=!1;var a="",e={},i="",s=[];i=this.dealTime(this.emitData.asis_date,this.emitData.asis_time),this.startTime=i[0],this.endTime=i[1],s=this.dealKey(this.emitData.asis_level),"format"===this.emitData.asis_level?(a="/report/ranking/mall",e={orgIds:this.emitData.asis_org,startDate:i[0],endDate:i[1],chartIds:t,formatIds:this.emitData.asis_format,kpiTypes:s.join(","),_t:Date.parse(new Date)/1e3}):(a="/report/ranking/"+this.emitData.asis_level,e={orgIds:this.emitData.asis_org,startDate:i[0],endDate:i[1],chartIds:t,kpiTypes:s.join(","),_t:Date.parse(new Date)/1e3}),this.getChart(a,e,s)}},summation:function(t,a,e,i){return this.isGate&&(t.defaultOrg2=t.defaultOrg0+t.defaultOrg1),e},unshiftColumn:function(t,a){var e=JSON.parse(s()(t));return e.forEach(function(t){t.data.unshift(t.name),a&&t.data.push("")}),e},dealKey:function(t){var a=[];switch(t){case"mall":a=this.kpiKey.mall;break;case"floor":a=this.kpiKey.floor;break;case"gate":a=this.kpiKey.gate;break;case"zone":a=this.kpiKey.zone;break;case"format":a=this.kpiKey.format}return a},dealTime:function(t,a){var e="",i="",s="";if(a)if("day"===t)e=[a,a];else if("week"==t)e=[this.getWeekTime(a,!1),this.getWeekTime(a,!0)];else if("month"==t){if(a.getMonth()===(new Date).getMonth()&&a.getFullYear()===(new Date).getFullYear())s=dateUnit.dateFormat(a,"yyyy-MM-dd"),(i=dateUnit.dateFormat(new Date(Date.parse(a.getFullYear()+"/"+(a.getMonth()+1)+"/01")),"yyyy-MM-dd"))==s&&(s=dateUnit.dateFormat(new Date,"yyyy-MM-dd"));else{i=a,s=new Date(Date.parse(this.dayAdd(a,31).replace(/\-/,"/")));var l=this.unitTime(i,s,"month");i=l.startTime,s=l.endTime}e=[i,s]}else if(a instanceof Array)e=a;else{if(a.getFullYear()===(new Date).getFullYear())s=dateUnit.dateFormat(a,"yyyy-MM-dd"),(i=dateUnit.dateFormat(new Date(Date.parse(a.getFullYear()+"/01/01")),"yyyy-MM-dd"))==s&&(s=dateUnit.dateFormat(new Date,"yyyy-MM-dd"));else{i=a,s=new Date(Date.parse(this.dayAdd(a,365).replace(/\-/,"/")));var o=this.unitTime(i,s,"year");i=o.startTime,s=o.endTime}e=[i,s]}else e="day"===t?[dateUnit.dateFormat(new Date,"yyyy-MM-dd"),dateUnit.dateFormat(new Date,"yyyy-MM-dd")]:"week"==t?[this.getWeekTime(new Date,!1),this.getWeekTime(new Date,!0)]:"month"==t?[dateUnit.dateFormat(new Date(Date.parse((new Date).getFullYear()+"/"+((new Date).getMonth()+1)+"/01")),"yyyy-MM-dd"),dateUnit.dateFormat(new Date,"yyyy-MM-dd")]:[dateUnit.dateFormat(new Date(Date.parse((new Date).getFullYear()+"/01/01")),"yyyy-MM-dd"),dateUnit.dateFormat(new Date,"yyyy-MM-dd")];return e},getChart:function(t,a,e){var i=this;this.rankingList_bar=[];for(var l=function(l){a.kpiTypes=e[l],a._t=Date.parse(new Date)/1e3;var o=e[l];i.axios.get(t,{params:JSON.parse(s()(a))}).then(function(t){var a=t.data;setTimeout(function(){i.rankLoading=!1});var e=a.data.body.rankingList;i.ranking_title="rankingrankingList",i.nameType=i.nameKey[o],e.nameType=i.nameKey[o],e.title=i.nameKey[o]+e.title,e.color=["#6e6fc1","#33bafe","#fec62b","#ff9c01","#38d4be","#79ce4c"],e.kpiType=o,i.rankingList_bar.push(e)}).catch(function(t){console.log("rankasis error:",t.message)})},o=0;o<e.length;o++)l(o)},getTable:function(t,a){var e=this;this.rankingList_title="",this.rankingList_head=[],this.rankingList_tab=[],this.axios.get(t,{params:a}).then(function(t){var a=t.data,i=[];setTimeout(function(){e.rankLoading=!1},1e3);var s=a.data.body.rankingList;e.rankingList_title="rankingrankingList";var l={};s.xaxis&&(i=s.xaxis.data),"gate"===e.emitData.asis_level?(e.isGate=!0,i.push("合计客流"),l=e.unshiftColumn(s.series,!0)):l=e.unshiftColumn(s.series),i.length>=1&&(e.rankingList_head=e.autoComplateHead(i)),s.series.length&&(e.rankingList_tab=e.dealData(l,e.rankingList_head))}).catch(function(t){console.log("rankasis error:",t.message)})},selReport:function(t){var a=this;if("table"===t){if(this.isTabChart)return;this.isTabChart=!0;var e="",i={},s="",l=[];if(s=this.dealTime(this.emitData.asis_date,this.emitData.asis_time),l=this.dealKey(this.emitData.asis_level),this.startTime=s[0],this.endTime=s[1],"format"===this.emitData.asis_level?(e="/report/ranking/mall",i={orgIds:this.emitData.asis_org,startDate:s[0],endDate:s[1],chartIds:this.tableIds,formatIds:this.emitData.asis_format,kpiTypes:l.join(","),_t:Date.parse(new Date)/1e3}):(e="/report/ranking/"+this.emitData.asis_level,i={orgIds:this.emitData.asis_org,startDate:s[0],endDate:s[1],chartIds:this.tableIds,kpiTypes:l.join(","),_t:Date.parse(new Date)/1e3}),!this.tableIds)return;this.getTable(e,i)}else{if(!this.isTabChart)return;this.isTabChart=!1,this.tableIds?this.getTableData(this.tableIds):this.axios.get("/reportCharts",{params:{report:"ranking",_t:Date.parse(new Date)/1e3}}).then(function(t){var e=t.data.data;e.forEach(function(t,i){a.tableKeyToId[t.key]=t.id,"rankingList"===t.key&&(i==e.length-1?a.tableIds+=t.id:a.tableIds+=t.id+",")}),a.getTableData(a.tableIds)}).catch(function(t){console.log("initdata err",t.message)})}},autoComplateHead:function(t){var a=[];return a=[{prop:"defaultOrg",label:this.$t("dialog.name")}],t.forEach(function(t,e){a.push({prop:"defaultOrg"+e,label:t})}),a},dealData:function(t,a){var e={},i=[],s="";return t.forEach(function(t){if(t.data.length<a.length){for(var l=0,o=t.data.length;l<o;l++)s=a[l].prop,e[s]=t.data[l]||0==t.data[l]?t.data[l]:"--";for(var n=t.data.length;n<a.length;n++)s=a[n].prop,e[s]="--"}else for(var r=0,h=t.data.length;r<h;r++)s=a[r].prop,e[s]=t.data[r]||0==t.data[r]?t.data[r]:"--";i.push(e),e={}}),i},reportHandler:function(t){var a=this;this.emitData=t,this.asisName=t.asis_tit,this.isTabChart=!1,this.selReport("table"),this.tableIds||this.axios.get("/reportCharts",{params:{report:"ranking",_t:Date.parse(new Date)/1e3}}).then(function(t){var e=t.data.data;e.forEach(function(t,i){a.tableKeyToId[t.key]=t.id,"rankingList"===t.key&&(i==e.length-1?a.tableIds+=t.id:a.tableIds+=t.id+",")})}).catch(function(t){console.log("initdata err",t.message)})},exportDataHandle:function(t,a,e){var i=this.tableKeyToId[e],s={domId:t,title:a,data:{url:"/report/ranking/"+this.emitData.asis_level+"/"+i+"/excel",params:"orgIds="+this.emitData.asis_org+"&startDate="+this.startTime+"&endDate="+this.endTime+"&kpiTypes=TRAFFIC"}};this.$refs.exportDialog.dialogInit(s)}}}}).call(a,e("7t+N"))},vFLB:function(t,a){}});