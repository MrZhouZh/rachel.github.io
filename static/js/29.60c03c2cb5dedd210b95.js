webpackJsonp([29],{"6vVP":function(a,t){},D5oJ:function(module,__webpack_exports__,__webpack_require__){"use strict";(function($){var __WEBPACK_IMPORTED_MODULE_0__common_option_groupTimeOps__=__webpack_require__("URkq");__webpack_exports__.a={data:function(){return{moreOptVisible:!1,repTitle:"",gender_title:"",genderData_head:[],genderData_ops:[],age_title:"",ageData_head:[],ageData_ops:[],loading:!0,tableKeyToId:{},tableIds:"",emitData:{}}},components:{"test-option":__WEBPACK_IMPORTED_MODULE_0__common_option_groupTimeOps__.a},mounted:function(){this.showCollapse()},methods:{showCollapse:function(){var a=this,t="",e="",l="",i="";t=this.getStyleFn(".el-header","height"),e=this.getStyleFn(".grouptime-wrapper .el-header","height"),this.moreOptVisible?(this.moreOptVisible=!1,i=t+e+8+"px",$(".grouptime-main").animate({marginTop:i})):(this.moreOptVisible=!0,setTimeout(function(){l=document.documentMode?(l=a.getStyleFn(".behavior-more-option","height"))+a.getStyleFn(".behavior-more-option","paddingTop")+a.getStyleFn(".behavior-more-option","paddingBottom"):a.getStyleFn(".behavior-more-option","height"),i=t+e+l+8+"px",$(".grouptime-main").animate({marginTop:i})},100))},getTableId:function(){var a=this;this.tableKeyToId={},this.tableIds="",this.axios.get("/reportCharts",{params:{report:"faceCountAnalyzeSta",_t:Date.parse(new Date)/1e3}}).then(function(t){var e=t.data.data;e.forEach(function(t,l){a.tableKeyToId[t.key]=t.id,l==e.length-1?a.tableIds+=t.id:a.tableIds+=t.id+","}),a.getTableData(a.tableIds)})},getTableData:function(a){var t=this;if(a){var e="",l={};e="mall"===this.emitData.level?"/report/faceCountAnalyzeSta/mall":"/report/faceCountAnalyzeSta/gate",l={orgIds:this.emitData.orgIds,startDate:this.emitData.startDate,endDate:this.emitData.endDate,chartIds:a,_t:Date.parse(new Date)/1e3},this.axios.get(e,{params:l}).then(function(a){var e=a.data,l="faceCountAnalyzeSta";t.gender_title=l+"faceGenderDetail",t.age_title=l+"faceAgeDetail";var i=e.data.body.faceGenderDetail.xaxis.data;t.genderData_head=t.autoComplateHead("faceGenderDetail",i);var s=e.data.body.faceAgeDetail.xaxis.data;t.ageData_head=t.autoComplateHead("faceAgeDetail",s);var n=e.data.body.faceGenderDetail.series,o=e.data.body.faceAgeDetail.series;t.genderData_ops=t.dealData(n,t.genderData_head),t.ageData_ops=t.dealData(o,t.ageData_head),setTimeout(function(){t.loading=!1},1e3)}).catch(function(a){console.log("base err:",a.message,a)})}},autoComplateHead:function(a,t){var e=[];return t.forEach(function(a,t){e.push({prop:"defaultOrg"+t,label:a})}),e},dealData:function(a,t){var e={},l=[],i="";return a.forEach(function(a){if(a.data.length<t.length){for(var s=0,n=a.data.length;s<n;s++)i=t[s].prop,e[i]=a.data[s]||0==a.data[s]?a.data[s]:"--";for(var o=a.data.length;o<t.length;o++)i=t[o].prop,e[i]="--"}else for(var r=0,c=a.data.length;r<c;r++)i=t[r].prop,e[i]=a.data[r]||0==a.data[r]?a.data[r]:"--";l.push(e),e={}}),l},startLoad:function(a){"groupTime"===a&&(this.genderData_ops=[],this.ageData_ops=[],this.loading=!0)},getPatams:function(a){this.emitData=a,this.repTitle=a.title,this.tableIds?this.getTableData(this.tableIds):this.getTableId()},getTitle:function(a){this.repTitle=a},getSummaries:function getSummaries(param){var columns=param.columns,data=param.data,sums=[];return columns.forEach(function(column,index){if(0!=index){var values=data.map(function(a){return Number(a[column.property])});if(values.every(function(a){return isNaN(a)})){var precentVal=data.map(function(a){if(/\%/g.test(a[column.property]))return a[column.property].split("%")[0]});if(!precentVal.every(function(a){return isNaN(a)})){sums[index]=precentVal.reduce(function(a,t){var e=Number(t);return isNaN(e)?a:e>0?a-0+(t-0):a-0-(-t-0)});try{sums[index]=sums[index].toFixed(2)}catch(error){eval("console.log('sum err', error.message)")}sums[index]+="%"}}else sums[index]=values.reduce(function(a,t){var e=Number(t);return isNaN(e)?a:a+t},0)}else sums[index]="合计"}),sums}}}}).call(__webpack_exports__,__webpack_require__("7t+N"))},JscK:function(a,t){},URkq:function(a,t,e){"use strict";var l={data:function(){return{date1:"",pickerOptions1:{disabledDate:function(a){return a.getTime()>Date.now()}},levelVal:"",levelList:[{label:"mall",value:"mall"},{label:"gate",value:"gate"}],mallName:"",mallVal:[],linkMallVal:"",mallOpt:[],monitoryVal:[],monitoryName:"",monitoryOpt:[],cameraVal:"",cameraOpt:[],typeVal:"",timeVal:"",account_id:"",all_id:[],isAll:!1,isSingle:!1,arr:[],idArr:[],isSelAll:!1,isMallSelAll:!1}},created:function(){this.levelVal="mall",this.account_id=this.$cookie.get("accountId"),this.timeVal=dateUnit.dateFormat(new Date,"yyyy-MM-dd"),this.levelChange()},mounted:function(){var a=this;setTimeout(function(){a.clickHandle()},500)},methods:{i18n:function(a){var t="asisTab."+a;return this.$t(t)},levelChange:function(){switch(this.levelVal){case"mall":this.getMallList();break;case"gate":this.getLinkageList()}},getLinkageList:function(){},getMallList:function(){var a=this;this.mallOpt=[],this.mallVal=[],this.linkMallVal="",this.mallName="",this.isMallSelAll=!1,this.axios.get("/malls",{params:{accountId:this.account_id,status:1,_t:Date.parse(new Date)/1e3}}).then(function(t){var e=t.data.data,l="";if(e.length>0){var i=window.sessionStorage.getItem("mallId");i&&Number(i),a.mallOpt=e,e.forEach(function(a,t){i&&a.id==i&&(l=a.name)}),a.mallName=l||e[0].name,a.mallVal=i?[Number(i)]:[e[0].id],a.linkMallVal=i?Number(i):e[0].id,a.mallVal.length==a.mallOpt.length&&(a.isMallSelAll=!0),a.getGates(a.linkMallVal)}}).catch(function(a){})},mallHandle:function(){var a=this;this.isMallSelAll=(this.isMallSelAll,!(this.mallVal.length<this.mallOpt.length)),this.mallName="",this.mallVal.length>0&&this.mallOpt.forEach(function(t){t.id==a.mallVal[0]&&(a.mallName=t.name)})},chooseMall:function(){var a=this;this.mallName="",this.mallOpt.forEach(function(t){t.id==a.linkMallVal&&(a.mallName=t.name)}),this.getGates(this.linkMallVal)},getGates:function(a){var t=this;this.monitoryOpt=[],this.monitoryVal=[],this.monitoryName="",this.isSelAll=!1,this.axios.get("/gates",{params:{mallId:a,status:1,isHasFace:1,_t:Date.parse(new Date)/1e3}}).then(function(a){var e=a.data.data;e.length&&(e.forEach(function(a,e,l){t.all_id.push(a.id)}),t.monitoryOpt=e,t.arr.push(e[0].id),t.idArr.push(e[0].id),t.monitoryVal.push(e[0].id),t.monitoryVal.length==t.monitoryOpt.length&&(t.isSelAll=!0),t.monitoryName=e[0].name)}).catch(function(a){})},chooseMonitory:function(){var a=this;this.isSelAll=(this.isSelAll,!(this.monitoryVal.length<this.monitoryOpt.length)),this.monitoryName="",this.monitoryVal.length>0&&this.monitoryOpt.forEach(function(t){t.id==a.monitoryVal[0]&&(a.monitoryName=t.name)})},clickHandle:function(){var a=this;this.$emit("startLoading","groupTime"),this.timeVal=this.timeVal.length>1?this.timeVal:dateUnit.dateFormat(new Date,"yyyy-MM-dd"),setTimeout(function(){var t="";"mall"===a.levelVal?a.mallVal.forEach(function(a,e,l){t+=a+","}):a.monitoryVal.forEach(function(a,e,l){t+=a+","}),a.idArr=[],t=t.substring(0,t.length-1);new Date(Date.parse(new Date(a.timeVal))+864e5);var e=a.timeVal+" 00:00:00",l=a.timeVal+" 23:59:59",i={level:a.levelVal,orgIds:t,startDate:e,endDate:l,title:"mall"===a.levelVal?a.mallName+" "+e.split(" ")[0]+" ":(a.mallName=a.mallName?a.mallName+"-":a.mallName)+a.monitoryName+" "+e.split(" ")[0]+" "};a.$emit("emitParams",i)},1e3)},selAllHandle:function(a){var t=this;"mall"===a?this.isMallSelAll?(this.isMallSelAll=!1,this.mallVal.length==this.mallOpt.length&&(this.mallVal=[])):(this.isMallSelAll=!0,this.mallVal.length==this.mallOpt.length?this.mallVal=[]:(this.mallVal=[],this.mallOpt.forEach(function(a){t.mallVal.push(a.id)}))):this.isSelAll?(this.isSelAll=!1,this.monitoryVal.length==this.monitoryOpt.length&&(this.monitoryVal=[])):(this.isSelAll=!0,this.monitoryVal.length==this.monitoryOpt.length?this.monitoryVal=[]:(this.monitoryVal=[],this.monitoryOpt.forEach(function(a){t.monitoryVal.push(a.id)})))}}},i={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"behavior-more-option behavior-test-option"},[e("div",{staticClass:"opt-left"},[e("div",{staticClass:"test-opt-mall"},[e("el-select",{staticClass:"level-sel-box",attrs:{placeholder:a.$t("pholder.gateLevel")},on:{change:a.levelChange},model:{value:a.levelVal,callback:function(t){a.levelVal=t},expression:"levelVal"}},a._l(a.levelList,function(t){return e("el-option",{key:t.value,attrs:{label:a.i18n(t.label),value:t.value}})})),a._v(" "),"mall"===a.levelVal?e("span",[a._v("-")]):a._e(),a._v(" "),"mall"===a.levelVal?e("el-select",{staticClass:"mall-opt",attrs:{filterable:"",placeholder:a.$t("pholder.shopSelect"),multiple:"","collapse-tags":""},on:{change:a.mallHandle},model:{value:a.mallVal,callback:function(t){a.mallVal=t},expression:"mallVal"}},[e("div",{class:a.isMallSelAll?"sel-all-box selected":"sel-all-box",on:{click:function(t){a.selAllHandle("mall")}}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),a._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[a._v(a._s(a.$t("allPages.all")))])]),a._v(" "),a._l(a.mallOpt,function(t,l){return e("el-option",{key:t.value,attrs:{label:t.name,value:t.id}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),a._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[a._v(a._s(t.name))])])})],2):a._e()],1),a._v(" "),"gate"===a.levelVal?e("div",{staticClass:"test-opt-mall"},[e("el-select",{staticClass:"mall-opt",attrs:{filterable:"",placeholder:a.$t("pholder.shopSelect")},on:{change:a.chooseMall},model:{value:a.linkMallVal,callback:function(t){a.linkMallVal=t},expression:"linkMallVal"}},a._l(a.mallOpt,function(a,t){return e("el-option",{key:a.value,attrs:{label:a.name,value:a.id}})}))],1):a._e(),a._v(" "),"gate"===a.levelVal?e("div",{staticClass:"test-opt-monitory"},[e("el-select",{staticClass:"multipleClass mall-sel-box",attrs:{filterable:"",placeholder:a.$t("pholder.site"),multiple:"","collapse-tags":""},on:{change:a.chooseMonitory},model:{value:a.monitoryVal,callback:function(t){a.monitoryVal=t},expression:"monitoryVal"}},[e("div",{class:a.isSelAll?"sel-all-box selected":"sel-all-box",on:{click:function(t){a.selAllHandle("gate")}}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),a._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[a._v(a._s(a.$t("allPages.all")))])]),a._v(" "),a._l(a.monitoryOpt,function(t,l){return e("el-option",{key:t.value,attrs:{label:t.name,value:t.id}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),a._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[a._v(a._s(t.name))])])})],2)],1):a._e(),a._v(" "),e("div",{staticClass:"test-opt-time"},[e("el-date-picker",{staticClass:"time-opt",attrs:{type:"date","picker-options":a.pickerOptions1,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:a.timeVal,callback:function(t){a.timeVal=t},expression:"timeVal"}})],1)]),a._v(" "),e("div",{staticClass:"opt-right"},[e("el-button",{staticClass:"primary-btn behavior-collapse-btn",attrs:{type:"primary",size:"samll"},on:{click:a.clickHandle}},[a._v(a._s(a.$t("button.confirm")))])],1)])},staticRenderFns:[]},s=e("VU/8")(l,i,!1,function(a){e("JscK")},"data-v-00647027",null);t.a=s.exports},uPCU:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=e("D5oJ"),i={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"grouptime-wrapper"},[e("el-header",{attrs:{height:"70px"}},[e("span",{staticClass:"behavior-title"},[a._v(a._s(a.repTitle)+a._s(a.$t("Behavior.groupTime")))]),a._v(" "),e("span",{staticClass:"more-option-wrapper",on:{click:a.showCollapse}},[e("span",{staticClass:"more-option-text"},[a._v(a._s(a.$t("Behavior.moreOp")))]),a._v(" "),e("i",{class:a.moreOptVisible?"el-icon-arrow-down more-option-arrow":"el-icon-arrow-down more-option-arrow more-option-up"})])]),a._v(" "),e("test-option",{directives:[{name:"show",rawName:"v-show",value:a.moreOptVisible,expression:"moreOptVisible"}],ref:"searchRef",on:{emitParams:a.getPatams,startLoading:a.startLoad}}),a._v(" "),e("div",{staticClass:"element-main grouptime-main behavior-main"},[e("div",{staticClass:"asis-table-wrapper"},[e("h3",{staticClass:"asis-table-header"},[e("span",{staticClass:"asis-table-title"},[a._v(a._s(a.i18nFormatter(a.gender_title)))]),a._v(" "),e("span",{staticClass:"asis-table-download",on:{click:function(t){a.dealExport("domGender",a.i18nFormatter(a.gender_title))}}},[a._v(a._s(a.$t("allPages.load")))])]),a._v(" "),e("div",{staticClass:"asis-table-content"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],staticClass:"asis-table",staticStyle:{width:"100%"},attrs:{id:"domGender",data:a.genderData_ops,"summary-method":a.getSummaries,"show-summary":"","header-row-class-name":"asis-table-head"}},a._l(a.genderData_head,function(a){return e("el-table-column",{key:a.prop,attrs:{prop:a.prop,label:a.label,align:"center"}})}))],1)]),a._v(" "),e("div",{staticClass:"asis-table-wrapper"},[e("h3",{staticClass:"asis-table-header"},[e("span",{staticClass:"asis-table-title"},[a._v(a._s(a.i18nFormatter(a.age_title)))]),a._v(" "),e("span",{staticClass:"asis-table-download",on:{click:function(t){a.dealExport("domAge",a.i18nFormatter(a.age_title))}}},[a._v(a._s(a.$t("allPages.load")))])]),a._v(" "),e("div",{staticClass:"asis-table-content"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],staticClass:"asis-table",staticStyle:{width:"100%"},attrs:{id:"domAge",data:a.ageData_ops,"summary-method":a.getSummaries,"show-summary":"","header-row-class-name":"asis-table-head"}},a._l(a.ageData_head,function(a){return e("el-table-column",{key:a.prop,attrs:{prop:a.prop,label:a.label,align:"center"}})}))],1)])])],1)},staticRenderFns:[]},s=function(a){e("6vVP")},n=e("VU/8")(l.a,i,!1,s,"data-v-cd4940a4",null);t.default=n.exports}});