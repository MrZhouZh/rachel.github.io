webpackJsonp([31],{"5EFx":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("6vcn"),o={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"gateflow-wrapper"},[e("el-header",{attrs:{height:"70px"}},[e("span",{staticClass:"behavior-title"},[t._v(t._s(t.repTitle)+t._s(t.$t("Behavior.gateFlow")))]),t._v(" "),e("span",{staticClass:"more-option-wrapper",on:{click:t.showCollapse}},[e("span",{staticClass:"more-option-text"},[t._v(t._s(t.$t("Behavior.moreOp")))]),t._v(" "),e("i",{class:t.moreOptVisible?"el-icon-arrow-down more-option-arrow":"el-icon-arrow-down more-option-arrow more-option-up"})])]),t._v(" "),e("test-option",{directives:[{name:"show",rawName:"v-show",value:t.moreOptVisible,expression:"moreOptVisible"}],ref:"searchRef",on:{emitParams:t.getPatams,startLoading:t.startLoad}}),t._v(" "),e("div",{staticClass:"element-main gateflow-main behavior-main"},[e("div",{staticClass:"asis-table-wrapper"},[e("h3",{staticClass:"asis-table-header"},[e("span",{staticClass:"asis-table-title"},[t._v(t._s(t.i18nFormatter(t.faceTrafficDetail_title)))]),t._v(" "),e("span",{staticClass:"asis-table-download",on:{click:function(a){t.dealExport("domFaceTrafficDetail",t.i18nFormatter(t.faceTrafficDetail_title))}}},[t._v(t._s(t.$t("allPages.load")))])]),t._v(" "),e("div",{staticClass:"asis-table-content"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"asis-table",staticStyle:{width:"100%"},attrs:{id:"domFaceTrafficDetail",data:t.faceTrafficDetail_ops,"header-row-class-name":"asis-table-head"}},t._l(t.faceTrafficDetail_head,function(t){return e("el-table-column",{key:t.prop,attrs:{prop:t.prop,label:t.label,align:"center"}})}))],1)]),t._v(" "),e("el-row",{staticClass:"chart-wrapper",attrs:{gutter:8}},[e("el-col",{staticClass:"download-parent",attrs:{span:8}},[e("my-chart",{staticClass:"gender-chart",attrs:{id:"faceTrafficChart",options:t.faceTrafficOps,chartType:"horFtBar"}}),t._v(" "),e("span",{staticClass:"ehcarts-title"},[t._v(t._s(t.i18nFormatter(t.faceTraffic_title)))]),t._v(" "),e("span",{staticClass:"download-text",on:{click:function(a){t.exportDataHandle("faceTrafficChart",t.i18nFormatter(t.faceTraffic_title),"faceTraffic")}}},[t._v(t._s(t.$t("allPages.load")))])],1),t._v(" "),e("el-col",{staticClass:"download-parent",attrs:{span:8}},[e("my-chart",{staticClass:"gender-chart",attrs:{id:"faceGenderRatioChart",options:t.faceGenderRatio_ops,chartType:"horFgBar"}}),t._v(" "),e("span",{staticClass:"ehcarts-title"},[t._v(t._s(t.i18nFormatter(t.faceGenderRatio_title)))]),t._v(" "),e("span",{staticClass:"download-text",on:{click:function(a){t.exportDataHandle("faceGenderRatioChart",t.i18nFormatter(t.faceGenderRatio_title),"faceGenderRatio")}}},[t._v(t._s(t.$t("allPages.load")))])],1),t._v(" "),e("el-col",{staticClass:"download-parent",attrs:{span:8}},[e("my-chart",{staticClass:"gender-chart",attrs:{id:"faceAgeRatioChart",options:t.faceAgeRatio_ops,chartType:"areaAge"}}),t._v(" "),e("span",{staticClass:"ehcarts-title"},[t._v(t._s(t.i18nFormatter(t.faceAgeRatio_title)))]),t._v(" "),e("span",{staticClass:"download-text",on:{click:function(a){t.exportDataHandle("faceAgeRatioChart",t.i18nFormatter(t.faceAgeRatio_title),"faceAgeRatio")}}},[t._v(t._s(t.$t("allPages.load")))])],1)],1)],1),t._v(" "),e("export-data-dialog",{ref:"exportDialog"})],1)},staticRenderFns:[]},l=function(t){e("gR5T")},s=e("VU/8")(i.a,o,!1,l,"data-v-01e900f6",null);a.default=s.exports},"6vcn":function(t,a,e){"use strict";(function(t){var i=e("pJt5"),o=e("Got2"),l=e("064L");a.a={data:function(){return{moreOptVisible:!1,repTitle:"",faceTraffic_title:"",faceTrafficOps:{},faceTrafficDetail_title:"",faceTrafficDetail_head:[],faceTrafficDetail_ops:[],faceGenderRatio_title:"",faceGenderRatio_ops:{},faceAgeRatio_title:"",faceAgeRatio_ops:"",loading:!0,tableKeyToId:{},tableIds:"",emitData:{}}},components:{"test-option":o.a,"my-chart":l.a,"export-data-dialog":i.a},created:function(){var a=this;window.addEventListener("resize",function(){try{var e={chart1:t("#faceTrafficChart")[0],chart2:t("#faceGenderRatioChart")[0],chart3:t("#faceAgeRatioChart")[0]};for(var i in e)if(e.hasOwnProperty(i)&&void 0!=e[i]){e[i]=a.$echarts.init(e[i]);e[i].resize()}}catch(t){}})},mounted:function(){this.showCollapse()},methods:{showCollapse:function(){var a=this,e="",i="",o="",l="";e=this.getStyleFn(".el-header","height"),i=this.getStyleFn(".gateflow-wrapper .el-header","height"),this.moreOptVisible?(this.moreOptVisible=!1,l=e+i+8+"px",t(".gateflow-main").animate({marginTop:l})):(this.moreOptVisible=!0,setTimeout(function(){o=document.documentMode?(o=a.getStyleFn(".behavior-more-option","height"))+a.getStyleFn(".behavior-more-option","paddingTop")+a.getStyleFn(".behavior-more-option","paddingBottom"):a.getStyleFn(".behavior-more-option","height"),l=e+i+o+8+"px",t(".gateflow-main").animate({marginTop:l})},100))},getTableId:function(){var t=this;this.tableKeyToId={},this.tableIds="",this.axios.get("/reportCharts",{params:{report:"faceDistribution",_t:Date.parse(new Date)/1e3}}).then(function(a){var e=a.data.data;e.forEach(function(a,i){t.tableKeyToId[a.key]=a.id,i==e.length-1?t.tableIds+=a.id:t.tableIds+=a.id+","}),t.getTableData(t.tableIds)})},getTableData:function(t){var a=this;if(t){var e="",i={};e="/report/faceDistribution/gate",i={orgIds:this.emitData.orgIds,startDate:this.emitData.startDate,endDate:this.emitData.endDate,chartIds:t,_t:Date.parse(new Date)/1e3},this.axios.get(e,{params:i}).then(function(t){var e=t.data,i="faceDistribution";a.faceTrafficDetail_title=i+"faceTrafficDetail",a.faceTraffic_title=i+"faceTraffic",a.faceGenderRatio_title=i+"faceGenderRatio",a.faceAgeRatio_title=i+"faceAgeRatio";var o=e.data.body.faceTrafficDetail.xaxis.data;o.unshift(a.$t("table.order")),a.faceTrafficDetail_head=a.autoComplateHead("faceTrafficDetail",o);var l=e.data.body.faceTraffic;l.color=["#3BB8FF","#FFC62E"],a.faceTrafficOps=l;var s=e.data.body.faceTrafficDetail.series,n=e.data.body.faceGenderRatio;n.color=["#3BB8FF","#FFC62E","#6e6fc1"],a.faceGenderRatio_ops=n;var r=e.data.body.faceAgeRatio;r.color=["#6e6fc1","#33bafe","#fec62b","#ff9c01","#38d4be","#79ce4c"],a.faceAgeRatio_ops=r,s.forEach(function(t,a){t.data.unshift(a+1)}),a.faceTrafficDetail_ops=a.dealData(s,a.faceTrafficDetail_head),setTimeout(function(){a.loading=!1},1e3)}).catch(function(t){console.log("base err:",t.message,t)})}},autoComplateHead:function(t,a){var e=[];return a.forEach(function(t,a){e.push({prop:"defaultOrg"+a,label:t})}),e},dealData:function(t,a){var e={},i=[],o="";return t.forEach(function(t){if(t.data.length<a.length){for(var l=0,s=t.data.length;l<s;l++)o=a[l].prop,e[o]=t.data[l]||0==t.data[l]?t.data[l]:"--";for(var n=t.data.length;n<a.length;n++)o=a[n].prop,e[o]="--"}else for(var r=0,c=t.data.length;r<c;r++)o=a[r].prop,e[o]=t.data[r]||0==t.data[r]?t.data[r]:"--";i.push(e),e={}}),i},startLoad:function(t){"gateFlow"===t&&(this.faceTrafficDetail_ops=[],this.loading=!0,this.faceTrafficOps={},this.faceGenderRatio_ops={},this.faceAgeRatio_ops={})},getPatams:function(t){this.emitData=t,this.repTitle=t.title,this.tableIds?this.getTableData(this.tableIds):this.getTableId()},getTitle:function(t){this.repTitle=t},exportDataHandle:function(t,a,e){var i={domId:t,title:a,data:{url:"/report/faceDistribution/gate/"+this.tableKeyToId[e]+"/excel",params:"orgIds="+this.emitData.orgIds+"&startDate="+this.emitData.startDate+"&endDate="+this.emitData.endDate}};this.$refs.exportDialog.dialogInit(i)}}}}).call(a,e("7t+N"))},Got2:function(t,a,e){"use strict";var i={data:function(){return{date1:"",pickerOptions1:{disabledDate:function(t){return t.getTime()>Date.now()}},mallName:"",mallVal:"",mallOpt:[],monitoryVal:[],monitoryName:"",monitoryOpt:[],cameraVal:"",cameraOpt:[],typeVal:"",timeVal:"",account_id:"",all_id:[],isAll:!1,isSingle:!1,arr:[],idArr:[],isSelAll:!1}},created:function(){},mounted:function(){this.account_id=this.$cookie.get("accountId"),this.timeVal=dateUnit.dateFormat(new Date,"yyyy-MM-dd"),this.getMallList()},methods:{getMallList:function(){var t=this;this.mallOpt=[],this.mallVal="",this.mallName="",this.axios.get("/malls",{params:{accountId:this.account_id,status:1,_t:Date.parse(new Date)/1e3}}).then(function(a){var e=a.data.data,i="";if(t.len=e.length,e.length>0){var o=window.sessionStorage.getItem("mallId");o&&Number(o),t.mallOpt=e,e.forEach(function(t,a){o&&t.id==o&&(i=t.name)}),t.mallName=i||e[0].name,t.mallVal=o?Number(o):e[0].id,t.getGates(t.mallVal)}}).catch(function(t){})},chooseMall:function(){var t=this;this.mallOpt.forEach(function(a){a.id==t.mallVal&&(t.mallName=a.name)}),this.getGates(this.mallVal)},getGates:function(t){var a=this;this.monitoryOpt=[],this.monitoryVal=[],this.monitoryName="",this.isSelAll=!1,this.axios.get("/gates",{params:{mallId:t,status:1,isHasFace:1,_t:Date.parse(new Date)/1e3}}).then(function(t){var e=t.data;e.data.length&&(e.data.forEach(function(t,e,i){a.all_id.push(t.id),a.monitoryVal.push(t.id),0==e&&(a.monitoryName=t.name)}),a.monitoryOpt=e.data,a.monitoryVal.length==a.monitoryOpt.length&&(a.isSelAll=!0),a.clickHandle())}).catch(function(t){})},chooseMonitory:function(){var t=this;this.isSelAll=(this.isSelAll,!(this.monitoryVal.length<this.monitoryOpt.length)),this.monitoryName="",this.monitoryVal.length>0&&this.monitoryOpt.forEach(function(a){return a.id==t.monitoryVal[0]&&(t.monitoryName=a.name),!1})},selAllHandle:function(){var t=this;this.isSelAll?(this.isSelAll=!1,this.monitoryVal.length==this.monitoryOpt.length&&(this.monitoryVal=[])):(this.isSelAll=!0,this.monitoryVal.length==this.monitoryOpt.length?this.monitoryVal=[]:(this.monitoryVal=[],this.monitoryOpt.forEach(function(a){t.monitoryVal.push(a.id)})))},clickHandle:function(){var t=this,a="";this.$emit("startLoading","gateFlow"),this.timeVal=this.timeVal.length>1?this.timeVal:new Date,setTimeout(function(){var e="";t.monitoryVal.forEach(function(t,a,i){e+=t+","}),e=e.substring(0,e.length-1);new Date(Date.parse(new Date(t.timeVal))+864e5);var i=t.timeVal+" 00:00:00",o=t.timeVal+" 23:59:59";a=t.mallName?t.mallName+"-":t.mallName;var l={orgIds:e,startDate:i,endDate:o,title:a+t.monitoryName+" "+i.split(" ")[0]+" "};t.$emit("emitParams",l)},2e3)}}},o={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"behavior-more-option behavior-test-option"},[e("div",{staticClass:"opt-left"},[e("div",{staticClass:"test-opt-mall"},[e("el-select",{staticClass:"mall-opt",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect")},on:{change:t.chooseMall},model:{value:t.mallVal,callback:function(a){t.mallVal=a},expression:"mallVal"}},t._l(t.mallOpt,function(t,a){return e("el-option",{key:t.value,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),e("div",{staticClass:"test-opt-monitory"},[e("el-select",{staticClass:"multipleClass mall-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.site"),multiple:"","collapse-tags":""},on:{change:t.chooseMonitory},model:{value:t.monitoryVal,callback:function(a){t.monitoryVal=a},expression:"monitoryVal"}},[e("div",{class:t.isSelAll?"sel-all-box selected":"sel-all-box",on:{click:t.selAllHandle}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(t.$t("allPages.all")))])]),t._v(" "),t._l(t.monitoryOpt,function(a,i){return e("el-option",{key:a.value,attrs:{label:a.name,value:a.id}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(a.name))])])})],2)],1),t._v(" "),e("div",{staticClass:"test-opt-time"},[e("el-date-picker",{staticClass:"time-opt",attrs:{type:"date","picker-options":t.pickerOptions1,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:t.timeVal,callback:function(a){t.timeVal=a},expression:"timeVal"}})],1)]),t._v(" "),e("div",{staticClass:"opt-right"},[e("el-button",{staticClass:"primary-btn behavior-collapse-btn",attrs:{type:"primary",size:"samll"},on:{click:t.clickHandle}},[t._v(t._s(t.$t("button.confirm")))])],1)])},staticRenderFns:[]},l=e("VU/8")(i,o,!1,function(t){e("a3B4")},"data-v-0435b934",null);a.a=l.exports},a3B4:function(t,a){},gR5T:function(t,a){}});