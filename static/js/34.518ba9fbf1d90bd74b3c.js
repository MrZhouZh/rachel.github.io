webpackJsonp([34],{"1jCL":function(t,e){},"5bYp":function(t,e){},KJGh:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("MF1K"),l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"camera-wrapper"},[a("el-header",{attrs:{height:"70px"}},[a("span",{staticClass:"behavior-title"},[t._v(t._s(t.repTitle)+t._s(t.$t("Behavior.clerkcamera")))]),t._v(" "),a("span",{staticClass:"more-option-wrapper",on:{click:t.showCollapse}},[a("span",{staticClass:"more-option-text"},[t._v(t._s(t.$t("Behavior.moreOp")))]),t._v(" "),a("i",{class:t.moreOptVisible?"el-icon-arrow-down more-option-arrow":"el-icon-arrow-down more-option-arrow more-option-up"})])]),t._v(" "),a("clerk-option",{directives:[{name:"show",rawName:"v-show",value:t.moreOptVisible,expression:"moreOptVisible"}],on:{emitParams:t.getPatams,emitTitle:t.getTitle,startLoading:t.startLoad}}),t._v(" "),a("div",{staticClass:"element-main behavior-main"},[a("div",{staticClass:"behavior-table-page"},[a("div",{staticClass:"behavior-table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,"max-height":t.tableHeight,"header-row-class-name":"behavior-thead"}},[a("el-table-column",{attrs:{label:t.$t("table.order"),align:"center",prop:"seriesNum",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("table.name"),align:"center",prop:"name"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("table.age"),align:"center",prop:"age"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("table.gender"),align:"center",prop:"gender",formatter:t.genderFormatter}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("table.time"),align:"center",prop:"counttime"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("table.monitorSiteName"),align:"center",prop:"gateName"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("table.faceMap"),align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{placement:"left",title:"",trigger:"hover"}},[a("div",{staticClass:"face-img-box",attrs:{slot:"reference"},slot:"reference"},[a("img",{staticClass:"face-img",attrs:{src:t.dealImg(e.row),width:"50",height:"50",alt:""},on:{error:t.dealErrImg}})]),t._v(" "),a("img",{attrs:{src:t.dealImg(e.row),width:"200",height:"200",alt:t.dealImg(e.row)},on:{error:t.dealErrImg}})])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"page-wrapper"},[a("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-sizes":t.pageArr,"page-size":t.pageSize,layout:"sizes, prev, pager, next, slot",total:t.totalPage},on:{"size-change":t.sizeChange,"current-change":t.handleCurrentChange}},[a("span",{staticClass:"slot-pagination-ele slot-ele-total"},[t._v(t._s(t.$t("table.pageHead"))+" "+t._s(t.totalPage)+" "+t._s(t.$t("table.pageTail")))])])],1)])])],1)},staticRenderFns:[]},n=function(t){a("1jCL")},o=a("VU/8")(i.a,l,!1,n,"data-v-b7fa5902",null);e.default=o.exports},MF1K:function(t,e,a){"use strict";(function(t){var i=a("yKsA"),l=a("3MSA"),n=a.n(l),o=a("QCPg"),r=(a.n(o),a("bchz"));a.n(r);e.a={data:function(){return{params:{url:"",param:""},moreOptVisible:!1,tableData:[],defaultImg:n.a,currentPage:1,pageArr:[10,50,100],pageSize:10,totalPage:0,repTitle:"",loading:!0,tableHeight:0,emitData:{}}},components:{"clerk-option":i.a},created:function(){var t=this;this.tableHeight=this.computedWinH("px"),window.addEventListener("resize",function(){t.tableHeight=t.computedWinH("px"),t.moreOptVisible=!1,t.showCollapse()})},mounted:function(){this.showCollapse()},methods:{showCollapse:function(){var e=this,a="",i="",l="",n="";a=this.getStyleFn(".el-header","height"),i=this.getStyleFn(".camera-wrapper .el-header","height"),this.moreOptVisible?(n=a+i+8+"px",t(".behavior-main").animate({marginTop:n}),this.moreOptVisible=!1):(this.moreOptVisible=!0,setTimeout(function(){l=document.documentMode?(l=e.getStyleFn(".behavior-more-option","height"))+e.getStyleFn(".behavior-more-option","paddingTop")+e.getStyleFn(".behavior-more-option","paddingBottom"):e.getStyleFn(".behavior-more-option","height"),n=a+i+l+8+"px",t(".behavior-main").animate({marginTop:n})},100))},setStaffDic:function(t){var e=this;this.axios.get("/staffs",{params:{mallId:t,_t:Date.parse(new Date)/1e3}}).then(function(t){t.data.data.forEach(function(t){e.setSessionLocal("staff-"+t.personUnid,t.name)}),e.getTableData()})},getTableData:function(){var t=this;this.axios.get("/faceRecognitions",{params:this.emitData}).then(function(e){var a=e.data;200==a.code?(t.tableData=[],t.totalPage=a.data.total,a.data.list.forEach(function(e,a){var i=e.counttime.split(" ")[0],l=i.split("-")[0]+i.split("-")[1]+i.split("-")[2];e.facePic?e.pic="/face/"+l+"/"+e.channelSerialnum+"/"+e.facePic:e.pic="/body/"+l+"/"+e.channelSerialnum+"/"+e.bodyPic,e.facePic=e.pic?e.pic:"0",e.seriesNum=(t.currentPage-1)*t.pageSize+a+1;var n=t.getSessionLocal("staff",e.personUnid);e.name=n||"未知",e.gateName=e.gate.name}),t.tableData=a.data.list,setTimeout(function(){t.loading=!1},1e3)):t.$message({showClose:!0,type:"error",message:t.$t("message.captureFailed")+a.msg})}).catch(function(t){})},dealImg:function(t){return window.picUrl+t.facePic},dealErrImg:function(t){(t||window.event).target.src=n.a},genderFormatter:function(t,e,a){var i="";return i=this.$t("dictionary."+this.getSessionLocal("gender",a)),i||"--"},handleSizeChange:function(t){this.emitData.pageSize=t,this.pageSize=t,this.loading=!0,this.getTableData()},handleCurrentChange:function(t){this.currentPage,this.emitData.page=t,this.currentPage=t,this.loading=!0,this.getTableData()},changeCurpage:function(t,e){this.currentPage=t},sizeChange:function(t){this.pageSize=t,this.emitData.pageSize=t,this.loading=!0,this.getTableData()},getTitle:function(t){this.repTitle=t},startLoad:function(t){"camera"===t&&(this.loading=!0)},getPatams:function(t){this.pageSize=t.pageSize,this.currentPage=t.page,this.emitData=t,this.setStaffDic(t.mallId)}}}}).call(e,a("7t+N"))},yKsA:function(t,e,a){"use strict";var i={props:{params:Object,pageSize:[String,Number]},data:function(){return{date1:"",pickerOptions1:{disabledDate:function(t){return t.getTime()>Date.now()}},mallName:"",mallVal:"",mallOpt:[],monitoryVal:"",monitoryName:"",monitoryOpt:[],cameraVal:"",cameraOpt:[],timeVal:[],account_id:"",Params:{},isEffect:!0}},created:function(){this.timeVal=[dateUnit.dateFormat(new Date,"yyyy-MM-dd")+" 00:00:00",dateUnit.dateFormat(new Date,"yyyy-MM-dd")+" 23:59:59"],this.getMallList()},mounted:function(){},methods:{getMallList:function(){var t=this;this.mallOpt=[],this.mallVal="",this.mallName="",this.axios.get("/malls",{params:{accountId:this.$cookie.get("accountId"),status:1,_t:Date.parse(new Date)/1e3}}).then(function(e){var a=e.data.data,i="";if(a.length>0){var l=window.sessionStorage.getItem("mallId");l&&Number(l),t.mallOpt=a,a.forEach(function(t,e){l&&t.id==l&&(i=t.name)}),t.mallName=i||a[0].name,t.mallVal=l?Number(l):a[0].id,t.getGates(t.mallVal),t.clickHandle()}}).catch(function(t){})},chooseMall:function(){var t=this;this.mallOpt.forEach(function(e){e.id==t.mallVal&&(t.mallName=e.name)}),this.getGates(this.mallVal)},getGates:function(t){var e=this;this.monitoryOpt=[],this.monitoryVal="",this.monitoryName="",this.axios.get("/gates",{params:{mallId:t,status:1,isHasFace:1,_t:Date.parse(new Date)/1e3}}).then(function(t){var a=t.data.data;a.length&&(a.unshift({id:"",name:e.$t("pholder.allGate")}),e.monitoryOpt=a,e.monitoryVal=a[0].id,e.monitoryName=a[0].name)}).catch(function(t){})},chooseMonitory:function(){var t=this;this.monitoryOpt.forEach(function(e){e.id==t.monitoryVal&&(t.monitoryName=e.name)})},clickHandle:function(){var t=this;this.$emit("startLoading","camera"),this.timeVal.length<=1&&(this.timeVal=[dateUnit.dateFormat(new Date,"yyyy-MM-dd")+" 00:00:00",dateUnit.dateFormat(new Date,"yyyy-MM-dd")+" 23:59:59"]),setTimeout(function(){var e={counttime_gte:t.timeVal[0],counttime_lte:t.timeVal[1],accountId:t.$cookie.get("accountId"),mallId:t.mallVal,gateId:t.monitoryVal?t.monitoryVal:null,personType:1,direction:1,page:1,pageSize:10,sortName:"counttime",sortOrder:"DESC"};t.Params="&counttime_gte="+t.timeVal[0]+"&counttime_lte="+t.timeVal[1]+"&accountId="+t.$cookie.get("accountId")+"&mallId="+t.mallVal,t.cameraVal&&(t.Params=t.Params+"&channelId="+t.cameraVal),t.monitoryVal&&(t.Params=t.Params+"&gateId="+t.monitoryVal),t.Params=t.Params+"&personType=1",t.Params=t.Params+"&direction=1&page=1&pageSize=10&sortName=counttime&sortOrder=DESC";var a=(t.mallName?t.mallName+"-":t.mallName)+t.monitoryName+" "+t.timeVal[0].split(" ")[0]+"至"+t.timeVal[1].split(" ")[0]+" ";t.$emit("emitTitle",a),t.$emit("emitParams",e)},1e3)},searchHandle:function(t,e){var a=this,i=void 0===e?10:e,l=void 0===t?1:t,n={counttime_gte:this.timeVal[0],counttime_lte:this.timeVal[1],mallId:this.mallVal,gateId:this.monitoryVal?this.monitoryVal:null,personType:1,direction:1,page:l,pageSize:i,sortName:"counttime",sortOrder:"DESC",_t:Date.parse(new Date)/1e3};this.axios.get("/faceRecognitions",{params:n}).then(function(t){var e=t.data;200==e.code?a.$emit("conditionData",e.data):a.$message({showClose:!0,type:"error",message:a.$t("message.captureFailed")+e.msg})}).catch(function(t){})},resetRefresh:function(){this.timeVal=[dateUnit.dateFormat(new Date,"yyyy-MM-dd")+" 00:00:00",dateUnit.dateFormat(new Date,"yyyy-MM-dd")+" 23:59:59"]},uploadData:function(){var t=localStorage.getItem("lang");if(t){t="&localLanguage="+{mall_cn:"zh_CN",zh_CN:"zh_CN",en_US:"en_US",zh_TW:"zh_TW"}[t]}var e=window.apiUrl+"/faceRecognitions/excel?"+this.Params+t;window.open(e)}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"behavior-more-option behavior-test-option"},[a("div",{staticClass:"opt-left"},[a("div",{staticClass:"test-opt-mall"},[a("el-select",{staticClass:"mall-opt",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect")},on:{change:t.chooseMall},model:{value:t.mallVal,callback:function(e){t.mallVal=e},expression:"mallVal"}},t._l(t.mallOpt,function(t,e){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("div",{staticClass:"test-opt-monitory"},[a("el-select",{staticClass:"monitory-opt",attrs:{filterable:"",placeholder:t.$t("pholder.site")},on:{change:t.chooseMonitory},model:{value:t.monitoryVal,callback:function(e){t.monitoryVal=e},expression:"monitoryVal"}},t._l(t.monitoryOpt,function(t,e){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),""!==t.monitoryVal?a("div",{staticClass:"test-opt-camera"},[a("el-select",{attrs:{filterable:"",placeholder:t.$t("pholder.camera")},model:{value:t.cameraVal,callback:function(e){t.cameraVal=e},expression:"cameraVal"}},t._l(t.cameraOpt,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1):t._e(),t._v(" "),a("div",{staticClass:"test-opt-time mr20"},[a("el-date-picker",{staticClass:"time-opt",attrs:{type:"datetimerange","picker-options":t.pickerOptions1,format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":t.$t("pholder.startDate"),"end-placeholder":t.$t("pholder.endDate")},on:{change:t.clickHandle},model:{value:t.timeVal,callback:function(e){t.timeVal=e},expression:"timeVal"}})],1)]),t._v(" "),a("div",{staticClass:"opt-right"},[a("el-button",{staticClass:"primary-btn behavior-collapse-btn",attrs:{type:"primary",size:"samll"},on:{click:t.clickHandle}},[t._v(t._s(t.$t("button.confirm")))]),t._v(" "),a("el-button",{staticClass:"primary-btn behavior-collapse-btn",attrs:{type:"primary",size:"samll"},on:{click:t.uploadData}},[t._v(t._s(t.$t("button.load")))])],1)])},staticRenderFns:[]},n=a("VU/8")(i,l,!1,function(t){a("5bYp")},"data-v-22a0c2aa",null);e.a=n.exports}});