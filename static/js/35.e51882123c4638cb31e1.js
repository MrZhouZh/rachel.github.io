webpackJsonp([35],{"/gNN":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("kZcA"),o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"camera-wrapper"},[a("el-header",{attrs:{height:"70px"}},[a("span",{staticClass:"behavior-title"},[t._v(t._s(t.repTitle)+t._s(t.$t("Behavior.capturecamera")))]),t._v(" "),a("span",{staticClass:"more-option-wrapper",on:{click:t.showCollapse}},[a("span",{staticClass:"more-option-text"},[t._v(t._s(t.$t("Behavior.moreOp")))]),t._v(" "),a("i",{class:t.moreOptVisible?"el-icon-arrow-down more-option-arrow":"el-icon-arrow-down more-option-arrow more-option-up"})])]),t._v(" "),a("test-option",{directives:[{name:"show",rawName:"v-show",value:t.moreOptVisible,expression:"moreOptVisible"}],on:{emitParams:t.getPatams,emitTitle:t.getTitle,startLoading:t.startLoad}}),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"element-main behavior-main"},[a("div",{staticClass:"behavior-table-page"},[a("div",{staticClass:"behavior-table"},[a("ul",{staticClass:"shotpic-wrapper",style:{"max-height":t.tableHeight}},[0==t.tableData.length?a("li",{staticStyle:{"text-align":"center",margin:"10px 0",color:"#909399"}},[t._v(t._s(t.$t("echartsTitle.noData")))]):t._e(),t._v(" "),t._l(t.tableData,function(e,i){return a("li",{key:i,staticClass:"shotpic-item"},[a("div",{staticClass:"shotpic-img"},[a("span",{staticClass:"shotpic-date"},[t._v(t._s(e.counttime))]),t._v(" "),a("img",{attrs:{src:t.dealImg(e)},on:{error:t.dealErrImg}})]),t._v(" "),a("p",{staticClass:"shotpic-info"},[a("span",{staticClass:"shotpic-text__left"},[t._v(t._s(t.$t("table.age"))+": "+t._s(e.age))]),t._v(" "),a("span",{staticClass:"shotpic-text__right"},[t._v(t._s(t.$t("table.gender"))+": "+t._s(e.gender))])]),t._v(" "),a("p",{staticClass:"shotpic-info"},[a("span",{staticClass:"shotpic-text__left"},[t._v(t._s(t.$t("table.type"))+": "+t._s(e.personType))]),t._v(" "),a("span",{staticClass:"shotpic-text__right"},[t._v(t._s(t.$t("table.expression"))+": "+t._s(e.mood))])])])})],2)]),t._v(" "),a("div",{staticClass:"page-wrapper"},[a("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-sizes":t.pageArr,"page-size":t.pageSize,layout:"sizes, prev, pager, next, slot",total:t.totalPage},on:{"size-change":t.sizeChange,"current-change":t.handleCurrentChange}},[a("span",{staticClass:"slot-pagination-ele slot-ele-total"},[t._v(t._s(t.$t("table.pageHead"))+" "+t._s(t.totalPage)+" "+t._s(t.$t("table.pageTail")))])])],1)])])],1)},staticRenderFns:[]},n=function(t){a("nup2")},l=a("VU/8")(i.a,o,!1,n,"data-v-688d657f",null);e.default=l.exports},"05Xd":function(t,e,a){"use strict";var i={props:{params:Object},data:function(){return{date1:"",pickerOptions1:{disabledDate:function(t){return t.getTime()>Date.now()}},mallName:"",mallVal:"",mallOpt:[],monitoryVal:"",monitoryName:"",monitoryOpt:[],cameraVal:"",cameraOpt:[],typeVal:"",timeVal:[],account_id:"",Params:{},isEffect:!0,pageLimit:45}},created:function(){this.timeVal=[dateUnit.dateFormat(new Date,"yyyy-MM-dd")+" 00:00:00",dateUnit.dateFormat(new Date,"yyyy-MM-dd")+" 23:59:59"],this.getMallList()},mounted:function(){},methods:{getMallList:function(){var t=this;this.mallOpt=[],this.mallVal="",this.mallName="",this.axios.get("/malls",{params:{accountId:this.$cookie.get("accountId"),status:1,_t:Date.parse(new Date)/1e3}}).then(function(e){var a=e.data.data,i="";if(a.length>0){var o=window.sessionStorage.getItem("mallId");o&&Number(o),t.mallOpt=a,a.forEach(function(t,e){o&&t.id==o&&(i=t.name)}),t.mallName=i||a[0].name,t.mallVal=o?Number(o):a[0].id,t.getGates(t.mallVal),t.clickHandle()}}).catch(function(t){})},chooseMall:function(){var t=this;this.mallOpt.forEach(function(e){e.id==t.mallVal&&(t.mallName=e.name)}),this.getGates(this.mallVal)},getGates:function(t){var e=this;this.monitoryOpt=[],this.monitoryVal="",this.monitoryName="",this.axios.get("/gates",{params:{mallId:t,status:1,isHasFace:1,_t:Date.parse(new Date)/1e3}}).then(function(t){var a=t.data.data;a.length&&(a.unshift({id:"",name:e.$t("pholder.allGate")}),e.monitoryOpt=a,e.monitoryVal=a[0].id,e.monitoryName=a[0].name+" ",e.getChannels(e.monitoryVal))}).catch(function(t){})},chooseMonitory:function(){var t=this;this.monitoryOpt.forEach(function(e){e.id==t.monitoryVal&&(t.monitoryName=e.name+" ")}),this.getChannels(this.monitoryVal)},getChannels:function(t){var e=this;t&&(this.cameraOpt=[],this.cameraVal="",this.axios.get("/channels",{params:{gateId:t,_t:Date.parse(new Date)/1e3}}).then(function(t){var a=t.data;a.data.length>0&&(a.data.unshift({id:"",name:e.$t("pholder.allChannel")}),e.cameraVal=a.data[0].id,e.cameraOpt=a.data)}).catch(function(t){}))},clickHandle:function(){var t=this;this.$emit("startLoading","camera"),this.timeVal.length<=1&&(this.timeVal=[dateUnit.dateFormat(new Date,"yyyy-MM-dd")+" 00:00:00",dateUnit.dateFormat(new Date,"yyyy-MM-dd")+" 23:59:59"]),setTimeout(function(){var e={counttime_gte:t.timeVal[0],counttime_lte:t.timeVal[1],accountId:t.$cookie.get("accountId"),mallId:t.mallVal,age_gt:t.isEffect?0:null,channelId:t.cameraVal?t.cameraVal:null,gateId:t.monitoryVal?t.monitoryVal:null,personType:t.typeVal?t.typeVal:null,direction:1,page:1,pageSize:t.pageLimit,sortName:"counttime",sortOrder:"DESC"};t.Params="&counttime_gte="+t.timeVal[0]+"&counttime_lte="+t.timeVal[1]+"&accountId="+t.$cookie.get("accountId")+"&mallId="+t.mallVal,t.cameraVal&&(t.Params=t.Params+"&channelId="+t.cameraVal),t.monitoryVal&&(t.Params=t.Params+"&gateId="+t.monitoryVal),t.typeVal&&(t.Params=t.Params+"&personType="+t.typeVal),t.Params=t.Params+"&direction=1&page=1&pageSize="+t.pageLimit+"&sortName=counttime&sortOrder=DESC";var a=(t.mallName?t.mallName+"-":t.mallName)+t.monitoryName+" "+t.timeVal[0].split(" ")[0]+"至"+t.timeVal[1].split(" ")[0]+" ";t.$emit("emitTitle",a),t.$emit("emitParams",e)},1e3)},searchHandle:function(t,e){var a=this,i=e||this.pageLimit,o=t||1,n={counttime_gte:this.timeVal[0],counttime_lte:this.timeVal[1],mallId:this.mallVal,channelId:this.cameraVal?this.cameraVal:null,gateId:this.monitoryVal?this.monitoryVal:null,personType:this.typeVal?this.typeVal:null,direction:1,page:o,pageSize:i,sortName:"counttime",sortOrder:"DESC",_t:Date.parse(new Date)/1e3};this.axios.get("/faceRecognitions",{params:n}).then(function(t){var e=t.data;200==e.code?a.$emit("conditionData",e.data):a.$message({showClose:!0,type:"error",message:a.$t("message.captureFailed")+e.msg})}).catch(function(t){})},resetRefresh:function(){this.timeVal=[dateUnit.dateFormat(new Date,"yyyy-MM-dd")+" 00:00:00",dateUnit.dateFormat(new Date,"yyyy-MM-dd")+" 23:59:59"]},uploadData:function(){var t=localStorage.getItem("lang");if(t){t="&localLanguage="+{mall_cn:"zh_CN",zh_CN:"zh_CN",en_US:"en_US",zh_TW:"zh_TW"}[t]}var e=window.apiUrl+"/faceRecognitions/excel?"+this.Params+t;window.open(e)}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"behavior-more-option behavior-test-option"},[a("div",{staticClass:"opt-left"},[a("div",{staticClass:"test-opt-mall test-camera"},[a("el-select",{staticClass:"mall-opt",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect")},on:{change:t.chooseMall},model:{value:t.mallVal,callback:function(e){t.mallVal=e},expression:"mallVal"}},t._l(t.mallOpt,function(t,e){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("div",{staticClass:"test-opt-monitory test-camera"},[a("el-select",{staticClass:"monitory-opt",attrs:{filterable:"",placeholder:t.$t("pholder.site")},on:{change:t.chooseMonitory},model:{value:t.monitoryVal,callback:function(e){t.monitoryVal=e},expression:"monitoryVal"}},t._l(t.monitoryOpt,function(t,e){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),""!==t.monitoryVal?a("div",{staticClass:"test-opt-camera test-camera"},[a("el-select",{attrs:{filterable:"",placeholder:t.$t("pholder.camera")},model:{value:t.cameraVal,callback:function(e){t.cameraVal=e},expression:"cameraVal"}},t._l(t.cameraOpt,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1):t._e(),t._v(" "),a("div",{staticClass:"test-opt-type"},[a("el-select",{attrs:{filterable:"",placeholder:t.$t("pholder.type")},model:{value:t.typeVal,callback:function(e){t.typeVal=e},expression:"typeVal"}},[a("el-option",{attrs:{label:t.$t("pholder.allType"),value:""}},[t._v(t._s(t.$t("pholder.allType")))]),t._v(" "),a("el-option",{attrs:{label:t.$t("dictionary.staff"),value:"1"}},[t._v(t._s(t.$t("dictionary.staff")))]),t._v(" "),a("el-option",{attrs:{label:t.$t("dictionary.custom"),value:"0"}},[t._v(t._s(t.$t("dictionary.custom")))])],1)],1),t._v(" "),a("div",{staticClass:"test-opt-time mr20"},[a("el-date-picker",{staticClass:"time-opt",attrs:{type:"datetimerange","picker-options":t.pickerOptions1,format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":t.$t("pholder.startDate"),"end-placeholder":t.$t("pholder.endDate")},on:{change:t.clickHandle},model:{value:t.timeVal,callback:function(e){t.timeVal=e},expression:"timeVal"}})],1),t._v(" "),a("div",{staticClass:"test-opt-type test-opt-effect"},[a("el-checkbox",{model:{value:t.isEffect,callback:function(e){t.isEffect=e},expression:"isEffect"}},[t._v(t._s(t.$t("Behavior.isEffTra")))])],1)]),t._v(" "),a("div",{staticClass:"opt-right"},[a("el-button",{staticClass:"primary-btn behavior-collapse-btn",attrs:{type:"primary",size:"samll"},on:{click:t.clickHandle}},[t._v(t._s(t.$t("button.confirm")))]),t._v(" "),a("el-button",{staticClass:"primary-btn behavior-collapse-btn",attrs:{type:"primary",size:"samll"},on:{click:t.uploadData}},[t._v(t._s(t.$t("button.load")))])],1)])},staticRenderFns:[]},n=a("VU/8")(i,o,!1,function(t){a("yGCa")},"data-v-4b4f9f5c",null);e.a=n.exports},kZcA:function(t,e,a){"use strict";(function(t){var i=a("05Xd"),o=a("3MSA"),n=a.n(o),l=a("QCPg"),s=a.n(l),r=a("bchz"),c=a.n(r);e.a={data:function(){return{moreOptVisible:!1,tableData:[],currentPage:1,pageArr:[45,90,135],pageSize:45,totalPage:0,repTitle:"",loading:!0,tableHeight:0,emitData:{},shotList:[]}},components:{"test-option":i.a},created:function(){var t=this;this.tableHeight=this.computedWinH("px"),window.addEventListener("resize",function(){t.tableHeight=t.computedWinH("px"),t.moreOptVisible=!1,t.showCollapse()})},mounted:function(){this.showCollapse()},methods:{showCollapse:function(){var e=this,a="",i="",o="",n="";a=this.getStyleFn(".el-header","height"),i=this.getStyleFn(".camera-wrapper .el-header","height"),this.moreOptVisible?(n=a+i+8+"px",t(".behavior-main").animate({marginTop:n}),this.moreOptVisible=!1):(this.moreOptVisible=!0,setTimeout(function(){o=document.documentMode?(o=e.getStyleFn(".behavior-more-option","height"))+e.getStyleFn(".behavior-more-option","paddingTop")+e.getStyleFn(".behavior-more-option","paddingBottom"):e.getStyleFn(".behavior-more-option","height"),n=a+i+o+8+"px",t(".behavior-main").animate({marginTop:n})},100))},getTableData:function(){var t=this;this.axios.get("/faceRecognitions",{params:this.emitData}).then(function(e){var a=e.data;200==a.code?(t.tableData=[],t.totalPage=a.data.total,a.data.list.forEach(function(e,a){var i=e.counttime.split(" ")[0],o=i.split("-")[0]+i.split("-")[1]+i.split("-")[2];e.facePic?e.pic="/face/"+o+"/"+e.channelSerialnum+"/"+e.facePic:e.bodyPic&&(e.pic="/body/"+o+"/"+e.channelSerialnum+"/"+e.bodyPic),t.tableData.push({seriesNum:++a,age:"null"!==e.age&&e.age>=0?e.age:t.$t("dictionary.unknow"),gender:"null"!==e.gender&&t.getLocalDic("gender",e.gender)?t.getLocalDic("gender",e.gender):"--",mood:"null"!==e.mood?t.getLocalDic("mood",e.mood)?t.getLocalDic("mood",e.mood):t.$t("dictionary.unknow"):"--",counttime:"null"!==e.counttime?e.counttime:"--",facePic:e.pic?e.pic:"0",personType:(e.personType||0==e.personType)&&t.getLocalDic("mood",e.personType)?t.getLocalDic("personType",e.personType):t.$t("dictionary.custom")})}),setTimeout(function(){t.loading=!1},1e3)):t.$message({showClose:!0,type:"error",message:t.$t("message.captureFailed")+a.msg})}).catch(function(t){})},dealImg:function(t){return"store"==this.$Project&&10==this.$cookie.get("accountId")?"男"==t.gender||"Male"==t.gender?c.a:"女"==t.gender||"Female"==t.gender?s.a:n.a:"0"===t.facePic?n.a:window.picUrl+t.facePic},dealErrImg:function(t){(t||window.event).target.src=n.a},getLocalDic:function(t,e){return window.sessionStorage.getItem(t+"-"+e)?this.$t("dictionary."+window.sessionStorage.getItem(t+"-"+e)):e},handleSizeChange:function(t){this.emitData.pageSize=t,this.pageSize=t,this.loading=!0,this.getTableData()},handleCurrentChange:function(t){this.currentPage,this.emitData.page=t,this.currentPage=t,this.loading=!0,this.getTableData()},changeCurpage:function(t,e){this.currentPage=t},sizeChange:function(t){this.pageSize=t,this.emitData.pageSize=t,this.loading=!0,this.getTableData()},getTitle:function(t){this.repTitle=t},startLoad:function(t){"camera"===t&&(this.loading=!0)},getPatams:function(t){this.pageSize=t.pageSize,this.currentPage=t.page,this.emitData=t,this.getTableData()}}}}).call(e,a("7t+N"))},nup2:function(t,e){},yGCa:function(t,e){}});