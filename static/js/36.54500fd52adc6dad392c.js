webpackJsonp([36],{"1LJF":function(t,a,e){"use strict";(function(t){var i=e("pJt5"),l=e("NV49"),s=e("3MSA"),n=e.n(s),o=e("DQZ8"),r=e("064L");a.a={data:function(){return{moreOptVisible:!1,tableData:[],defaultImg:n.a,currentPage:1,pageArr:[10,50,100],pageSize:10,totalPage:null,repTitle:"",loading:!0,tableHeight:0,zfDetailHead:[],zfDetailOps:[],zfDetailTitle:"",zfAgeOps:[],zfAgeTitle:"",zfGenderOps:[],zfGenderTitle:"",tableKeyToId:{},tableIds:"",emitData:{}}},components:{"test-option":l.a,"common-tab":o.a,"common-chart":r.a,"export-data-dialog":i.a},created:function(){var a=this;window.addEventListener("resize",function(){try{var e={chart1:t("#areaChart")[0],chart2:t("#areaAgeChart")[0]};for(var i in e)if(e.hasOwnProperty(i)&&void 0!=e[i]){e[i]=a.$echarts.init(e[i]);e[i].resize()}}catch(t){}})},methods:{showCollapse:function(){var a=this,e="",i="",l="",s="";e=this.getStyleFn(".el-header","height"),i=this.getStyleFn(".customgroup-wrapper .el-header","height"),this.moreOptVisible?(this.moreOptVisible=!1,s=e+i+8+"px",t(".behavior-main").animate({marginTop:s})):(this.moreOptVisible=!0,setTimeout(function(){l=a.getStyleFn(".behavior-more-option","height"),s=e+i+l+8+"px",t(".behavior-main").animate({marginTop:s})},100))},getTableId:function(){var t=this;this.tableKeyToId={},this.tableIds="",this.axios.get("/reportCharts",{params:{report:"trafficAnalyze",_t:Date.parse(new Date)/1e3}}).then(function(a){var e=a.data.data;e.forEach(function(a,i){t.tableKeyToId[a.key]=a.id,i==e.length-1?t.tableIds+=a.id:t.tableIds+=a.id+","}),t.getTableData(t.tableIds)})},getTableData:function(t){var a=this;if(t){var e="",i={};e="/report/trafficAnalyze/zone",i={orgIds:this.emitData.orgIds,startDate:this.emitData.startDate,endDate:this.emitData.endDate,chartIds:this.tableIds,_t:Date.parse(new Date)/1e3},this.axios.get(e,{params:i}).then(function(t){setTimeout(function(){a.loading=!1},500);var e=t.data,i=e.data.body.faceZoneTrafficDetail.xaxis.data;a.zfDetailHead=a.autoComplateHead(i),a.zfDetailTitle="faceZoneTrafficDetail";var l=e.data.body.faceZoneTrafficDetail.series;a.zfDetailOps=a.dealData(l,a.zfDetailHead);var s=e.data.body.faceZoneGenderRatio;s.color=["#3BB8FF","#FFC62E","#6e6fc1"],a.zfGenderOps=s,a.zfGenderTitle="faceZoneGenderRatio";var n=e.data.body.faceZoneAgeRatio;n.color=["#6e6fc1","#33bafe","#fec62b","#ff9c01","#38d4be","#79ce4c"],a.zfAgeOps=n,a.zfAgeTitle="faceZoneAgeRatio"}).catch(function(t){console.log("areagroup err:",t.message,t)})}},startLoad:function(t){"areagroup"===t&&(this.zfDetailHead=[],this.zfDetailTitle="faceZoneTrafficDetail",this.zfDetailOps=[],this.zfGenderOps={},this.zfGenderTitle="faceZoneGenderRatio",this.zfAgeOps={},this.zfAgeTitle="faceZoneAgeRatio")},getPatams:function(t){this.emitData=t,this.repTitle=t.title,this.tableIds?this.getTableData(this.tableIds):this.getTableId()},getTitle:function(t){this.repTitle=t},autoComplateHead:function(t){var a=[];return t.forEach(function(t,e){a.push({prop:"defaultOrg"+e,label:t})}),a},dealData:function(t,a){var e={},i=[],l="";return t.forEach(function(t){if(t.data.length<a.length){for(var s=0,n=t.data.length;s<n;s++)l=a[s].prop,e[l]=t.data[s]||0==t.data[s]?t.data[s]:"--";for(var o=t.data.length;o<a.length;o++)l=a[o].prop,e[l]="--"}else for(var r=0,c=t.data.length;r<c;r++)l=a[r].prop,e[l]=t.data[r]||0==t.data[r]?t.data[r]:"--";i.push(e),e={}}),i},exportDataHandle:function(t,a,e){var i=this.chartKeyToId[e],l={domId:t,title:a,data:{url:window.apiUrl+"/report/trafficAnalyze/zone/"+i+"/excel",params:"orgIds="+this.emitData.orgIds+"&startDate="+this.emitData.startDate+"&endDate="+this.emitData.endDate}};this.$refs.exportDialog.dialogInit(l)}}}}).call(a,e("7t+N"))},8104:function(t,a){},Ky7s:function(t,a){},NV49:function(t,a,e){"use strict";var i={data:function(){return{date1:"",pickerOptions1:{disabledDate:function(t){return t.getTime()>Date.now()}},mallName:"",mallVal:"",mallOpt:[],zoneOpt:[],zoneVal:[],zoneName:"",typeVal:"",timeVal:[],account_id:"",all_id:[],isAll:!1,isSingle:!1,arr:[],idArr:[],isSelAll:!1}},created:function(){this.timeVal=[dateUnit.dateFormat(new Date,"yyyy-MM-dd"),dateUnit.dateFormat(new Date,"yyyy-MM-dd")],this.account_id=this.$cookie.get("accountId")},mounted:function(){this.getMallList()},methods:{getMallList:function(){var t=this;this.mallOpt=[],this.mallVal="",this.mallName="",this.axios.get("/malls",{params:{accountId:this.account_id,status:1,_t:Date.parse(new Date)/1e3}}).then(function(a){var e=a.data.data;e.length>0&&(t.mallOpt=e,t.mallVal=e[0].id,t.mallName=e[0].name,t.getGates(t.mallVal),t.clickHandle())}).catch(function(t){})},chooseMall:function(){var t=this;this.mallOpt.forEach(function(a){a.id==t.mallVal&&(t.mallName=a.name+"-")}),this.getZones(this.mallVal)},getZones:function(t){var a=this;this.zoneOpt=[],this.zoneVal=[],this.zoneName="",this.isSelAll=!1,this.axios.get("/zones",{params:{mallId:t,sortName:'"floor".name, "zone".name',_t:Date.parse(new Date)/1e3}}).then(function(t){var e=t.data.data;e.length&&(a.len=e.length,a.zoneOpt=e,a.zoneVal.length==a.zoneOpt.length&&(a.isSelAll=!0),a.arr=[e[0].id],a.zoneVal.push(e[0].id),a.zoneName=e[0].name+" ")}).catch(function(t){})},getGates:function(t){var a=this;this.monitoryOpt=[],this.monitoryVal=[],this.monitoryName="",this.isSelAll=!1,this.axios.get("/gates",{params:{mallId:t,isHasFace:1,_t:Date.parse(new Date)/1e3}}).then(function(t){var e=t.data.data;e.length&&(a.len=e.length,a.monitoryOpt=e,a.monitoryVal.length==a.monitoryOpt.length&&(a.isSelAll=!0),a.arr=[e[0].id],a.monitoryVal.push(e[0].id),a.monitoryName=e[0].name+" ")}).catch(function(t){})},chooseMonitory:function(){var t=this;this.isSelAll=(this.isSelAll,!(this.zoneVal.length<this.zoneOpt.length)),this.zoneName="",this.zoneVal.length>0&&this.zoneOpt.forEach(function(a){return a.id==t.zoneVal[0]&&(t.zoneName=a.name+" "),!1})},selAllHandle:function(){var t=this;this.isSelAll?(this.isSelAll=!1,this.zoneVal.length==this.zoneOpt.length&&(this.zoneVal=[])):(this.isSelAll=!0,this.zoneVal.length==this.zoneOpt.length?this.zoneVal=[]:(this.zoneVal=[],this.zoneOpt.forEach(function(a){t.zoneVal.push(a.id)})))},clickHandle:function(){var t=this;this.$emit("startLoading","areagroup");for(var a=0;a<this.zoneVal.length;a++)"all"!==this.zoneVal[a]&&this.idArr.push(this.zoneVal[a]);this.timeVal.length<=1&&(this.timeVal=[dateUnit.dateFormat(new Date,"yyyy-MM-dd"),dateUnit.dateFormat(new Date,"yyyy-MM-dd")]),setTimeout(function(){var a="";t.idArr.forEach(function(t,e,i){a+=t+","}),t.idArr=[],a=a.substring(0,a.length-1);new Date(Date.parse(new Date(t.timeVal))+864e5);var e=t.timeVal[0],i=t.timeVal[1],l={orgIds:a,startDate:e,endDate:i,title:t.mallName+t.zoneName+e+"è‡³"+i};t.$emit("emitParams",l)},1e3)}}},l={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"behavior-more-option behavior-test-option"},[e("div",{staticClass:"opt-left"},[e("div",{staticClass:"test-opt-mall"},[e("el-select",{staticClass:"mall-opt",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect")},on:{change:t.chooseMall},model:{value:t.mallVal,callback:function(a){t.mallVal=a},expression:"mallVal"}},t._l(t.mallOpt,function(t,a){return e("el-option",{key:t.value,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),e("div",{staticClass:"test-opt-monitory"},[e("el-select",{staticClass:"multipleClass mall-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.site"),multiple:"","collapse-tags":""},on:{change:t.chooseMonitory},model:{value:t.zoneVal,callback:function(a){t.zoneVal=a},expression:"zoneVal"}},[e("div",{class:t.isSelAll?"sel-all-box selected":"sel-all-box",on:{click:t.selAllHandle}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(t.$t("allPages.all")))])]),t._v(" "),t._l(t.zoneOpt,function(a,i){return e("el-option",{key:a.value,attrs:{label:a.name,value:a.id}},[e("span",{staticClass:"custom-checkbox__input"},[e("span",{staticClass:"custom-checkbox__inner"})]),t._v(" "),e("span",{staticStyle:{"padding-left":"5px"}},[t._v(t._s(a.name))])])})],2)],1),t._v(" "),e("div",{staticClass:"test-opt-time"},[e("el-date-picker",{staticClass:"time-opt",attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"daterange",size:"mini","picker-options":t.pickerOptions1,"range-separator":"-","start-placeholder":t.$t("table.startTime"),"end-placeholder":t.$t("table.endTime")},model:{value:t.timeVal,callback:function(a){t.timeVal=a},expression:"timeVal"}})],1)]),t._v(" "),e("div",{staticClass:"opt-right"},[e("el-button",{staticClass:"primary-btn behavior-collapse-btn",attrs:{type:"primary",size:"samll"},on:{click:t.clickHandle}},[t._v(t._s(t.$t("button.confirm")))])],1)])},staticRenderFns:[]},s=e("VU/8")(i,l,!1,function(t){e("Ky7s")},"data-v-662856b0",null);a.a=s.exports},VBzd:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("1LJF"),l={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"customgroup-wrapper"},[e("el-header",{attrs:{height:"70px"}},[e("span",{staticClass:"behavior-title"},[t._v(t._s(t.repTitle)+t._s(t.$t("Behavior.AreaGroup")))]),t._v(" "),e("span",{staticClass:"more-option-wrapper",on:{click:t.showCollapse}},[e("span",{staticClass:"more-option-text"},[t._v(t._s(t.$t("Behavior.moreOp")))]),t._v(" "),e("i",{class:t.moreOptVisible?"el-icon-arrow-down more-option-arrow":"el-icon-arrow-down more-option-arrow more-option-up"})])]),t._v(" "),e("test-option",{directives:[{name:"show",rawName:"v-show",value:t.moreOptVisible,expression:"moreOptVisible"}],ref:"searchRef",on:{emitParams:t.getPatams,startLoading:t.startLoad}}),t._v(" "),e("div",{staticClass:"element-main behavior-main"},[e("div",{staticClass:"asis-table-wrapper"},[e("h3",{staticClass:"asis-table-header"},[e("span",{staticClass:"asis-table-title"},[t._v(t._s(t.i18nFormatter(t.zfDetailTitle)))]),t._v(" "),e("span",{staticClass:"asis-table-download",on:{click:function(a){t.dealExport("domFeaDayCounting",t.i18nFormatter(t.zfDetailTitle))}}},[t._v(t._s(t.$t("allPages.load")))])]),t._v(" "),e("div",{staticClass:"asis-table-content"},[e("common-tab",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{tableData:t.zfDetailOps,id:"domFeaDayCounting",headData:t.zfDetailHead,tabHeight:""}})],1)]),t._v(" "),e("el-row",{staticClass:"chartRow",attrs:{gutter:12}},[e("el-col",{staticClass:"download-parent",attrs:{span:12}},[e("common-chart",{staticClass:"age-wrapper",attrs:{id:"areaChart",options:t.zfGenderOps,chartType:"horFgBar"}}),t._v(" "),e("span",{staticClass:"ehcarts-title"},[t._v(t._s(t.i18nFormatter(t.zfGenderTitle)))]),t._v(" "),e("span",{staticClass:"download-text",on:{click:function(a){t.exportDataHandle("areaChart",t.i18nFormatter(t.zfGenderTitle),"faceZoneGenderRatio")}}},[t._v(t._s(t.$t("allPages.load")))])],1),t._v(" "),e("el-col",{staticClass:"download-parent",attrs:{span:12}},[e("common-chart",{staticClass:"age-wrapper",attrs:{id:"areaAgeChart",options:t.zfAgeOps,chartType:"areaAge"}}),t._v(" "),e("span",{staticClass:"ehcarts-title"},[t._v(t._s(t.i18nFormatter(t.zfAgeTitle)))]),t._v(" "),e("span",{staticClass:"download-text",on:{click:function(a){t.exportDataHandle("areaAgeChart",t.i18nFormatter(t.zfAgeTitle),"faceZoneAgeRatio")}}},[t._v(t._s(t.$t("allPages.load")))])],1)],1)],1),t._v(" "),e("export-data-dialog",{ref:"exportDialog"})],1)},staticRenderFns:[]},s=function(t){e("8104")},n=e("VU/8")(i.a,l,!1,s,"data-v-d9c05fa0",null);a.default=n.exports}});