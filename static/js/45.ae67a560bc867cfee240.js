webpackJsonp([45],{"26hC":function(t,a){},KezT:function(t,a,e){"use strict";var i=e("mvHQ"),l=e.n(i),s={props:{mallData:Array},data:function(){return{pickerOptions1:{disabledDate:function(t){return t.getTime()>Date.now()}},tabItem:[],panelObj:{mallPanel:!1,floorPanel:!1,formatPanel:!1,ioPanel:!1,shopPanel:!1},time1Val:"",time2Val:"",mallVal:"",floorVal:"",formatVal:"",ioVal:"",zoneVal:"",asisLevel:"",kpiVal:"TRAFFIC",floorData:[],zoneData:[],formatData:[],ioData:[],paramId:"",gateVal:"",floorItem:"",zoneItem:"",floorList:[],zoneList:[],gateData:[],shopFloorData:[],shopFloorId:"",shopFloorVal:"",gateLevel:"all",gateLevelList:[{label:"all",value:"all"},{label:"mall",value:"mall"},{label:"floor",value:"floor"},{label:"store",value:"zone"}]}},created:function(){if(this.tabItem=[],"mall"===this.$Project){var t={mall:"mall",inOut:"io",floor:"floor",store:"shop"};for(var a in t)this.tabItem.push({label:a,value:t[a],className:"analysis-item"})}else this.tabItem=[{label:"mall",value:"mall",className:"analysis-item"},{label:"inOut",value:"io",className:"analysis-item"}]},methods:{i18nFormatter:function(t){var a="asisTab."+t;return this.$t(a)},getTime1:function(){},initAsis:function(t){this.paramId=t,this.mallVal=t,this.getFloorOpt(t),this.gateLevelChange(),this.tabClickHandle(0);var a=[this.time1Val,this.time2Val],e={asis_level:this.asisLevel,asis_time:a,asis_org:this.paramId,asis_kpi:this.kpiVal};this.$emit("initData",e)},tabClickHandle:function(t){if("analysis-item"===this.tabItem[t].className){this.tabItem.forEach(function(t){t.className="analysis-item"}),this.tabItem[t].className="analysis-item tabs-active";for(var a in this.panelObj)this.panelObj[a]=!1;switch(this.kpiVal="",this.asisLevel="",this.tabItem[t].value){case"mall":this.panelObj.mallPanel=!0,this.asisLevel="mall";break;case"floor":this.panelObj.floorPanel=!0,this.asisLevel="floor";break;case"format":this.panelObj.formatPanel=!0,this.asisLevel="format";break;case"io":this.panelObj.ioPanel=!0,this.asisLevel="gate";break;case"shop":this.panelObj.shopPanel=!0,this.asisLevel="zone"}}},gateLevelChange:function(){"all"===this.gateLevel?this.getAllGates():"mall"===this.gateLevel?this.getMallGates():"floor"===this.gateLevel?this.getFloorList():this.getZoneList()},getAllGates:function(){var t=this;this.gateData=[],this.gateVal="",this.axios.get("/gates",{params:{accountId:this.$cookie.get("accountId"),mallId:this.mallVal,_t:Date.parse(new Date)/1e3}}).then(function(a){if(a.data.data.length>0){var e=a.data.data;e.forEach(function(t){window.sessionStorage.setItem("gate-"+t.id,t.name)}),t.gateVal=e[0].id,t.gateData=e}})},getMallGates:function(){var t=this;this.gateData=[],this.gateVal="",this.axios.get("/gates",{params:{mallId:this.mallVal,isMallGate:1,_t:Date.parse(new Date)/1e3}}).then(function(a){if(a.data.data.length>0){var e=a.data.data;t.gateVal=e[0].id,t.gateData=e}})},getFloorList:function(){var t=this;this.gateData=[],this.gateVal="",this.floorItem="",this.floorList=[],this.axios.get("/floors",{params:{mallId:this.mallVal,_t:Date.parse(new Date)/1e3}}).then(function(a){if(a.data.data.length>0){var e=a.data.data;t.floorItem=e[0].id,t.getFloorGate(t.floorItem),t.floorList=e}})},getZoneList:function(){var t=this;this.gateData=[],this.gateVal="",this.zoneItem="",this.zoneList=[],this.axios.get("/zones",{params:{mallId:this.mallVal,sortName:'"floor".name, "zone".name',_t:Date.parse(new Date)/1e3}}).then(function(a){if(a.data.data.length>0){var e=a.data.data;t.zoneItem=e[0].id,t.getZoneGate(t.zoneItem),t.zoneList=e}})},levelFloorChange:function(){this.floorItem?this.getFloorGate(this.floorItem):(this.gateVal="",this.gateData=[])},getFloorGate:function(t){var a=this;this.gateData=[],this.gateVal="",this.axios.get("/floorGates",{params:{FloorId_arr:t,_t:Date.parse(new Date)/1e3}}).then(function(t){if(t.data.data.length>0){var e=t.data.data;e.forEach(function(t){t.id=t.gateId,t.name=window.sessionStorage.getItem("gate-"+t.gateId)}),a.gateVal=e[0].id,a.gateData=e}})},levelZoneChange:function(){this.zoneItem?this.getZoneGate(this.zoneItem):(this.gateVal="",this.gateData=[])},getZoneGate:function(t){var a=this;this.gateData=[],this.gateVal="",this.axios.get("/zoneGates",{params:{ZoneId_arr:t,_t:Date.parse(new Date)/1e3}}).then(function(t){if(t.data.data.length>0){var e=t.data.data;e.forEach(function(t){t.id=t.gateId,t.name=window.sessionStorage.getItem("gate-"+t.gateId)}),a.gateVal=e[0].id,a.gateData=e}})},getFloorOpt:function(t){var a=this;this.floorData=[],this.floorVal="",this.shopFloorData=[],this.shopFloorId="",this.shopFloorVal="",this.axios.get("/floors",{params:{mallId:t,accountId:this.$cookie.get("accountId"),status:1,_t:Date.parse(new Date)/1e3}}).then(function(e){if(e.data.data.length>0){var i=JSON.parse(l()(e.data.data));i.unshift({name:a.$t("asisTab.all"),id:""}),a.floorData=e.data.data,a.floorVal=e.data.data[0].id,a.shopFloorData=i,a.shopFloorId=i[0].id,a.shopFloorVal=i[0].id,a.getIoOpt(t,a.floorVal),a.getZoneOpt(t,a.shopFloorVal)}else a.getZoneOpt(t)}).catch(function(t){})},getZoneOpt:function(t,a){var e=this;this.zoneData=[],this.zoneVal="",this.axios.get("/zones",{params:{mallId:t,floorId:a,accountId:this.$cookie.get("accountId"),status:1,sortName:'"floor".name, "zone".name',_t:Date.parse(new Date)/1e3}}).then(function(t){t.data.data.length>0&&(e.zoneData=t.data.data,e.zoneVal=t.data.data[0].id)}).catch(function(t){})},getIoOpt:function(t,a){var e=this;this.axios.get("/gates",{params:{mallId:t,floorId:a,accountId:this.$cookie.get("accountId"),status:1,_t:Date.parse(new Date)/1e3}}).then(function(t){t.data.data.length>0&&(e.ioData=t.data.data,e.ioVal=t.data.data[0].id)}).catch(function(t){})},getFormatOpt:function(){var t=this;this.axios.get("/formats",{params:{_t:Date.parse(new Date)/1e3}}).then(function(a){a.data.data.length>0&&(t.formatData=a.data.data,t.formatVal=a.data.data[0].id)}).catch(function(t){})},mallChange:function(){this.getFloorOpt(this.mallVal)},gateMallChange:function(){this.gateLevel="all",this.gateLevelChange()},floorChange:function(){this.getZoneOpt(this.mallVal,this.shopFloorVal)},confirmCondition:function(){var t={asis_level:"",asis_time:"",asis_org:"",asis_kpi:"",asis_format:""};switch(this.asisLevel){case"mall":this.paramId=this.mallVal,t.asis_tit=this.getItemName(this.mallData,this.paramId);break;case"floor":this.paramId=this.floorVal,t.asis_tit=this.getItemName(this.mallData,this.mallVal)+"-"+this.getItemName(this.floorData,this.paramId);break;case"format":t.asis_format=this.formatVal,this.paramId=this.mallVal;break;case"gate":this.paramId=this.gateVal,t.asis_tit=this.getItemName(this.mallData,this.mallVal)+"-"+this.getItemName(this.gateData,this.paramId);break;case"zone":this.paramId=this.zoneVal,t.asis_tit=this.getItemName(this.mallData,this.mallVal)+"-"+this.getItemName(this.zoneData,this.paramId)}if(this.paramId){t.asis_level=this.asisLevel;var a=[this.time1Val,this.time2Val];t.asis_time=a,t.asis_org=this.paramId,t.asis_kpi=this.kpiVal,this.$emit("reportTime",t)}},getItemName:function(t,a){var e="",i=a.toString().split(",")[0];return t.forEach(function(t){t.id==i&&(e=t.name)}),e},resetRefresh:function(){this.tabClickHandle(0),this.mallVal=this.mallData[0].id,this.time1Val=[this.dayReduce(new Date,15),dateUnit.dateFormat(new Date,"yyyy-MM-dd")],this.time2Val=[this.dayReduce(new Date,30),this.dayReduce(new Date,15)]}},mounted:function(){this.time1Val=this.time1Val?this.time1Val:[this.dayReduce(new Date,15),dateUnit.dateFormat(new Date,"yyyy-MM-dd")],this.time2Val=this.time2Val?this.time2Val:[this.dayReduce(new Date,30),this.dayReduce(new Date,15)]}},o={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"analysis-option-wrapper"},[e("div",{staticClass:"analysis-level-wrapper"},[e("div",{staticClass:"analysis-level-left"},[e("i",{staticClass:"el-icon-search"}),t._v(" "),e("span",{staticClass:"analysis-level-text"},[t._v(t._s(t.$t("asisTab.level")))])]),t._v(" "),e("div",{staticClass:"analysis-level-right"},[e("ul",{staticClass:"analysis-type-box"},t._l(t.tabItem,function(a,i){return e("li",{key:a.value,class:a.className,on:{click:function(a){t.tabClickHandle(i)}}},[e("span",{staticClass:"analysis-item-title"},[t._v(t._s(t.i18nFormatter(a.label)))])])}))])]),t._v(" "),e("div",{staticClass:"panels-content"},[e("div",{staticClass:"panels-main-top"},[t.panelObj.mallPanel?e("ul",{staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.mallT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect")},on:{change:t.mallChange},model:{value:t.mallVal,callback:function(a){t.mallVal=a},expression:"mallVal"}},t._l(t.mallData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)])]):t._e(),t._v(" "),t.panelObj.floorPanel?e("ul",{staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.mallT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect")},on:{change:t.mallChange},model:{value:t.mallVal,callback:function(a){t.mallVal=a},expression:"mallVal"}},t._l(t.mallData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.floorT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"floor-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.floorSelect")},model:{value:t.floorVal,callback:function(a){t.floorVal=a},expression:"floorVal"}},t._l(t.floorData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)])]):t._e(),t._v(" "),t.panelObj.formatPanel?e("ul",{staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.mallT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect")},model:{value:t.mallVal,callback:function(a){t.mallVal=a},expression:"mallVal"}},t._l(t.mallData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.floorT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"floor-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.floorSelect")},model:{value:t.floorVal,callback:function(a){t.floorVal=a},expression:"floorVal"}},t._l(t.floorData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v("业态 :")]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"format-sel-box",attrs:{filterable:"",placeholder:"业态"},model:{value:t.formatVal,callback:function(a){t.formatVal=a},expression:"formatVal"}},t._l(t.formatData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)])]):t._e(),t._v(" "),t.panelObj.ioPanel?e("ul",{staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.mallT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect")},on:{change:t.gateMallChange},model:{value:t.mallVal,callback:function(a){t.mallVal=a},expression:"mallVal"}},t._l(t.mallData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),e("li",{staticClass:"condition-item gate-level-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.inOutLev")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"floor-sel-box",attrs:{placeholder:t.$t("pholder.gateLevel")},on:{change:t.gateLevelChange},model:{value:t.gateLevel,callback:function(a){t.gateLevel=a},expression:"gateLevel"}},t._l(t.gateLevelList,function(a){return e("el-option",{key:a.value,attrs:{label:t.$t("asisTab."+a.label),value:a.value}})})),t._v(" "),"floor"===t.gateLevel||"zone"===t.gateLevel?e("span",[t._v("-")]):t._e(),t._v(" "),"floor"===t.gateLevel?e("el-select",{staticClass:"floor-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.floorSelect")},on:{change:t.levelFloorChange},model:{value:t.floorItem,callback:function(a){t.floorItem=a},expression:"floorItem"}},t._l(t.floorList,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})):t._e(),t._v(" "),"zone"===t.gateLevel?e("el-select",{staticClass:"zone-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.zoneSelect")},on:{change:t.levelZoneChange},model:{value:t.zoneItem,callback:function(a){t.zoneItem=a},expression:"zoneItem"}},t._l(t.zoneList,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})):t._e()],1)]),t._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.inOutT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"format-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.gateType")},model:{value:t.gateVal,callback:function(a){t.gateVal=a},expression:"gateVal"}},t._l(t.gateData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)])]):t._e(),t._v(" "),t.panelObj.shopPanel?e("ul",{staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.mallT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"mall-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect")},on:{change:t.mallChange},model:{value:t.mallVal,callback:function(a){t.mallVal=a},expression:"mallVal"}},t._l(t.mallData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.floorT")))]),t._v(" "),e("div",{staticClass:"condition-item-option"},[e("el-select",{staticClass:"floor-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.floorSelect")},on:{change:t.floorChange},model:{value:t.shopFloorVal,callback:function(a){t.shopFloorVal=a},expression:"shopFloorVal"}},t._l(t.shopFloorData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.storeT")))]),t._v(" "),e("div",{staticClass:"condition-item-option  "},[e("el-select",{staticClass:"shop-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.areaSelect")},model:{value:t.zoneVal,callback:function(a){t.zoneVal=a},expression:"zoneVal"}},t._l(t.zoneData,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)])]):t._e()]),t._v(" "),e("div",{staticClass:"panels-main-bottom"},[e("ul",{staticClass:"condition-box"},[e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.timeA")))]),t._v(" "),e("div",{staticClass:"condition-item-option mleft-time"},[e("el-date-picker",{staticClass:"date-input analysis-date-input times-box",attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"daterange",size:"mini","range-separator":"-","picker-options":t.pickerOptions1,"start-placeholder":t.$t("table.startTime"),"end-placeholder":t.$t("table.endTime")},on:{change:t.getTime1},model:{value:t.time2Val,callback:function(a){t.time2Val=a},expression:"time2Val"}})],1)]),t._v(" "),e("li",{staticClass:"condition-item"},[e("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.timeB")))]),t._v(" "),e("div",{staticClass:"condition-item-option mleft-time"},[e("el-date-picker",{staticClass:"date-input analysis-date-input times-box",attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"daterange",size:"mini","picker-options":t.pickerOptions1,"range-separator":"-","start-placeholder":t.$t("table.startTime"),"end-placeholder":t.$t("table.endTime")},model:{value:t.time1Val,callback:function(a){t.time1Val=a},expression:"time1Val"}})],1)]),t._v(" "),e("li",{staticClass:"condition-item mleft-last"},[e("el-button",{staticClass:"primary-btn analysis-collapse-btn",attrs:{type:"primary",size:"samll"},on:{click:t.confirmCondition}},[t._v(t._s(t.$t("button.confirm")))]),t._v(" "),e("el-button",{staticClass:"reset-btn analysis-collapse-btn",attrs:{size:"samll"},on:{click:t.resetRefresh}},[t._v(t._s(t.$t("button.reset")))])],1)])])])])},staticRenderFns:[]},n=e("VU/8")(s,o,!1,function(t){e("o8KB")},"data-v-016af95f",null);a.a=n.exports},h64w:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("hehD"),l={render:function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"comt-analysis"},[a("el-header",{attrs:{height:"70px"}},[a("span",{staticClass:"asis-title"},[this._v(this._s(this.asisName)+" "+this._s(this.$t("asis.CompareTime")))]),this._v(" "),a("span",{staticClass:"more-option-wrapper",on:{click:this.showCollapse}},[a("span",{staticClass:"more-option-text"},[this._v(this._s(this.$t("asis.moreOp")))]),this._v(" "),a("i",{class:this.moreOptVisible?"el-icon-arrow-down more-option-arrow":"el-icon-arrow-down more-option-arrow more-option-up"})])]),this._v(" "),a("comt-option",{directives:[{name:"show",rawName:"v-show",value:this.moreOptVisible,expression:"moreOptVisible"}],ref:"init",attrs:{mallData:this.mallData},on:{reportTime:this.reportHandler,initData:this.initTab}}),this._v(" "),a("div",{staticClass:"element-main comt-main"},[a("router-view",{attrs:{propparam:this.propParams}})],1)],1)},staticRenderFns:[]},s=function(t){e("26hC")},o=e("VU/8")(i.a,l,!1,s,"data-v-52c9aeae",null);a.default=o.exports},hehD:function(t,a,e){"use strict";(function(t){var i=e("KezT");a.a={data:function(){return{moreOptVisible:!1,mallData:[],asisName:"",propParams:{}}},components:{"comt-option":i.a},created:function(){var a=this;window.addEventListener("resize",function(){try{var e={chart1:t("#overallChart")[0],chart2:t("#dimenChart")[0]};for(var i in e)if(e.hasOwnProperty(i)&&void 0!=e[i]){e[i]=a.$echarts.init(e[i]);e[i].resize()}}catch(t){}})},mounted:function(){this.getMallOpt()},methods:{showCollapse:function(){var a=this,e="",i="",l="",s="";e=this.getStyleFn(".el-header","height"),i=this.getStyleFn(".analysis-wrapper .el-header","height"),this.moreOptVisible?(this.moreOptVisible=!1,s=e+i+8+"px",t(".comt-main").animate({marginTop:s})):(this.moreOptVisible=!0,setTimeout(function(){l=a.getStyleFn(".analysis-option-wrapper","height"),s=e+i+l+8+"px",t(".comt-main").animate({marginTop:s})},100))},getMallOpt:function(){var t=this;this.axios.get("/malls",{params:{accountId:this.$cookie.get("accountId"),_t:Date.parse(new Date)/1e3}}).then(function(a){var e="",i=null,l=window.sessionStorage.getItem("mallId");l&&Number(l),a.data.data.length>=1&&(a.data.data.forEach(function(a,i){t.mallData.push(a),l&&a.id==l&&(e=a.name)}),t.asisName=e||a.data.data[0].name,i=l?Number(l):a.data.data[0].id,t.$refs.init.initAsis(i))})},initTab:function(t){this.$router.push("/analysis/comtasis/contrast"),this.propParams={dateType:"/comtasis/contrast",data:t}},reportHandler:function(t){this.$router.push("/analysis/comtasis/contrast"),this.asisName=t.asis_tit,this.propParams={dateType:"/comtasis/contrast",data:t}}}}}).call(a,e("7t+N"))},o8KB:function(t,a){}});