webpackJsonp([48],{B8cs:function(t,e,a){"use strict";(function(t){var i=a("mvHQ"),l=a.n(i),s=a("bOdI"),o=a.n(s);e.a={data:function(){var t;return t={datePickerOpt:{disabledDate:function(t){return t.getTime()>Date.now()}},yearTime:"",cancelBtnDisabled:!1,bindBtnDisabled:!1,bindVisible:!1,bindVal:"",gateList:[],curCheckGate:{},bindGateList:[],blocList:[],mallListForTerm:[],floorListForTerm:[],blocValue:"",mallValue:"",floorValue:"",tableHeight:0},o()(t,"bindVisible",!1),o()(t,"addDialogVisible",!1),o()(t,"editDialogVisible",!1),o()(t,"name_like",""),o()(t,"rowId",""),o()(t,"tableData",[]),o()(t,"total",0),o()(t,"pageSize",10),o()(t,"currentPage",1),o()(t,"formLabelWidth","80px"),o()(t,"start_date",""),o()(t,"end_date",""),o()(t,"addForm",{name:"",startDate:"",endDate:""}),o()(t,"editForm",{}),o()(t,"rules",{name:[{required:!0,message:"请输入节假日名称",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],floorId:[{required:!0,message:"请选择区域",trigger:"change"}]}),o()(t,"mallList",[]),o()(t,"accountList",[]),o()(t,"floorList",[]),o()(t,"noDataText","load"),o()(t,"childrenHeader",!1),o()(t,"zoneAllGate",[]),o()(t,"bindZoneId",""),t},created:function(){this.yearTime=new Date,this.tableHeight=t(window).height()-200,this.getAccountList()},methods:{timeFormat:function(t,e,a){var i="";return a&&(i=a.split(" ")[0]),i},endDateBlur:function(t){var e="",a="";if("addForm"===t?(e=this.addForm.start_date,a=this.addForm.end_date):(e=this.editForm.start_date,a=this.editForm.end_date),e&&a){if(!(Date.parse(a)>Date.parse(e)))return this.$message({showClose:!0,message:this.$t("message.timeIllegal"),type:"warning"}),void("addForm"===t?this.addForm.end_date="":this.editForm.end_date="")}},getTableData:function(){var t=this,e="",a="";if(this.yearTime.getFullYear()===(new Date).getFullYear())a=dateUnit.dateFormat(this.yearTime,"yyyy-MM-dd"),e=dateUnit.dateFormat(new Date(Date.parse(this.yearTime.getFullYear()+"/01/01")),"yyyy-MM-dd");else{e=this.yearTime,a=new Date(Date.parse(this.dayAdd(this.yearTime,365).replace(/\-/,"/")));var i=this.unitTime(e,a,"year");e=i.startTime,a=i.endTime}var l={mallId:this.mallValue?this.mallValue:null,startDate:e,endDate:a,page:this.currentPage,pageSize:this.pageSize,_t:Date.parse(new Date)/1e3};this.axios.get("/holidays",{params:l}).then(function(e){t.tableData=[];var a=e.data;a.data.list.forEach(function(t,e){t.tabOrder=++e,t.durationDay=(Date.parse(t.endDate.replace(/\-/,"/"))-Date.parse(t.startDate.replace(/\-/,"/")))/36e5/24+1}),t.tableData=a.data.list,t.total=a.data.total}).catch(function(t){})},sizeChange:function(t){this.pageSize=t,this.getTableData()},cerrentChange:function(t){this.currentPage!=t&&(this.currentPage=t,this.getTableData())},closeBindDialog:function(){this.gateList.forEach(function(t){t.isCheck=!1,t.className="gate-item"}),this.bindVal="",this.bindGateList.length=0,this.noDataText="load"},editRow:function(t){this.editDialogVisible=!0,this.rowId=t.id;var e=l()(t);this.editForm=JSON.parse(e)},delRow:function(t){var e=this;this.$confirm(this.$t("message.confirDelete"),this.$t("message.prompt"),{confirmButtonText:this.$t("message.confirm"),cancelButtonText:this.$t("message.cancel"),type:"warning"}).then(function(){e.axios.delete("/holidays/"+t.id,{params:{}}).then(function(t){200==t.data.code?(e.$message({showClose:!0,type:"success",message:e.$t("message.deleteSuccess")}),e.getTableData()):e.$message({showClose:!0,type:"warning",message:"删除异常!"+t.data.msg})}).catch(function(t){})}).catch(function(){e.$message({showClose:!0,type:"info",message:e.$t("message.cancelDelete")})})},addSubmit:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.axios.post("/holidays",e.addForm).then(function(t){e.addDialogVisible=!1,e.getTableData()}).catch(function(t){})})},editSubmit:function(t){var e=this,a={name:this.editForm.name,startDate:this.editForm.startDate,endDate:this.editForm.endDate,holidayDate:this.editForm.holidayDate,intro:this.editForm.intro};this.$refs[t].validate(function(t){if(!t)return!1;e.axios.post("/holidays/"+e.rowId,a).then(function(t){200==t.data.code?(e.editDialogVisible=!1,e.getTableData()):e.$message({showClose:!0,type:"warning",message:"修改异常!"+t.data.msg})}).catch(function(t){})})},searchFun:function(){this.currentPage=1,this.getTableData()},addDialogClose:function(){this.$refs.addForm.resetFields()},editDialogClose:function(){this.$refs.editForm.clearValidate(),this.editForm={}},dialogOpen:function(t){},changeAddAccount:function(t){this.getMallList(t)},changeEditAccount:function(t){this.editChangeGetMall(t)},changeAddMall:function(t){},changeEditMall:function(t){this.editChangeGetFloor(t)},dateFormatter:function(t,e,a){if(a.split(" "))return a.split(" ")[0]},typeFormatter:function(t,e,a){return 1==a?"店铺":2==a?"区":"主力店"},statusFormatter:function(t,e,a){return a=1==a?"正常":"停用"},getAccountList:function(){this.blocValue=this.$cookie.get("accountId"),this.getMallListForTerm(this.blocValue,!0)},getMallList:function(t){var e=this;this.axios.get("/malls",{params:{accountId:t,_t:Date.parse(new Date)/1e3}}).then(function(t){var a=t.data;e.mallList=a.data,e.mallList.length>0?e.addForm.mallId=e.mallList[0].id:(e.addForm.mallId="",e.floorList=[],e.addForm.floorId="")}).catch(function(t){})},blocChange:function(){this.getMallListForTerm(this.blocValue)},mallChange:function(){},getMallListForTerm:function(t,e){var a=this;this.axios.get("/malls",{params:{accountId:t,_t:Date.parse(new Date)/1e3}}).then(function(t){var i=t.data;a.mallListForTerm=[],a.mallValue="",a.mallListForTerm=i.data,a.mallListForTerm.forEach(function(t,e,i){0==e&&(a.mallValue=t.id)}),e&&a.getTableData()}).catch(function(t){})},editChangeGetMall:function(t){var e=this;this.axios.get("/malls",{params:{accountId:t,_t:Date.parse(new Date)/1e3}}).then(function(t){var a=t.data;e.mallList=a.data,e.mallList.length>0?e.editForm.mallId=e.mallList[0].id:(e.editForm.mallId="",e.floorList=[],e.editForm.floorId="")}).catch(function(t){})}}}}).call(e,a("7t+N"))},atN9:function(t,e){},qZZI:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("B8cs"),l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"manage-container"},[a("el-row",{staticClass:"manage-head-wrapper"},[a("el-col",{attrs:{span:18}},[a("span",{staticStyle:{float:"left","margin-right":"10px"}},[a("el-date-picker",{staticClass:"year-inp",attrs:{align:"right",type:"year",format:"yyyy 年",size:"mini",placeholder:t.$t("pholder.year"),"picker-options":t.datePickerOpt},model:{value:t.yearTime,callback:function(e){t.yearTime=e},expression:"yearTime"}})],1),t._v(" "),a("el-button",{staticClass:"search-btn",attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.searchFun}},[t._v("查询")])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-button",{staticClass:"manage-add-btn",attrs:{type:"primary",size:"mini",icon:"el-icon-circle-plus-outline"},on:{click:function(e){t.addDialogVisible=!0}}},[t._v("新增节假日")])],1)],1),t._v(" "),a("el-row",{staticClass:"manage-content"},[a("el-col",{attrs:{span:24}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"max-height":t.tableHeight,"header-row-class-name":"manage-tab-head"}},[a("el-table-column",{attrs:{prop:"tabOrder",align:"center",label:"序号",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"节假日名称",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"startDate",label:"开始日期",formatter:t.timeFormat,align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"endDate",label:"结束日期",formatter:t.timeFormat,align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"holidayDate",label:"节假日当天",formatter:t.timeFormat,align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"durationDay",label:"持续天数",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"intro",label:"描述",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"tab-btn",attrs:{type:"text",size:"small"},on:{click:function(a){t.editRow(e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{staticClass:"tab-btn",attrs:{type:"text",size:"small"},on:{click:function(a){t.delRow(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("el-pagination",{staticClass:"manage-pagination-box",attrs:{background:"","current-page":t.currentPage,"page-sizes":[10,20,50,100],"page-size":t.pageSize,layout:"sizes, prev, pager, next, slot",total:t.total},on:{"size-change":t.sizeChange,"current-change":t.cerrentChange}},[a("span",{staticClass:"slot-pagination-ele slot-ele-total"},[t._v(t._s(t.$t("table.pageHead"))+" "+t._s(t.total)+" "+t._s(t.$t("table.pageTail")))])])],1)],1),t._v(" "),a("el-dialog",{staticClass:"manage-dialog",attrs:{title:"新增节假日",visible:t.addDialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.addDialogVisible=e},close:function(e){t.addDialogClose()},open:function(e){t.dialogOpen(t.addForm)}}},[a("el-form",{ref:"addForm",attrs:{model:t.addForm,"status-icon":"",rules:t.rules}},[a("el-form-item",{attrs:{prop:"name",label:"名称"}},[a("el-input",{model:{value:t.addForm.name,callback:function(e){t.$set(t.addForm,"name",e)},expression:"addForm.name"}}),t._v(" "),a("i",{staticClass:"error-tip"},[t._v("*")])],1),t._v(" "),a("el-form-item",{attrs:{label:"起止日期"}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{staticClass:"spe-form-item",attrs:{prop:"startDate"}},[a("el-date-picker",{staticClass:"manage-date-inp",attrs:{format:"MM 月 dd 日",type:"date",size:"mini","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:t.$t("table.startTime")},model:{value:t.addForm.startDate,callback:function(e){t.$set(t.addForm,"startDate",e)},expression:"addForm.startDate"}})],1)],1),t._v(" "),a("el-col",{staticClass:"line",staticStyle:{"text-align":"center"},attrs:{span:2}},[t._v("-")]),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{staticClass:"spe-form-item",attrs:{prop:"endDate"}},[a("el-date-picker",{staticClass:"manage-date-inp",attrs:{format:"MM 月 dd 日",type:"date",size:"mini","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:t.$t("table.endTime")},on:{blur:function(e){t.endDateBlur("addForm")}},model:{value:t.addForm.endDate,callback:function(e){t.$set(t.addForm,"endDate",e)},expression:"addForm.endDate"}})],1)],1),t._v(" "),a("i",{staticClass:"error-tip"},[t._v("*")])],1),t._v(" "),a("el-form-item",{attrs:{prop:"holidayDate",label:"节日当天"}},[a("el-date-picker",{staticClass:"manage-date-inp",attrs:{format:"yyyy-MM-dd",type:"date",size:"mini","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"节日当天"},model:{value:t.addForm.holidayDate,callback:function(e){t.$set(t.addForm,"holidayDate",e)},expression:"addForm.holidayDate"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"intro",label:"描述"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.addForm.intro,callback:function(e){t.$set(t.addForm,"intro",e)},expression:"addForm.intro"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"dialog-btn",on:{click:function(e){t.addDialogVisible=!1}}},[t._v(t._s(t.$t("dialog.cancel")))]),t._v(" "),a("el-button",{staticClass:"dialog-btn dialog-confirm-btn",attrs:{type:"primary"},on:{click:function(e){t.addSubmit("addForm")}}},[t._v(t._s(t.$t("dialog.confirm")))])],1)],1),t._v(" "),a("el-dialog",{staticClass:"manage-dialog",attrs:{title:"编辑节假日",visible:t.editDialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.editDialogVisible=e},close:function(e){t.editDialogClose()},open:function(e){t.dialogOpen(t.editForm)}}},[a("el-form",{ref:"editForm",attrs:{model:t.editForm,"status-icon":"",rules:t.rules}},[a("el-form-item",{attrs:{prop:"name",label:"名称"}},[a("el-input",{model:{value:t.editForm.name,callback:function(e){t.$set(t.editForm,"name",e)},expression:"editForm.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"起止日期"}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{staticClass:"spe-form-item"},[a("el-date-picker",{staticClass:"manage-date-inp",attrs:{format:"MM 月 dd 日",type:"date",size:"mini","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:t.$t("table.startTime")},model:{value:t.editForm.startDate,callback:function(e){t.$set(t.editForm,"startDate",e)},expression:"editForm.startDate"}})],1)],1),t._v(" "),a("el-col",{staticClass:"line",staticStyle:{"text-align":"center"},attrs:{span:2}},[t._v("-")]),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{staticClass:"spe-form-item"},[a("el-date-picker",{staticClass:"manage-date-inp",attrs:{format:"MM 月 dd 日",type:"date",size:"mini","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:t.$t("table.endTime")},on:{blur:function(e){t.endDateBlur("editForm")}},model:{value:t.editForm.endDate,callback:function(e){t.$set(t.editForm,"endDate",e)},expression:"editForm.endDate"}})],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"节日当天"}},[a("el-date-picker",{staticClass:"manage-date-inp",attrs:{format:"yyyy-MM-dd",type:"date",size:"mini","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"节日当天"},model:{value:t.editForm.holidayDate,callback:function(e){t.$set(t.editForm,"holidayDate",e)},expression:"editForm.holidayDate"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.editForm.intro,callback:function(e){t.$set(t.editForm,"intro",e)},expression:"editForm.intro"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"dialog-btn",on:{click:function(e){t.editDialogVisible=!1}}},[t._v(t._s(t.$t("dialog.cancel")))]),t._v(" "),a("el-button",{staticClass:"dialog-btn dialog-confirm-btn",attrs:{type:"primary"},on:{click:function(e){t.editSubmit("editForm")}}},[t._v(t._s(t.$t("dialog.confirm")))])],1)],1)],1)},staticRenderFns:[]},s=function(t){a("atN9")},o=a("VU/8")(i.a,l,!1,s,"data-v-5c7b3efe",null);e.default=o.exports}});