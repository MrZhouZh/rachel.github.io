webpackJsonp([5],{EMH6:function(a,t,i){"use strict";(function(a){var e=i("PAnj"),o=i.n(e);t.a={props:{propparam:Object},data:function(){return{floorPlanUrl:window.apiUrl+"/floors/img/",floorSrc:"",loading:!0,trafficFlowLoading:!0,kpiData_head:[],trafficHour_head:[{label:"时间段",prop:"periodTime"}],traffic10Min_head:[{label:"时间段",prop:"periodTime"}],trafficFlow_head:[],trafficFlow_title:"",kpiData_title:"",trafficHour_title:"",traffic10Min_title:"",kpiData_ops:[],trafficHour_ops:[],traffic10Min_ops:[],trafficFlow_ops:[],tableKeyToId:{},tableIds:"",emitData:[],radioDate:"小时级",rowLen:Number,naturalWidth:0,naturalHeight:0,firstFlag:!0,orgids:"",starttime:"",endtime:""}},computed:{},components:{},watch:{propparam:{handler:"refreshHandle",immediate:!0}},mounted:function(){},methods:{refreshHandle:function(t){if("/trafficeline/daily"===t.dateType){this.loading=!0,this.emitData=t.data,console.log("params",t),t.data.asis_img?this.floorSrc=this.floorPlanUrl+t.data.asis_img:this.floorSrc=o.a,this.orgids=2,this.starttime=t.data.asis_time[0],this.endtime=t.data.asis_time[1];var i=new Image;i.src=this.floorSrc;var e=this;i.onload=function(){e.naturalWidth=i.width,e.naturalHeight=i.height,a("#graphChart").height(a(".background-floorimg").height()),e.getLinkData()}}},getLinkData:function(){var t=this;this.axios.get("/report/movingLine/floor",{params:{orgIds:this.orgids,startDate:this.starttime,endDate:this.endtime,_t:Date.parse(new Date)/1e3}}).then(function(i){if(void 0===i.data.data.node||void 0===i.data.data.line)return t.loading=!1,void console.log("node link not exist!");var e=[],o=[],r=999999999,n=0,l=!1;i.data.data.node.forEach(function(a,t){a.innum||(l=!0),0!=a.innum&&a.innum<r&&(r=a.innum),0!=a.innum&&a.innum>n&&(n=a.innum)}),i.data.data.node.forEach(function(i,s){var d=n==r?10:parseInt(10+(i.innum-r)/(n-r)*90),c=(i.x/t.normalWidth*a(".background-floorimg").width()).toFixed(2),h=(i.y/t.normalHeight*a(".background-floorimg").height()).toFixed(2),u={id:String(i.zondId),name:i.zoneName,value:i.innum,x:c>a(".background-floorimg").width()?0:c,y:h>a(".background-floorimg").height()?0:h,symbolSize:l?0:d,category:s};e.push(u),o.push({name:i.zoneName})}),e.push({id:-1,name:"22",value:-1,x:0,y:0,symbolSize:0,label:{show:!1}},{id:-2,name:"11",value:-1,x:a(".background-floorimg").width(),y:a(".background-floorimg").height(),symbolSize:0,label:{show:!1}});var s=[],d=999999999999,c=0,h=null;i.data.data.line.forEach(function(a){s.push({target:String(a.target),source:String(a.source),value:a.value}),0!=a.value&&a.value<d&&(d=a.value),0!=a.value&&a.value>c&&(c=a.value)}),s.forEach(function(a,t){h=(h=1+(a.value-d)/(c-d)*14)<0?0:h,a.lineStyle={normal:{width:l?0:h}},a.symbolSize=l?0:2*h});var u={},f=document.getElementById("graphChart");f.style.width=a(".background-floorimg").width()+"px",t.$echarts.getInstanceByDom(f)?(t.$echarts.init(f).dispose(),u=t.$echarts.init(f)):u=t.$echarts.init(f);var g={tooltip:{},legend:{type:"plain",icon:"circle",top:0,data:o.map(function(a){return a.name})},series:[{top:0,left:0,right:0,bottom:1,edgeSymbol:["none","arrow"],categories:o,type:"graph",layout:"none",data:e,links:s,edgeSymbolSize:0,label:{normal:{show:!l,position:"right",formatter:"{b}:{c}"}},lineStyle:{normal:{color:"source",curveness:.3}}}]};t.firstFlag||u.clear(),t.firstFlag=!1,u.clear(),u.setOption(g),setTimeout(function(){t.loading=!1},1e3)})}}}}).call(t,i("7t+N"))},"SEv/":function(a,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=i("EMH6"),o={render:function(){var a=this.$createElement,t=this._self._c||a;return t("div",{staticClass:"daily"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:this.loading,expression:"loading"}],staticClass:"graph-container"},[t("div",{staticClass:"graph-rel"},[t("img",{staticClass:"background-floorimg",attrs:{src:this.floorSrc,alt:""}}),this._v(" "),t("div",{staticClass:"graph-box",attrs:{id:"graphChart"}})])])])},staticRenderFns:[]},r=function(a){i("odbr")},n=i("VU/8")(e.a,o,!1,r,"data-v-24cdedf3",null);t.default=n.exports},odbr:function(a,t){}});