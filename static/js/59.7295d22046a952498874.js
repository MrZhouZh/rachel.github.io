webpackJsonp([59],{"2AuT":function(a,t,e){"use strict";(function(a){var i=e("mvHQ"),r=e.n(i),o=e("DQZ8");t.a={props:{propparam:Object},data:function(){return{loading:!0,trafficFlowLoading:!0,kpiData_head:[],trafficHour_head:[{label:"时间段",prop:"periodTime"}],traffic10Min_head:[{label:"时间段",prop:"periodTime"}],trafficFlow_head:[],trafficFlow_title:"",kpiData_title:"",trafficHour_title:"",traffic10Min_title:"",kpiData_ops:[],trafficHour_ops:[],traffic10Min_ops:[],trafficFlow_ops:[],tableKeyToId:{},tableIds:"",emitData:{},radioDate:"kpiData",rowLen:Number,tableHeight:0,isTabChart:!0}},computed:{tableData:function(){if("kpiData"!=this.radioDate){var a={},t={},e=0;if(this.trafficFlow_ops.length){for(var i in this.trafficFlow_ops[0])"defaultOrg0"==i?a[i]=this.$t("table.total"):a[i]?a[i]+=item[i]:a[i]=0;this.trafficFlow_ops.map(function(t,i){e+=1;for(var r in t)isNaN(Number(a[r]))||isNaN(Number(t[r]))||(a[r]+=Number(Math.round(100*t[r])/100))});for(var r in a)t[r]="defaultOrg0"==r?this.$t("table.average"):Number(Math.round(a[r]/e*100)/100);this.trafficFlow_ops.push(t),this.trafficFlow_ops.push(a)}}return this.trafficFlow_ops}},components:{"common-tab":o.a},watch:{propparam:{handler:"refreshHandle",immediate:!0}},created:function(){var t=a(window).height(),e=.28;t<=720?e=.35:t<=768?e=.33:t<=900?e=.28:t<=1080&&(e=.31),this.tableHeight=t-t*e},mounted:function(){},methods:{refreshHandle:function(a){"/baseasis/daily"===a.dateType&&(this.radioDate="kpiData"!==this.radioDate?this.radioDate:"kpiData",this.emitData=a.data,this.loading=!0,this.trafficFlowLoading=!0,this.tableIds&&"{}"!==r()(this.tableKeyToId)?(this.tableIds=this.tableKeyToId[this.radioDate],this.getTableData(this.tableIds)):this.getTableId())},getTableId:function(){var a=this;this.tableKeyToId={},this.tableIds="",this.axios.get("/reportCharts",{params:{report:"BasicDayReport",_t:Date.parse(new Date)/1e3}}).then(function(t){var e=t.data.data;e.forEach(function(t,i){a.tableKeyToId[t.key]=t.id,"kpiData"!==t.key&&"trafficHour"!==t.key&&"traffic10Min"!==t.key||(i==e.length-1?a.tableIds+=t.id:a.tableIds+=t.id+",")}),a.getTableData(a.tableIds)})},getTableData:function(a){var t=this;if(a){this.rowLen=null,this.kpiData_ops=[],this.trafficHour_ops=[],this.traffic10Min_ops=[],this.trafficFlow_ops=[];var e="",i={},r="",o=[],s=[];r=this.emitData.asis_time?"string"==typeof this.emitData.asis_time?this.emitData.asis_time:dateUnit.dateFormat(this.emitData.asis_time,"yyyy-MM-dd"):dateUnit.dateFormat(new Date,"yyyy-MM-dd"),e="/report/basics/day/"+this.emitData.asis_level,i={orgIds:this.emitData.asis_org,date:r,chartIds:a,_t:Date.parse(new Date)/1e3},this.axios.get(e,{params:i}).then(function(a){setTimeout(function(){t.loading=!1,t.trafficFlowLoading=!1},500);"trafficHour"==t.radioDate?(t.trafficFlow_title="BasicDayReporttrafficHour",s=a.data.data.body.trafficHour.series,o=a.data.data.body.trafficHour.xaxis.data):"traffic10Min"==t.radioDate?(t.trafficFlow_title="BasicDayReporttraffic10Min",s=a.data.data.body.traffic10Min.series,o=a.data.data.body.traffic10Min.xaxis.data):(t.trafficFlow_title="BasicDayReporttrafficday",s=a.data.data.body.kpiData.series,o=a.data.data.body.kpiData.xaxis.data),t.rowLen=o.length,t.trafficFlow_head=t.autoComplateHead("trafficFlow",o),s.length&&(t.trafficFlow_ops=t.dealData(s,t.trafficFlow_head))}).catch(function(a){console.log("base err:",a.message,a)})}},changeTabSelect:function(a){var t=this;this.trafficFlow_title="",this.trafficFlow_head=[],this.trafficFlow_ops=[],this.trafficFlowLoading=!0,this.rowLen=null;var e=this.tableKeyToId[a],i="",r={},o="";o=this.emitData.asis_time?this.emitData.asis_time:dateUnit.dateFormat(new Date,"yyyy-MM-dd"),i="/report/basics/day/"+this.emitData.asis_level+"/"+e,r={orgIds:this.emitData.asis_org,date:o,_t:Date.parse(new Date)/1e3},this.axios.get(i,{params:r}).then(function(e){var i=e.data;if(t.trafficFlow_title="trafficHour"==a?"BasicDayReporttrafficHour":"traffic10Min"==a?"BasicDayReporttraffic10Min":"BasicDayReporttrafficday",i.data.xaxis&&i.data.xaxis.data.length){var r=i.data.xaxis.data;t.trafficFlow_head=t.autoComplateHead("trafficFlow",r),t.rowLen=r.length}if(i.data.series.length){var o=i.data.series;t.trafficFlow_ops=t.dealData(o,t.trafficFlow_head)}setTimeout(function(){t.trafficFlowLoading=!1},500)})},selReport:function(a){console.log("iconType: "+a)},dealHead:function(a){var t=[];return a.forEach(function(a,e){t.push({prop:"defaultOrg"+e,label:a})}),t},autoComplateHead:function(a,t){var e=[];return t.forEach(function(a,t){e.push({prop:"defaultOrg"+t,label:a})}),e},dealData:function(a,t){var e=this,i={},r=[],o="",s=0,l=0;return a.forEach(function(a){if(s=0,l=0,a.data.length<t.length)for(var n=0,f=t.length;n<f;n++)o=t[n].prop,i[o]=a.data[n]||0==a.data[n]?a.data[n]:"--","kpiData"!=e.radioDate&&(i.sums="--",i.averageVal="--","defaultOrg0"!=o&&i[o].constructor==Number&&(l=1,s+=Number(i[o])));else for(var d=0,c=a.data.length;d<c;d++)o=t[d].prop,i[o]=a.data[d]||0==a.data[d]?a.data[d]:"--","kpiData"!=e.radioDate&&(i.sums="--",i.averageVal="--","defaultOrg0"!=o&&i[o].constructor==Number&&(l=1,s+=Number(i[o])));t.length;if(0!=s||0!=l){i.sums=s;var h=s/(e.rowLen-1);i.averageVal=0==h?h:Math.round(100*h)/100}r.push(i),i={}}),r}}}}).call(t,e("7t+N"))},"C/rE":function(a,t){},FDM6:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e("2AuT"),r={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"daily"},[e("div",{staticClass:"asis-table-wrapper"},[e("h3",{staticClass:"asis-table-header single-report-header tf-table-header"},[e("span",{staticClass:"asis-table-download",on:{click:function(t){a.dealExport("domTrafficFlow",a.i18nFormatter(a.trafficFlow_title))}}},[a._v(a._s(a.$t("allPages.load")))]),a._v(" "),e("span",{staticClass:"report-type-box"},[e("span",{class:a.isTabChart?"report-item line-report":"report-item line-report report-item-line",on:{click:function(t){a.selReport("line")}}}),a._v(" "),e("span",{class:a.isTabChart?"report-item report-item-tab":"report-item",on:{click:function(t){a.selReport("table")}}})])]),a._v(" "),e("div",{staticClass:"date-radio-wrapper tf-ratio-group single-ratio-group"},[e("el-radio-group",{attrs:{size:"mini",fill:"#0069FF"},on:{change:function(t){a.changeTabSelect(a.radioDate)}},model:{value:a.radioDate,callback:function(t){a.radioDate=t},expression:"radioDate"}},[e("el-radio-button",{attrs:{label:"kpiData",border:""}},[a._v(a._s(a.$t("button.day")))]),a._v(" "),e("el-radio-button",{attrs:{label:"trafficHour",border:""}},[a._v(a._s(a.$t("button.hour")))]),a._v(" "),e("el-radio-button",{attrs:{label:"traffic10Min",border:""}},[a._v(a._s(a.$t("button.min")))])],1)],1),a._v(" "),e("div",{staticClass:"asis-table-content"},[a.isTabChart?e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.trafficFlowLoading,expression:"trafficFlowLoading"}],staticClass:"asis-table baseasis-table",staticStyle:{width:"100%"},attrs:{id:"domTrafficFlow",data:a.tableData,"header-row-class-name":"asis-table-head","max-height":a.tableHeight}},[a._l(a.trafficFlow_head,function(a,t){return e("el-table-column",{key:t,attrs:{prop:a.prop,label:a.label,align:"center","min-width":"100",fixed:0==t}})}),a._v(" "),"kpiData"!=a.radioDate?e("el-table-column",{attrs:{prop:"averageVal",label:a.$t("table.average"),align:"center","show-overflow-tooltip":""}}):a._e(),a._v(" "),"kpiData"!=a.radioDate?e("el-table-column",{attrs:{prop:"sums",label:a.$t("table.total"),align:"center","show-overflow-tooltip":""}}):a._e()],2):e("div",{staticClass:"area-line-chart",style:{height:a.tableHeight},attrs:{id:"bdlineChart"}})],1)])])},staticRenderFns:[]},o=function(a){e("C/rE")},s=e("VU/8")(i.a,r,!1,o,"data-v-ac993528",null);t.default=s.exports}});