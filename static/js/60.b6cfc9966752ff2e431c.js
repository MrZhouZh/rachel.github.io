webpackJsonp([60],{BH1X:function(a,t){},GiHZ:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e("WWbv"),l={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"customly"},[e("div",{staticClass:"asis-table-wrapper single-report-wrapper"},[e("h3",{staticClass:"asis-table-header single-report-header"},[e("el-select",{staticClass:"select-box",attrs:{size:"mini",placeholder:a.$t("pholder.select")},on:{change:function(t){a.changeSel("detailData",a.kpiValue)}},model:{value:a.kpiValue,callback:function(t){a.kpiValue=t},expression:"kpiValue"}},a._l(a.kpiOption,function(t){return e("el-option",{key:t.value,attrs:{label:a.i18n(t.label),value:t.value}})})),a._v(" "),e("span",{staticClass:"asis-table-download",on:{click:function(t){a.dealExport("domDayAdd",a.i18nFormatter(a.detailData_title))}}},[a._v(a._s(a.$t("allPages.load")))])],1),a._v(" "),e("div",{staticClass:"asis-table-content"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.selLoading,expression:"selLoading"}],staticClass:"asis-table",staticStyle:{width:"100%"},attrs:{id:"domDayAdd",data:a.tableData,"header-row-class-name":"asis-table-head","max-height":a.tableHeight}},[a._l(a.detailData_head,function(a,t){return e("el-table-column",{key:t,attrs:{prop:a.prop,label:a.label,align:"center","min-width":"100",fixed:0==t}})}),a._v(" "),e("el-table-column",{attrs:{prop:"averageVal",label:a.$t("table.average"),"show-overflow-tooltip":"",align:"center"}}),a._v(" "),e("el-table-column",{attrs:{prop:"sums",label:a.$t("table.total"),"show-overflow-tooltip":"",align:"center"}})],2)],1)])])},staticRenderFns:[]},s=function(a){e("BH1X")},o=e("VU/8")(i.a,l,!1,s,"data-v-9adc9218",null);t.default=o.exports},WWbv:function(a,t,e){"use strict";(function(a){var i=e("mvHQ"),l=e.n(i),s=e("DQZ8");t.a={props:{propparam:Object},data:function(){return{loading:!0,selLoading:!0,kpiValue:"TRAFFIC",kpiOption:[{label:"TRAFFIC",value:"TRAFFIC"},{label:"SALES",value:"SALES"},{label:"DEPTH",value:"DEPTH"},{label:"PREPRICE",value:"PREPRICE"},{label:"PERAREAVALUE",value:"PERAREAVALUE"},{label:"DURATIONTIME",value:"DURATIONTIME"}],kpiData_head:[{label:"层面/指标",prop:"kpi"},{label:"客流量",prop:"flow"},{label:"销售额",prop:"sales"},{label:"进店率",prop:"storeRate"},{label:"成交量",prop:"volume"},{label:"客单价",prop:"guestPrice"},{label:"坪效",prop:"pingEffect"}],detailData_head:[{label:"日期",prop:"date"}],kpiData_title:"",detailData_title:"",kpiData_ops:[],detailData_ops:[],tableKeyToId:{},tableIds:"",emitData:{},tableHeight:0,rowLen:Number}},computed:{tableData:function(){if(this.detailData_ops.length){var a={},t={},e=0;for(var i in this.detailData_ops[0])"defaultOrg0"==i?a[i]=this.$t("table.total"):"defaultOrg1"==i?a[i]="--":a[i]?a[i]+=item[i]:a[i]=0;this.detailData_ops.map(function(t,i){e+=1;for(var l in t)isNaN(Number(a[l]))||isNaN(Number(t[l]))||(a[l]+=Number(Math.round(100*t[l])/100))});for(var l in a)t[l]="defaultOrg0"==l?this.$t("table.average"):"defaultOrg1"==l?"--":Number(Math.round(a[l]/e*100)/100);return this.detailData_ops.push(t),this.detailData_ops.push(a),this.detailData_ops}}},components:{"common-tab":s.a},watch:{propparam:{handler:"refreshHandle",immediate:!0}},created:function(){var t=a(window).height(),e=.28;t<=720?e=.35:t<=768?e=.33:t<=900?e=.28:t<=1080&&(e=.31),this.tableHeight=t-t*e},mounted:function(){},methods:{i18n:function(a){var t="format."+a;return this.$t(t)},refreshHandle:function(a){"/baseasis/customly"===a.dateType&&(this.emitData=a.data,this.loading=!0,this.tableIds&&"{}"!==l()(this.tableKeyToId)?this.getTableData(this.tableIds):this.getTableId())},getTableId:function(){var a=this;this.tableKeyToId={},this.tableIds="",this.axios.get("/reportCharts",{params:{report:"BasicReport",_t:Date.parse(new Date)/1e3}}).then(function(t){var e=t.data.data;e.forEach(function(t,i){a.tableKeyToId[t.key]=t.id,"kpiData"!==t.key&&"detailData"!==t.key||(i==e.length-1?a.tableIds+=t.id:a.tableIds+=t.id+",")}),a.getTableData(a.tableIds)})},getTableData:function(a){var t=this;if(a){var e="",i={},l="",s="",o=[];this.emitData.asis_time?(l=this.emitData.asis_time[0],s=this.emitData.asis_time[1]):(l=this.dayReduce(new Date,15),s=dateUnit.dateFormat(new Date,"yyyy-MM-dd")),e="/report/basics/"+this.emitData.asis_level,i={orgIds:this.emitData.asis_org,startDate:l,endDate:s,chartIds:a,kpiType:this.kpiValue,_t:Date.parse(new Date)/1e3},this.axios.get(e,{params:i}).then(function(a){setTimeout(function(){t.loading=!1,t.selLoading=!1},500),t.detailData_ops=[];t.detailData_title="BasicReportdetailData",o=a.data.data.body.detailData.xaxis.data,t.rowLen=o.length,t.detailData_head=t.autoComplateHead("detail",o);var e=a.data.data.body.detailData.series;t.detailData_ops=t.dealData(e,t.detailData_head)}).catch(function(a){})}},autoComplateHead:function(a,t){var e=[],i=[];if(t.length<8){e=t.map(function(a){return a});for(var l=0,s=7-t.length;l<s;l++)e.push("--");e.forEach(function(a,t){i.push({prop:"defaultOrg"+t,label:a})})}else t.forEach(function(a,t){i.push({prop:"defaultOrg"+t,label:a})});return i},dealData:function(a,t){var e=this,i={},l=[],s="",o=0;return a.forEach(function(a){if(o=0,a.data.length<t.length)for(var r=0,d=a.data.length;r<d;r++)s=t[r].prop,i[s]=a.data[r]||0==a.data[r]?a.data[r]:"--",i.sums="--",i.averageVal="--","defaultOrg0"!=s&&"defaultOrg1"!=s&&i[s].constructor==Number&&(o+=Number(i[s]));else for(var n=0,p=a.data.length;n<p;n++)s=t[n].prop,i[s]=a.data[n]||0==a.data[n]?a.data[n]:"--",i.sums="--",i.averageVal="--","defaultOrg0"!=s&&"defaultOrg1"!=s&&i[s].constructor==Number&&(o+=Number(i[s]));i.sums=o;var u=o/(e.rowLen-2);i.averageVal=0==u?u:u.toFixed(2),l.push(i),i={}}),l},changeSel:function(a,t){var e=this,i="",l={},s="",o="",r=[],d=this.tableKeyToId[a];this.selLoading=!0,this.emitData.asis_time?(s=this.emitData.asis_time[0],o=this.emitData.asis_time[1]):(s=this.dayReduce(new Date,15),o=dateUnit.dateFormat(new Date,"yyyy-MM-dd")),i="/report/basics/"+this.emitData.asis_level,l={orgIds:this.emitData.asis_org,startDate:s,endDate:o,chartIds:d,kpiType:t,_t:Date.parse(new Date)/1e3},this.axios.get(i,{params:l}).then(function(a){setTimeout(function(){e.selLoading=!1},500);e.detailData_ops=[],e.detailData_title="BasicReportdetailData",a.data.data.body.detailData.xaxis&&(r=a.data.data.body.detailData.xaxis.data,e.rowLen=r.length),e.detailData_head=e.autoComplateHead("detail",r);var t=a.data.data.body.detailData.series;t.length&&(e.detailData_ops=e.dealData(t,e.detailData_head))}).catch(function(a){})}}}}).call(t,e("7t+N"))}});