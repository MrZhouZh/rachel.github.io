webpackJsonp([70],{"9bA1":function(e,a){},"m+FN":function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var l={data:function(){return{activeName:"first",mallList:[],floorList:[],zoneList:[],mallValue:"",mallToFloorValue:"",mallToZoneValue:"",floorValue:"",zoneValue:"",allGate:[],floorAllGate:[],zoneAllGate:[],floorForGate:[],zoneForGate:[]}},created:function(){this.getMallList()},methods:{getMallList:function(){var e=this,a={_t:Date.parse(new Date)/1e3};this.axios.get("/malls",{params:a}).then(function(a){var t=a.data.data;e.mallList=[],t.forEach(function(a,t,l){0==t&&(e.mallValue=a.id,e.mallToFloorValue=a.id,e.mallToZoneValue=a.id);var o={};o.label=a.name,o.value=a.id,e.mallList.push(o)}),e.getAllGate(e.mallValue),e.getFloorList(e.mallToFloorValue),e.getZoneList(e.mallToZoneValue)}).catch(function(e){})},getFloorList:function(e){var a=this,t={mallId:e,_t:Date.parse(new Date)/1e3};this.axios.get("/floors",{params:t}).then(function(e){var t=e.data.data;a.floorList=[],0==t.length&&(a.floorValue=""),t.forEach(function(e,t,l){0==t&&(a.floorValue=e.id);var o={};o.label=e.name,o.value=e.id,a.floorList.push(o)}),a.getFloorAllGate(a.mallToFloorValue)}).catch(function(e){})},getZoneList:function(e){var a=this,t={mallId:e,sortName:'"floor".name, "zone".name',_t:Date.parse(new Date)/1e3};this.axios.get("/zones",{params:t}).then(function(e){var t=e.data.data;a.zoneList=[],0==t.length&&(a.zoneValue=""),t.forEach(function(e,t,l){0==t&&(a.zoneValue=e.id);var o={};o.label=e.name,o.value=e.id,a.zoneList.push(o)}),a.getZoneAllGate(a.mallToZoneValue)}).catch(function(e){})},mallSelectChange:function(){this.getAllGate(this.mallValue)},mall2SelectChange:function(){this.getFloorList(this.mallToFloorValue)},mall3SelectChange:function(){this.getZoneList(this.mallToZoneValue)},floorSelectChange:function(){this.getFloorCanBindGate(this.floorValue)},zoneSelectChange:function(){this.getZoneCanBindGate(this.zoneValue)},getAllGate:function(e){var a=this,t={mallId:e,status:1,_t:Date.parse(new Date)/1e3};this.axios.get("/gates",{params:t}).then(function(e){a.allGate=[];e.data.data.forEach(function(e,t,l){var o={};o.label=e.name,o.value=e.id,o.isMallGate=e.isMallGate,a.allGate.push(o)})}).catch(function(e){})},getFloorAllGate:function(e){var a=this,t={mallId:e,status:1,_t:Date.parse(new Date)/1e3};this.axios.get("/gates",{params:t}).then(function(e){a.floorAllGate=[];e.data.data.forEach(function(e,t,l){var o={};o.label=e.name,o.value=e.id,o.isMallGate=e.isMallGate,a.floorAllGate.push(o)}),a.getFloorCanBindGate(a.floorValue)}).catch(function(e){})},getZoneAllGate:function(e){var a=this,t={mallId:e,status:1,_t:Date.parse(new Date)/1e3};this.axios.get("/gates",{params:t}).then(function(e){a.zoneAllGate=[];e.data.data.forEach(function(e,t,l){var o={};o.label=e.name,o.value=e.id,o.isMallGate=e.isMallGate,a.zoneAllGate.push(o)}),a.getZoneCanBindGate(a.zoneValue)}).catch(function(e){})},mallBindGate:function(e){1==e.isMallGate?e.isMallGate=0:e.isMallGate=1,this.axios.post("/gates/"+e.value,{isMallGate:e.isMallGate}).then(function(e){}).catch(function(e){})},getFloorCanBindGate:function(e){var a=this,t={floorId:e,_t:Date.parse(new Date)/1e3};this.axios.get("/floorGates",{params:t}).then(function(e){var t=e.data.data;a.floorForGate=[];var l={};t.forEach(function(e,a,t){l[e.gateId]=e}),a.floorAllGate.forEach(function(e,t,o){var n={};n.label=e.label,n.value=e.value,l[e.value]?(n.isBind=1,1==l[e.value].type?(n.text="进",n.type=1):(n.text="出",n.type=2),n.id=l[e.value].id):(n.isBind=0,n.text="未绑定",n.type=0),a.floorForGate.push(n)})}).catch(function(e){})},getZoneCanBindGate:function(e){var a=this,t={zoneId:e,_t:Date.parse(new Date)/1e3};this.axios.get("/zoneGates",{params:t}).then(function(e){var t=e.data.data;a.zoneForGate=[];var l={};t.forEach(function(e,a,t){l[e.gateId]=e}),a.zoneAllGate.forEach(function(e,t,o){var n={};n.label=e.label,n.value=e.value,l[e.value]?(n.isBind=1,1==l[e.value].type?(n.text="进",n.type=1):(n.text="出",n.type=2),n.id=l[e.value].id):(n.isBind=0,n.text="未绑定",n.type=0),a.zoneForGate.push(n)})}).catch(function(e){})},floorBindGate:function(e){var a=this;1==e.type?this.axios.post("/floorGates/"+e.id,{type:2}).then(function(e){a.getFloorCanBindGate(a.floorValue)}).catch(function(e){}):2==e.type?this.axios.delete("/floorGates/"+e.id,{params:{}}).then(function(e){a.getFloorCanBindGate(a.floorValue)}).catch(function(e){}):this.axios.post("/floorGates",{floorId:this.floorValue,gateId:e.value,type:1,createUser:this.$cookie.get("userId"),modifyUser:this.$cookie.get("userId")}).then(function(e){a.getFloorCanBindGate(a.floorValue)})},zoneBindGate:function(e){var a=this;1==e.type?this.axios.post("/zoneGates/"+e.id,{type:2}).then(function(e){a.getZoneCanBindGate(a.zoneValue)}).catch(function(e){}):2==e.type?this.axios.delete("/zoneGates/"+e.id,{params:{}}).then(function(e){a.getZoneCanBindGate(a.zoneValue)}).catch(function(e){}):this.axios.post("/zoneGates",{zoneId:this.zoneValue,gateId:e.value,type:1,createUser:this.$cookie.get("userId"),modifyUser:this.$cookie.get("userId")}).then(function(e){a.getZoneCanBindGate(a.zoneValue)})}}},o={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"gateBind-wrapper"},[t("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(a){e.activeName=a},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"广场监控点绑定",name:"first"}},[t("div",{staticStyle:{"margin-bottom":"10px"}},[t("el-select",{attrs:{filterable:"",placeholder:e.$t("pholder.select"),size:"mini"},on:{change:e.mallSelectChange},model:{value:e.mallValue,callback:function(a){e.mallValue=a},expression:"mallValue"}},e._l(e.mallList,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),t("div",e._l(e.allGate,function(a){return t("el-tag",{key:a.value,staticClass:"cursorTag",attrs:{type:1==a.isMallGate?"success":""},nativeOn:{click:function(t){e.mallBindGate(a)}}},[e._v(e._s(a.label)+"("+e._s(1==a.isMallGate?"绑定":"未绑定")+")")])}))]),e._v(" "),t("el-tab-pane",{attrs:{label:"楼层监控点绑定",name:"second"}},[t("div",{staticStyle:{"margin-bottom":"10px"}},[t("el-select",{attrs:{filterable:"",placeholder:e.$t("pholder.select"),size:"mini"},on:{change:e.mall2SelectChange},model:{value:e.mallToFloorValue,callback:function(a){e.mallToFloorValue=a},expression:"mallToFloorValue"}},e._l(e.mallList,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),t("el-select",{attrs:{filterable:"",placeholder:e.$t("pholder.select"),size:"mini"},on:{change:e.floorSelectChange},model:{value:e.floorValue,callback:function(a){e.floorValue=a},expression:"floorValue"}},e._l(e.floorList,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),t("div",e._l(e.floorForGate,function(a){return t("el-tag",{key:a.value,staticClass:"cursorTag",attrs:{type:1==a.isBind?"success":""},nativeOn:{click:function(t){e.floorBindGate(a)}}},[e._v(e._s(a.label)+"("+e._s(a.text)+")")])}))]),e._v(" "),t("el-tab-pane",{attrs:{label:"店铺监控点绑定",name:"third"}},[t("div",{staticStyle:{"margin-bottom":"10px"}},[t("el-select",{attrs:{filterable:"",placeholder:e.$t("pholder.select"),size:"mini"},on:{change:e.mall3SelectChange},model:{value:e.mallToZoneValue,callback:function(a){e.mallToZoneValue=a},expression:"mallToZoneValue"}},e._l(e.mallList,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),t("el-select",{attrs:{filterable:"",placeholder:e.$t("pholder.select"),size:"mini"},on:{change:e.zoneSelectChange},model:{value:e.zoneValue,callback:function(a){e.zoneValue=a},expression:"zoneValue"}},e._l(e.zoneList,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),t("div",e._l(e.zoneForGate,function(a){return t("el-tag",{key:a.value,staticClass:"cursorTag",attrs:{type:a.isBind&&1==a.isBind?"success":""},nativeOn:{click:function(t){e.zoneBindGate(a)}}},[e._v(e._s(a.label)+"("+e._s(a.text)+")")])}))])],1)],1)},staticRenderFns:[]},n=t("VU/8")(l,o,!1,function(e){t("9bA1")},"data-v-7cad6124",null);a.default=n.exports}});