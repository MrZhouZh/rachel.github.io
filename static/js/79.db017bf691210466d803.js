webpackJsonp([79],{PZYH:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),s=a.n(i),l=a("jR44"),r=a("DQZ8"),n={props:{propparam:Object},data:function(){return{startTime:"",endTime:"",loading:!0,quarterVal:"第一季度",WeatherSynthetical_head:[{label:"天气",prop:"weather"},{label:"天数",prop:"dayNum"},{label:"平均AQI指数",prop:"aqiIndex"},{label:"平均温度",prop:"averTem"},{label:"客流量（人次）",prop:"passFlow"}],WeatherDetail_head:[{label:"日期",prop:"date"},{label:"星期",prop:"week"},{label:"天气",prop:"weather"},{label:"AQI指数",prop:"aqiIndex"},{label:"温度",prop:"tem"},{label:"客流量（人次）",prop:"passFlow"}],WeatherAnalyze_title:"",WeatherSynthetical_title:"",WeatherDetail_title:"",WeatherAnalyze_ops:{},WeatherSynthetical_ops:[],WeatherDetail_ops:[],tableKeyToId:{},tableIds:"",emitData:{},kpiArr:{TRAFFIC:"客流量",SALES:"销售额",ENTERINGRATE:"进店率",PREPRICE:"客单价",PERAREAVALUE:"坪效",ORDER:"成交量",HANDBAGRATE:"提袋率",DURATIONTIME:"滞留时间"}}},components:{"scatter-chart":l.a,"common-tab":r.a},watch:{propparam:{handler:"refreshHandle",immediate:!0}},mounted:function(){},methods:{refreshHandle:function(t){"/weatherasis/monthly"===t.dateType&&(this.emitData=t.data,this.loading=!0,this.tableIds&&"{}"!==s()(this.tableKeyToId)?this.getChartData(this.tableIds):this.getChartId())},getChartId:function(){var t=this;this.tableKeyToId={},this.tableIds="",this.axios.get("/reportCharts",{params:{report:"WeatherReport",_t:Date.parse(new Date)/1e3}}).then(function(e){var a=e.data.data;a.forEach(function(e,i){t.tableKeyToId[e.key]=e.id,"WeatherAnalyze"!==e.key&&"WeatherSynthetical"!==e.key&&"WeatherDetail"!==e.key||(i==a.length-1?t.tableIds+=e.id:t.tableIds+=e.id+",")}),t.getChartData(t.tableIds)})},getChartData:function(t){var e=this;if(t){this.WeatherAnalyze_ops={},this.WeatherSynthetical_ops=[],this.WeatherDetail_ops=[];var a="",i={};if(this.emitData.asis_time)if(this.emitData.asis_time.getMonth()===(new Date).getMonth()&&this.emitData.asis_time.getFullYear()===(new Date).getFullYear())this.endTime=dateUnit.dateFormat(this.emitData.asis_time,"yyyy-MM-dd"),this.startTime=dateUnit.dateFormat(new Date(Date.parse(this.emitData.asis_time.getFullYear()+"/"+(this.emitData.asis_time.getMonth()+1)+"/01")),"yyyy-MM-dd"),this.startTime==this.endTime&&(this.endTime=dateUnit.dateFormat(new Date,"yyyy-MM-dd"));else{this.startTime=this.emitData.asis_time,this.endTime=new Date(Date.parse(this.dayAdd(this.emitData.asis_time,31).replace(/\-/,"/")));var s=this.unitTime(this.startTime,this.endTime,"month");this.startTime=s.startTime,this.endTime=s.endTime}"format"===this.emitData.asis_level?(a="/report/weather/mall",i={orgIds:this.emitData.asis_org,startDate:this.startTime,endDate:this.endTime,chartIds:t,kpiType:this.emitData.asis_kpi,formatIds:this.emitData.asis_format,_t:Date.parse(new Date)/1e3}):(a="/report/weather/"+this.emitData.asis_level,i={orgIds:this.emitData.asis_org,startDate:this.startTime,endDate:this.endTime,chartIds:t,kpiType:this.emitData.asis_kpi,_t:Date.parse(new Date)/1e3}),this.axios.get(a,{params:i}).then(function(t){setTimeout(function(){e.loading=!1},500);var a="WeatherReport";e.WeatherAnalyze_title=a+"WeatherAnalyze",e.WeatherSynthetical_title=a+"WeatherSynthetical",e.WeatherDetail_title=a+"WeatherDetail",e.WeatherAnalyze_ops=t.data.data.body.WeatherAnalyze,e.WeatherAnalyze_ops.kpiName=e.kpiArr[e.emitData.asis_kpi];var i=t.data.data.body.WeatherSynthetical.series,s=t.data.data.body.WeatherDetail.series;e.WeatherSynthetical_ops=e.dealData(i,e.WeatherSynthetical_head),e.WeatherDetail_ops=e.dealData(s,e.WeatherDetail_head)}).catch(function(t){console.log("weather month report error:",t,t.message)})}},dealData:function(t,e){var a={},i=[],s="";return t.forEach(function(t){for(var l=0,r=t.data.length;l<r;l++)e[l].prop&&(s=e[l].prop,a[s]=t.data[l]||0==t.data[l]?t.data[l]:"--");i.push(a),a={}}),i},weatherFormat:function(t,e,a){var i=this.getSessionLocal("weather",a);return i?this.$t("dictionary."+i):this.$t("dictionary.unknow")}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"monthly"},[a("div",{staticClass:"asis-table-wrapper weather-echart-wrapper download-parent"},[a("scatter-chart",{staticClass:"month-scatter-block",attrs:{id:"monthScatterChart",options:t.WeatherAnalyze_ops,chartType:"Scatter"}}),t._v(" "),a("span",{staticClass:"ehcarts-title"},[t._v(t._s(t.i18nFormatter(t.WeatherAnalyze_title)))])],1),t._v(" "),a("div",{staticClass:"asis-table-wrapper"},[a("h3",{staticClass:"asis-table-header"},[a("span",{staticClass:"asis-table-title"},[t._v(t._s(t.i18nFormatter(t.WeatherSynthetical_title)))]),t._v(" "),a("span",{staticClass:"asis-table-download",on:{click:function(e){t.dealExport("domAsis",t.i18nFormatter(t.WeatherSynthetical_title))}}},[t._v(t._s(t.$t("allPages.load")))])]),t._v(" "),a("div",{staticClass:"asis-table-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"asis-table",attrs:{data:t.WeatherSynthetical_ops,id:"domAsis"}},[a("el-table-column",{attrs:{label:t.$t("table.weather"),prop:"weather",formatter:t.weatherFormat,align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("table.dayNum"),prop:"dayNum",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("table.aqiIndex"),prop:"aqiIndex",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("table.averTem"),prop:"averTem",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("table.passFlow"),prop:"passFlow",align:"center"}})],1)],1)]),t._v(" "),a("div",{staticClass:"asis-table-wrapper"},[a("h3",{staticClass:"asis-table-header"},[a("span",{staticClass:"asis-table-title"},[t._v(t._s(t.i18nFormatter(t.WeatherDetail_title)))]),t._v(" "),a("span",{staticClass:"asis-table-download",on:{click:function(e){t.dealExport("domDetail",t.i18nFormatter(t.WeatherDetail_title))}}},[t._v(t._s(t.$t("allPages.load")))])]),t._v(" "),a("div",{staticClass:"asis-table-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"asis-table",attrs:{data:t.WeatherDetail_ops,id:"domDetail"}},[a("el-table-column",{attrs:{label:t.$t("table.date"),prop:"date",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("table.week"),prop:"week",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("table.weather"),prop:"weather",formatter:t.weatherFormat,align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("table.aqiIndex"),prop:"aqiIndex",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("table.tem"),prop:"tem",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("table.passFlow"),prop:"passFlow",align:"center"}})],1)],1)])])},staticRenderFns:[]},h=a("VU/8")(n,o,!1,function(t){a("m0Z0")},"data-v-1b9b4180",null);e.default=h.exports},m0Z0:function(t,e){}});