webpackJsonp([86],{Wbm7:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=t("mvHQ"),o=t.n(s),i=t("DQZ8"),r={props:{propparam:Object},data:function(){return{loading:!0,Near3WeekYoY_head:[{label:"周期",prop:"cycle"},{label:"当周总计",prop:"weekTotal"},{label:"上周总计",prop:"totalLw"},{label:"上周环比( % )",prop:"seqLw"},{label:"去年同周总计",prop:"totalLyw"},{label:"去年同比",prop:"compareLy"}],DayOfWeekYoY_head:[{label:"日期",prop:"date"},{label:"当日",prop:"today"},{label:"上周同期",prop:"sameLw"},{label:"上周环比( % )",prop:"seqLw"},{label:"上月同期",prop:"todayLm"},{label:"上月环比( % )",prop:"seqLm"},{label:"去年同期",prop:"sameLy"},{label:"去年同比( % )",prop:"compareLy"}],WeekDayOrEndYoY_head:[{label:"第10周",prop:"week"},{label:"当周总计",prop:"totalWeek"},{label:"上周总计",prop:"totalLw"},{label:"上周环比( % )",prop:"seqLw"},{label:"去年同周总计",prop:"totalLyw"},{label:"去年环比( % )",prop:"seqLy"}],Near3WeekYoY_title:"",DayOfWeekYoY_title:"",WeekDayOrEndYoY_title:"",Near3WeekYoY_ops:[],DayOfWeekYoY_ops:[],WeekDayOrEndYoY_ops:[],tableKeyToId:{},tableIds:"",emitData:[]}},components:{"common-tab":i.a},watch:{propparam:{handler:"refreshHandle",immediate:!0}},mounted:function(){},methods:{refreshHandle:function(e){"/seqasis/weekly"===e.dateType&&(this.emitData=e.data,this.loading=!0,this.tableIds&&"{}"!==o()(this.tableKeyToId)?this.getTableData(this.tableIds):this.getTableId())},getTableId:function(){var e=this;this.tableKeyToId={},this.tableIds="",this.axios.get("/reportCharts",{params:{report:"WeekYoYMoM",_t:Date.parse(new Date)/1e3}}).then(function(a){var t=a.data.data;t.forEach(function(a,s){e.tableKeyToId[a.key]=a.id,"Near3WeekYoY"!==a.key&&"WeekDayOrEndYoY"!==a.key&&"DayOfWeekYoY"!==a.key||(s==t.length-1?e.tableIds+=a.id:e.tableIds+=a.id+",")}),e.getTableData(e.tableIds)})},getTableData:function(e){var a=this;if(e){this.Near3WeekYoY_ops=[],this.DayOfWeekYoY_ops=[],this.WeekDayOrEndYoY_ops=[];var t="",s={},o="",i="";if(this.emitData.asis_time)o=this.getWeekTime(this.emitData.asis_time,!1),i=this.getWeekTime(this.emitData.asis_time,!0);else{var r=this.getWeekTime(new Date);new Date(Date.parse(new Date)-24*r*60*60*1e3);o=this.getWeekTime(new Date,!1),i=this.getWeekTime(new Date,!0)}"format"===this.emitData.asis_level?(t="/report/yoyOrMom/week/mall",s={orgIds:this.emitData.asis_org,startDate:o,endDate:i,chartIds:e,kpiType:this.emitData.asis_kpi,formatIds:this.emitData.asis_format,_t:Date.parse(new Date)/1e3}):(t="/report/yoyOrMom/week/"+this.emitData.asis_level,s={orgIds:this.emitData.asis_org,startDate:o,endDate:i,chartIds:e,kpiType:this.emitData.asis_kpi,_t:Date.parse(new Date)/1e3}),this.axios.get(t,{params:s}).then(function(e){setTimeout(function(){a.loading=!1},500);a.Near3WeekYoY_title="WeekYoYMoMNear3WeekYoY",a.DayOfWeekYoY_title="WeekYoYMoMDayOfWeekYoY",a.WeekDayOrEndYoY_title="WeekYoYMoMWeekDayOrEndYoY";var t=e.data.data.body.Near3WeekYoY.series,s=e.data.data.body.DayOfWeekYoY.series,o=e.data.data.body.WeekDayOrEndYoY.series;a.Near3WeekYoY_head=a.autoComplateHead(e.data.data.body.Near3WeekYoY.xaxis.data),a.DayOfWeekYoY_head=a.autoComplateHead(e.data.data.body.DayOfWeekYoY.xaxis.data),a.WeekDayOrEndYoY_head=a.autoComplateHead(e.data.data.body.WeekDayOrEndYoY.xaxis.data),t.length&&(a.Near3WeekYoY_ops=a.dealData(t,a.Near3WeekYoY_head)),s.length&&(a.DayOfWeekYoY_ops=a.dealData(s,a.DayOfWeekYoY_head)),o.length&&(a.WeekDayOrEndYoY_ops=a.dealData(o,a.WeekDayOrEndYoY_head))}).catch(function(e){})}},autoComplateHead:function(e){var a=[];return e.forEach(function(e,t){a.push({prop:"defaultOrg"+t,label:e})}),a},dealData:function(e,a){var t={},s=[],o="";return e.forEach(function(e){for(var i=0,r=e.data.length;i<r;i++)o=a[i].prop,t[o]=e.data[i]||0==e.data[i]?e.data[i]:"--";s.push(t),t={}}),s},getSummaries:function(e){var a=this,t=e.columns,s=e.data,o=[];return t.forEach(function(e,t){if(0!=t){var i=s.map(function(a){return Number(a[e.property])});if(i.every(function(e){return isNaN(e)})){var r=s.map(function(a){if(/\%/g.test(a[e.property]))return a[e.property].split("%")[0]});if(!r.every(function(e){return isNaN(e)})){o[t]=r.reduce(function(e,a){var t=Number(a);return isNaN(t)?e:t>0?e-0+(a-0):e-0-(-a-0)});try{o[t]=o[t].toFixed(2)}catch(e){}o[t]+="%"}}else o[t]=i.reduce(function(e,a){var t=Number(a);return isNaN(t)?e:e+a},0)}else o[t]=a.$t("table.total")}),o}}},l={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"weekly"},[t("div",{staticClass:"asis-table-wrapper"},[t("h3",{staticClass:"asis-table-header"},[t("span",{staticClass:"asis-table-title"},[e._v(e._s(e.i18nFormatter(e.Near3WeekYoY_title)))]),e._v(" "),t("span",{staticClass:"asis-table-download",on:{click:function(a){e.dealExport("domNearWeek",e.i18nFormatter(e.Near3WeekYoY_title))}}},[e._v(e._s(e.$t("allPages.load")))])]),e._v(" "),t("div",{staticClass:"asis-table-content"},[t("common-tab",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{tableData:e.Near3WeekYoY_ops,id:"domNearWeek",headData:e.Near3WeekYoY_head,tabHeight:""}})],1)]),e._v(" "),t("div",{staticClass:"asis-table-wrapper"},[t("h3",{staticClass:"asis-table-header"},[t("span",{staticClass:"asis-table-title"},[e._v(e._s(e.i18nFormatter(e.DayOfWeekYoY_title)))]),e._v(" "),t("span",{staticClass:"asis-table-download",on:{click:function(a){e.dealExport("domDayOfWeek",e.i18nFormatter(e.DayOfWeekYoY_title))}}},[e._v(e._s(e.$t("allPages.load")))])]),e._v(" "),t("div",{staticClass:"asis-table-content"},[t("common-tab",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"i18n",attrs:{tableData:e.DayOfWeekYoY_ops,id:"domDayOfWeek",headData:e.DayOfWeekYoY_head,tabHeight:""}})],1)]),e._v(" "),t("div",{staticClass:"asis-table-wrapper"},[t("h3",{staticClass:"asis-table-header"},[t("span",{staticClass:"asis-table-title"},[e._v(e._s(e.i18nFormatter(e.WeekDayOrEndYoY_title)))]),e._v(" "),t("span",{staticClass:"asis-table-download",on:{click:function(a){e.dealExport("domWeekEndOrWork",e.i18nFormatter(e.WeekDayOrEndYoY_title))}}},[e._v(e._s(e.$t("allPages.load")))])]),e._v(" "),t("div",{staticClass:"asis-table-content"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"asis-table",staticStyle:{width:"100%"},attrs:{id:"domWeekEndOrWork",data:e.WeekDayOrEndYoY_ops,"summary-method":e.getSummaries,"show-summary":"","header-row-class-name":"asis-table-head"}},e._l(e.WeekDayOrEndYoY_head,function(e){return t("el-table-column",{key:e.prop,attrs:{prop:e.prop,label:e.label,align:"center"}})}))],1)])])},staticRenderFns:[]},n=t("VU/8")(r,l,!1,function(e){t("x1yM")},"data-v-ca2efaa0",null);a.default=n.exports},x1yM:function(e,a){}});