webpackJsonp([89],{BHXv:function(t,a){},nH04:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("mvHQ"),o=e.n(i),s=e("pJt5"),l=e("DQZ8"),r=e("jR44"),n={props:{propparam:Object},data:function(){return{hiddenArrow:!1,overTip:!0,loading:!0,tableKeyToId:{},tableIds:"",emitData:[],holidayAct_title:"",holidayActData:[],holidayEff_title:"",holidayEffect_ops:{},growth_title:"",growthHead:[],growthData:[],searchTime:"",apiUrl:""}},components:{"common-tab":l.a,"bar-chart":r.a,"export-data-dialog":s.a},created:function(){},watch:{propparam:{handler:"refreshHandle",immediate:!0}},mounted:function(){},methods:{refreshHandle:function(t){"/holidayAsis/yearly"===t.dateType&&(this.emitData=t.data,this.loading=!0,this.tableIds&&"{}"!==o()(this.tableKeyToId)?this.getTableData(this.tableIds):this.getTableId())},iconLabelFun:function(t,a){var e=a.column,i=(a.$index,e.label.split("-")[0]),o=e.label.split("-")[1];return t("div",{class:"render-header-box"},[t("span",{class:"render-header-icon",style:"display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:#3BB8FF;"}),t("span",{class:"render-header-text"},[i]),t("span",{style:"display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:#87D14B;"}),t("span",{class:"render-header-text"},[o])])},labelFunction:function(t,a){var e=a.column;a.$index;if(-1===e.label.indexOf("(")){var i=e.label.split("(")[0],o=e.label.split("(")[1].split(")")[0];return t("ul",{class:"render-header-ul"},[t("li",{class:"render-header-li"},[i]),t("li",{class:"render-header-li"},["(",o,")"])])}},emptyFormat:function(t,a,e){return e||0==e?e:"--"},formatFlow:function(t){if(!t)return"--";return t>1e5?(t/1e4).toFixed(2)+"万人次":t+"人次"},getTableId:function(){var t=this;this.tableKeyToId={},this.tableIds="",this.axios.get("/reportCharts",{params:{report:"holidayeEvent",_t:Date.parse(new Date)/1e3}}).then(function(a){var e=a.data.data;e.forEach(function(a,i){t.tableKeyToId[a.key]=a.id,"HolidayEvent"!==a.key&&"HolidayDetail"!==a.key&&"HolidayEffect"!==a.key||(i==e.length-1?t.tableIds+=a.id:t.tableIds+=a.id+",")}),t.getTableData(t.tableIds)})},ratioComputed:function(t,a){var e="0%";return t>0&&(e=(a/t*100).toFixed(2)+"%"),"width: "+e},getTableData:function(t){var a=this;if(t){this.holidayAct_title="",this.holidayEff_title="",this.growth_title="",this.holidayActData=[],this.holidayEffect_ops={},this.growthData=[];var e={},i="";i=this.emitData.asis_time?"string"==typeof this.emitData.asis_time?this.emitData.asis_time===(new Date).getFullYear()?(new Date).getFullYear()+"-01-01":this.emitData.asis_time+"-01-01":this.emitData.asis_time.getFullYear()===(new Date).getFullYear()?(new Date).getFullYear()+"-01-01":this.emitData.asis_time.getFullYear()+"-01-01":(new Date).getFullYear()+"-01-01",this.searchTime=i,"format"===this.emitData.asis_level?(this.apiUrl="/report/holidayeEvent/mall",e={orgIds:this.emitData.asis_org,date:i,chartIds:t,kpiType:this.emitData.asis_kpi,formatIds:this.emitData.asis_format,_t:Date.parse(new Date)/1e3}):(this.apiUrl="/report/holidayeEvent/"+this.emitData.asis_level,e={orgIds:this.emitData.asis_org,date:i,chartIds:t,kpiType:this.emitData.asis_kpi,_t:Date.parse(new Date)/1e3}),this.axios.get(this.apiUrl,{params:e}).then(function(t){var e=t.data;if(200==e.code){var i=["name","startDate","endDate","durationDay","nowFlow","averageFlow","contrast"],o={},s=[],l=[],r="holidayeEvent";a.holidayAct_title=r+"HolidayEvent",a.holidayEff_title=r+"HolidayEffect",a.growth_title=r+"HolidayDetail";var n=e.data.body.HolidayEvent.series,d=e.data.body.HolidayDetail.series,c=e.data.body.HolidayDetail.xaxis.data;a.growthHead=a.autoComplateHead("growthDetail",c),n.forEach(function(t){t.data.forEach(function(t,a){o[i[a]]=t,o.nowFlow&&l.push(o.nowFlow),o.averageFlow&&l.push(o.averageFlow),o.contrast={name:o.name,totalFlow:null,nowFlow:o.nowFlow,averageFlow:o.averageFlow}}),s.push(o),o={}});var p=Math.max.apply(null,l);s.forEach(function(t){t.contrast.totalFlow=p}),a.holidayActData=s,a.holidayEffect_ops=e.data.body.HolidayEffect,a.growthData=a.dealData(d,a.growthHead)}setTimeout(function(){a.loading=!1},500)}).catch(function(t){})}},combineData:function(t,a){var e={},i=[];return t.forEach(function(t){t.data.forEach(function(t,i){e[a[i]]=t}),i.push(e),e={}}),i},autoComplateHead:function(t,a){var e=[];return a.forEach(function(t,a){e.push({prop:"defaultOrg"+a,label:t})}),e},dealData:function(t,a){var e={},i=[],o="";return t.forEach(function(t){for(var s=0,l=t.data.length;s<l;s++)o=a[s].prop,e[o]=t.data[s]||0==t.data[s]?t.data[s]:"--";i.push(e),e={}}),i},exportDataHandle:function(t,a,e){var i=this.tableKeyToId[e],o={domId:t,title:a,data:{url:this.apiUrl+"/"+i+"/excel",params:"orgIds="+this.emitData.asis_org+"&Date="+this.searchTime+"&kpiType="+this.emitData.asis_kpi}};this.$refs.exportDialog.dialogInit(o)}}},d={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"monthly"},[e("div",{staticClass:"asis-table-wrapper"},[e("h3",{staticClass:"asis-table-header"},[e("span",{staticClass:"asis-table-title"},[t._v(t._s(t.i18nFormatter(t.holidayAct_title)))]),t._v(" "),e("span",{staticClass:"asis-table-download",on:{click:function(a){t.dealExport("holidayAct",t.i18nFormatter(t.holidayAct_title))}}},[t._v(t._s(t.$t("allPages.load")))])]),t._v(" "),e("div",{staticClass:"asis-table-content"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"holiday-act-table",attrs:{data:t.holidayActData,border:"",id:"holidayAct","empty-text":t.$t("echartsTitle.noData")}},[e("el-table-column",{attrs:{label:t.$t("asis.eventName"),prop:"name",align:"center",width:"150"}}),t._v(" "),e("el-table-column",{attrs:{label:t.$t("asis.eventStartTime"),prop:"startDate",align:"center",width:"120"}}),t._v(" "),e("el-table-column",{attrs:{label:t.$t("asis.eventEndTime"),prop:"endDate",align:"center",width:"120"}}),t._v(" "),e("el-table-column",{attrs:{label:t.$t("asis.eventDay"),prop:"durationDay",align:"center",width:"120"}}),t._v(" "),e("el-table-column",{attrs:{label:t.$t("asis.eventDayTraffic"),align:"center",prop:"nowFlow",width:"120"}}),t._v(" "),e("el-table-column",{attrs:{label:t.$t("asis.eventTraffic"),align:"center","render-header":t.iconLabelFun,"class-name":"progress-label"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"progress-box"},[e("div",{staticClass:"item-progress-box left-progress-box"},[e("el-popover",{attrs:{placement:"bottom",title:a.row.contrast.name,"visible-arrow":t.hiddenArrow,"popper-class":"progress-popper",trigger:"hover"}},[e("span",{staticClass:"progress-item now-progress-item",style:t.ratioComputed(a.row.contrast.totalFlow,a.row.contrast.nowFlow),attrs:{slot:"reference"},slot:"reference"}),t._v(" "),e("div",{staticClass:"text-tooltip"},[e("p",[t._v(t._s(t.$t("asis.eventDay"))+": "+t._s(a.row.contrast.nowFlow||0==a.row.contrast.nowFlow?t.formatFlow(a.row.contrast.nowFlow):"--"))])])])],1),t._v(" "),e("div",{staticClass:"item-progress-box right-progress-box"},[e("el-popover",{attrs:{placement:"bottom",title:a.row.contrast.name,"visible-arrow":t.hiddenArrow,"popper-class":"progress-popper",trigger:"hover"}},[e("span",{staticClass:"progress-item average-progress-item",style:t.ratioComputed(a.row.contrast.totalFlow,a.row.contrast.averageFlow),attrs:{slot:"reference"},slot:"reference"}),t._v(" "),e("div",{staticClass:"text-tooltip"},[e("p",[t._v(t._s(t.$t("asis.eventAveTraffic"))+": "+t._s(a.row.contrast.averageFlow||0==a.row.contrast.averageFlow?t.formatFlow(a.row.contrast.averageFlow):"--"))])])])],1)])]}}])}),t._v(" "),e("el-table-column",{attrs:{label:t.$t("asis.eventAveTraffic"),prop:"averageFlow",align:"center",width:"120"}})],1)],1)]),t._v(" "),e("div",{staticClass:"holiday-echart-wrapper download-parent"},[e("span",{staticClass:"ehcarts-title"},[t._v(t._s(t.i18nFormatter(t.holidayEff_title)))]),t._v(" "),e("el-tooltip",{staticClass:"item",attrs:{"popper-class":"tooltipClass",placement:"bottom-start",offset:""}},[e("div",{attrs:{slot:"content"},slot:"content"},[t._v(t._s(t.$t("tooltip.holidayTipA"))),e("br"),t._v(t._s(t.$t("tooltip.holidayTipB"))),e("br"),t._v(t._s(t.$t("tooltip.holidayTipC"))),e("br"),t._v(" "),e("br"),t._v(t._s(t.$t("tooltip.holidayTipD"))+"\n            ")]),t._v(" "),e("span",{staticClass:"chart-title-icon"},[e("i",{staticClass:"el-icon-question"})])]),t._v(" "),e("bar-chart",{staticClass:"month-bar-block",attrs:{id:"monthBarChart",options:t.holidayEffect_ops,chartType:"HolidayActBar"}}),t._v(" "),e("span",{staticClass:"download-text",on:{click:function(a){t.exportDataHandle("monthBarChart",t.i18nFormatter(t.holidayEff_title),"HolidayEffect")}}},[t._v(t._s(t.$t("allPages.load")))])],1),t._v(" "),e("div",{staticClass:"asis-table-wrapper asis-last-container"},[e("h3",{staticClass:"asis-table-header"},[e("span",{staticClass:"asis-table-title"},[t._v(t._s(t.i18nFormatter(t.growth_title)))]),t._v(" "),e("span",{staticClass:"asis-table-download",on:{click:function(a){t.dealExport("growthDetail",t.i18nFormatter(t.growth_title))}}},[t._v(t._s(t.$t("allPages.load")))])]),t._v(" "),e("div",{staticClass:"asis-table-content"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"growth-table",attrs:{data:t.growthData,id:"growthDetail","empty-text":t.$t("echartsTitle.noData")}},t._l(t.growthHead,function(a,i){return e("el-table-column",{key:i,attrs:{prop:a.prop,label:a.label,align:"center",formatter:t.emptyFormat}})}))],1)]),t._v(" "),e("export-data-dialog",{ref:"exportDialog"})],1)},staticRenderFns:[]},c=e("VU/8")(n,d,!1,function(t){e("BHXv")},"data-v-7a7ed412",null);a.default=c.exports}});