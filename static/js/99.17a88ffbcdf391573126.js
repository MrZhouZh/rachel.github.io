webpackJsonp([99],{"08SJ":function(t,e){},Eb3t:function(t,e,a){"use strict";(function(t){var s=a("wf2i");e.a={data:function(){return{moreOptVisible:!1,mallData:[],asisName:"",asisLevel:"",propParams:{}}},components:{"rs-option":s.a},created:function(){var e=this;window.addEventListener("resize",function(){try{var a={chart1:t("#residenceChart")[0],chart2:t("#rgenderChart")[0],chart3:t("#rageChart")[0]};for(var s in a)if(a.hasOwnProperty(s)&&void 0!=a[s]){a[s]=e.$echarts.init(a[s]);a[s].resize()}}catch(t){}})},mounted:function(){this.getMallOpt(),this.showCollapse()},methods:{showCollapse:function(){var e=this,a="",s="",i="",n="";a=this.getStyleFn(".el-header","height"),s=this.getStyleFn(".analysis-wrapper .el-header","height"),this.moreOptVisible?(this.moreOptVisible=!1,n=a+s+8+"px",t(".rs-main").animate({marginTop:n})):(this.moreOptVisible=!0,setTimeout(function(){i=e.getStyleFn(".analysis-option-wrapper","height"),n=a+s+i+8+"px",t(".rs-main").animate({marginTop:n})},100))},getMallOpt:function(){var t=this;this.axios.get("/malls",{params:{accountId:this.$cookie.get("accountId"),_t:Date.parse(new Date)/1e3}}).then(function(e){var a="",s=null;if(e.data.data.length>=1){var i=window.sessionStorage.getItem("mallId");i&&Number(i),e.data.data.forEach(function(e,s){t.mallData.push(e),i&&e.id==i&&(a=e.name)}),t.asisName=a||e.data.data[0].name,s=i?Number(i):e.data.data[0].id,t.$refs.init.initAsis(s)}})},initTab:function(t){this.$router.push("/customer/residencetime/rtasis"),this.propParams={dateType:"/residencetime/rtasis",data:t}},reportHandler:function(t){this.asisName=t.asis_tit,this.$router.push("/customer/residencetime/rtasis"),this.propParams={dateType:"/residencetime/rtasis",data:t}}}}}).call(e,a("7t+N"))},IgPT:function(t,e){},SroF:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Eb3t"),i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"base-analysis"},[e("el-header",{attrs:{height:"70px"}},[e("span",{staticClass:"asis-title"},[this._v(this._s(this.asisName)+" "+this._s(this.$t("asis.ResidenceTime")))]),this._v(" "),e("span",{staticClass:"more-option-wrapper",on:{click:this.showCollapse}},[e("span",{staticClass:"more-option-text"},[this._v(this._s(this.$t("asis.moreOp")))]),this._v(" "),e("i",{class:this.moreOptVisible?"el-icon-arrow-down more-option-arrow":"el-icon-arrow-down more-option-arrow more-option-up"})])]),this._v(" "),e("rs-option",{directives:[{name:"show",rawName:"v-show",value:this.moreOptVisible,expression:"moreOptVisible"}],ref:"init",attrs:{mallData:this.mallData},on:{reportTime:this.reportHandler,initData:this.initTab}}),this._v(" "),e("div",{staticClass:"element-main rs-main"},[e("router-view",{attrs:{propparam:this.propParams}})],1)],1)},staticRenderFns:[]},n=function(t){a("IgPT")},l=a("VU/8")(s.a,i,!1,n,"data-v-39e60d6b",null);e.default=l.exports},wf2i:function(t,e,a){"use strict";var s=a("pFYg"),i=a.n(s),n={props:{mallData:Array},data:function(){return{seraching:!1,pickerOptions1:{disabledDate:function(t){return t.getTime()>Date.now()}},weekPickerOpt:{firstDayOfWeek:1},tabItem:[],panelObj:{mallPanel:!1},analyasisTime:[{label:"custom",value:"custom",is_active:"time-btn"}],reportTime:{isCustom:!1},customTime:"",dayTime:"",mallVal:"",asisLevel:"",spaceVal:null,degreeVal:null,spaceList:[],paramId:"",isDeree:!0,stageList:[],startStage:0,endStage:null,endFocus:!1}},created:function(){this.tabItem=[],this.tabItem.push({label:"mall",value:"mall",className:"analysis-item"});for(var t=0;t<10;t++)this.spaceList.push({name:t+1+"分钟",value:t+1})},computed:{},mounted:function(){this.spaceVal=this.spaceList[2].value,this.degreeVal=8,this.dayTime=dateUnit.dateFormat(new Date,"yyyy-MM-dd")},methods:{i18nFormatter:function(t){var e="asisTab."+t;return this.$t(e)},initAsis:function(t){this.mallVal=t,this.tabClickHandle(0),this.timeHandle(0);var e={asis_level:"mall",asis_date:"custom",asis_setting:"degree",asis_stage:this.getStageTime(this.spaceVal,this.degreeVal).toString(),asis_time:this.dayTime,asis_org:t,asis_tit:this.getItemName(this.mallData,this.mallVal)};this.$emit("initData",e)},tabClickHandle:function(t){if("analysis-item"===this.tabItem[t].className){this.tabItem.forEach(function(t){t.className="analysis-item"}),this.tabItem[t].className="analysis-item tabs-active";for(var e in this.panelObj)this.panelObj[e]=!1;switch(this.asisLevel="",this.tabItem[t].value){case"mall":this.panelObj.mallPanel=!0,this.asisLevel="mall"}}},timeHandle:function(t){if("time-btn"===this.analyasisTime[t].is_active){this.analyasisTime.forEach(function(t){t.is_active="time-btn"});for(var e in this.reportTime)this.reportTime[e]=!1;this.analyasisTime[t].is_active="time-btn active-time";switch(this.analyasisTime[t].value){case"custom":this.reportTime.isCustom=!0}}},addSpaceTime:function(){(this.startStage||0==this.startStage)&&this.endStage?(this.stageList.push({startMin:this.startStage,endMin:this.endStage}),this.startStage=null,this.endStage=null):this.$message({showClose:!0,type:"info",message:"滞留时间不能为空!"})},limitNumber:function(t,e){t&&(/^\d+$/g.test(t)||(this.$message({showClose:!0,type:"warning",duration:500,message:"只能输入正整数"}),e?this.startStage=null:this.endStage=null))},cusTimeChange:function(t,e){this.endFocus=!1;var a=this.stageList.length;e?this.stageList[a-1].endMin?t<this.stageList[a-1].endMin&&(this.startStage=null):this.startStage=null:this.startStage||0==this.startStage?t||"object"!==(void 0===t?"undefined":i()(t))?t<=this.startStage||0==t?this.endStage=null:(this.stageList.push({startMin:this.startStage,endMin:this.endStage}),this.startStage=null,this.endStage=null):(this.stageList.push({startMin:this.startStage,endMin:this.endStage?this.endStage:""}),this.startStage=null,this.endStage=null):this.endStage=null},handleClose:function(t){this.stageList.splice(t,1),0==this.stageList.length&&(this.startStage=0)},getStageTime:function(t,e){for(var a=[],s="",i=0;i<e;i++)s=0==i?"-"+t:i+1==e?t*i+"-":t*i+"-"+t*(i+1),a.push(s);return a},confirmCondition:function(){var t=[],e="";if(this.isDeree)e="degree",t=this.getStageTime(this.spaceVal,this.degreeVal);else{e="cusmin";var a="";this.stageList.forEach(function(e,s){(e.startMin||0==e.startMin)&&(a=e.startMin+"-",a+=e.endMin?e.endMin:"",t.push(a))})}var s={asis_level:"",asis_date:"",asis_time:"",asis_org:"",asis_setting:"",asis_stage:""};this.mallVal&&(s.asis_setting=e,s.asis_stage=t.toString(),s.asis_level="mall",s.asis_date="custom",s.asis_time=this.dayTime,s.asis_org=this.mallVal,s.asis_tit=this.getItemName(this.mallData,this.mallVal),this.$emit("reportTime",s))},getItemName:function(t,e){var a="",s=e.toString().split(",")[0];return t.forEach(function(t){t.id==s&&(a=t.name)}),a},resetRefresh:function(){this.tabClickHandle(0),this.timeHandle(0),this.mallVal=this.mallData[0].id,this.dayTime=dateUnit.dateFormat(new Date,"yyyy-MM-dd")}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"analysis-option-wrapper"},[a("div",{staticClass:"analysis-level-wrapper"},[a("div",{staticClass:"analysis-level-left"},[a("i",{staticClass:"el-icon-search"}),t._v(" "),a("span",{staticClass:"analysis-level-text"},[t._v(t._s(t.$t("asisTab.level")))])]),t._v(" "),a("div",{staticClass:"analysis-level-right"},[a("ul",{staticClass:"analysis-type-box"},t._l(t.tabItem,function(e,s){return a("li",{key:e.value,class:e.className,on:{click:function(e){t.tabClickHandle(s)}}},[a("span",{staticClass:"analysis-item-title"},[t._v(t._s(t.i18nFormatter(e.label)))])])}))])]),t._v(" "),a("div",{staticClass:"panels-content"},[a("div",{staticClass:"main-top"},[t.panelObj.mallPanel?a("ul",{staticClass:"condition-box"},[a("li",{staticClass:"condition-item"},[a("div",{staticClass:"condition-item-option"},[a("el-select",{staticClass:"mall-sel-box rs-sel-box",attrs:{filterable:"",placeholder:t.$t("pholder.shopSelect")},model:{value:t.mallVal,callback:function(e){t.mallVal=e},expression:"mallVal"}},t._l(t.mallData,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),a("li",{staticClass:"condition-item analysis-date-condition"},[a("div",{staticClass:"condition-item-option"},[a("el-date-picker",{staticClass:"date-input analysis-date-input",attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",size:"mini",placeholder:t.$t("pholder.date"),"picker-options":t.pickerOptions1},model:{value:t.dayTime,callback:function(e){t.dayTime=e},expression:"dayTime"}})],1)]),t._v(" "),a("li",{staticClass:"condition-item"},[a("div",{staticClass:"condition-item-option"},[a("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.residenceTime")+t.$t("asisTab.setting"))+" :")]),t._v(" "),a("el-radio",{staticClass:"resden-radio",attrs:{label:!0},model:{value:t.isDeree,callback:function(e){t.isDeree=e},expression:"isDeree"}},[a("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.interval")))]),t._v(" "),a("el-select",{staticClass:"space-sel-box",attrs:{placeholder:"请选择间隔",disabled:!t.isDeree},model:{value:t.spaceVal,callback:function(e){t.spaceVal=e},expression:"spaceVal"}},t._l(t.spaceList,function(t){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})),t._v(" "),a("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.order")))]),t._v(" "),a("el-input",{staticClass:"degree-inp",attrs:{placeholder:"请输入阶数",disabled:!t.isDeree},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.confirmCondition(e)}},model:{value:t.degreeVal,callback:function(e){t.degreeVal=e},expression:"degreeVal"}})],1),t._v(" "),a("el-radio",{staticClass:"resden-radio",attrs:{label:!1},model:{value:t.isDeree,callback:function(e){t.isDeree=e},expression:"isDeree"}},[a("span",{staticClass:"condition-item-text"},[t._v(t._s(t.$t("asisTab.period")))])]),t._v(" "),t._l(t.stageList,function(e,s){return a("el-tag",{key:s,staticClass:"stage-tag-box",attrs:{closable:"","disable-transitions":!1},on:{close:function(e){t.handleClose(s)}}},[t._v("\n                            "+t._s(e.startMin+" - "+e.endMin)+"\n                        ")])}),t._v(" "),a("div",{staticClass:"cusmin-item-option"},[a("el-input",{staticClass:"degree-inp",attrs:{placeholder:"请输入开始分钟",disabled:0==t.stageList.length||t.isDeree},on:{blur:function(e){t.cusTimeChange(t.startStage,!0)}},nativeOn:{keyup:function(e){t.limitNumber(t.startStage,!0)}},model:{value:t.startStage,callback:function(e){t.startStage=t._n(e)},expression:"startStage"}}),t._v(" "),a("i",[t._v("-")]),t._v(" "),a("el-input",{staticClass:"degree-inp",attrs:{placeholder:"请输入结束分钟",disabled:t.isDeree},on:{blur:function(e){t.cusTimeChange(t.endStage)}},nativeOn:{keyup:function(e){t.limitNumber(t.endStage)}},model:{value:t.endStage,callback:function(e){t.endStage=t._n(e)},expression:"endStage"}})],1),t._v(" "),a("el-button",{staticClass:"text-add-btn",attrs:{type:"text",disabled:t.isDeree},on:{click:t.addSpaceTime}},[a("i",{staticClass:"el-icon-circle-plus-outline"})])],2)]),t._v(" "),a("li",{staticClass:"condition-item"},[a("el-button",{staticClass:"primary-btn analysis-collapse-btn",attrs:{type:"primary",size:"samll"},on:{click:t.confirmCondition}},[t._v(t._s(t.$t("button.confirm")))])],1)]):t._e()])])])},staticRenderFns:[]},r=a("VU/8")(n,l,!1,function(t){a("08SJ")},"data-v-35af0d23",null);e.a=r.exports}});